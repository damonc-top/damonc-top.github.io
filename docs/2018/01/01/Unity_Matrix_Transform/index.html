<!DOCTYPE html><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="baidu-site-verification" content="code-BGVivWGmxV" /><title>Unity åŸºæœ¬çŸ©é˜µ(ç¿»è¯‘ä¸€)</title><meta name="description" content="æœ¬ç¯‡æ‘˜è¦ä¿¡æ¯ matrixä»‹ç» matrixæ¨å¯¼ æ¨¡æ‹Ÿtransformç¼©æ”¾ æ—‹è½¬ ä½ç§»åŠŸèƒ½"><link rel="shortcut icon" href="/favicon.ico?" type="image/x-icon"><link rel="icon" href="/favicon.ico?" type="image/x-icon"><link rel="stylesheet" href="/css/main.css "><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"><link rel="stylesheet" href=" /css/font_8v3czwksspqlg14i.css "><link rel="canonical" href="https://www.damonc.top/2018/01/01/Unity_Matrix_Transform/"><link rel="alternate" type="application/rss+xml" title="çˆ±ç©¿æ‹–é‹" href="https://www.damonc.top/feed.xml "> <script src=" /js/Valine.min.js " charset="utf-8"></script> <script src=" /js/jquery_3_2_0.min.js " charset="utf-8"></script> <script> var _hmt = _hmt || []; (function() { var hm = document.createElement("script"); hm.src = "//hm.baidu.com/hm.js?f7f1a5967e3927ea98597632f0a17ad9"; var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s); })(); </script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script async src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><body class="custom-background"><header id="top"><div class="wrapper"> <a href="/" class="brand">çˆ±ç©¿æ‹–é‹</a> <small>è‡ªç”±è‡ªåœ¨ğŸ©´</small> <button id="headerMenu" class="menu"><i class="fa fa-bars"></i></button><nav id="headerNav"><ul><li> <a href="/"> <i class="fa fa-home"></i>Home </a><li> <a href="/archive/"> <i class="fa fa-archive"></i>å½’æ¡£ </a><li> <a href="/category/"> <i class="fa fa-th-list"></i>åˆ†ç±» </a><li> <a href="/tag/"> <i class="fa fa-tags"></i>æ ‡ç­¾ </a><li> <a href="/collection/"> <i class="fa fa-bookmark"></i>æ”¶é›† </a><li> <a href="/demo/"> <i class="fa fa-play"></i>å·¥å…· </a><li> <a href="/about/"> <i class="fa fa-heart"></i>About </a></ul></nav></div></header><div class="home-right-bar"> <button class="anchor"><i class="fa fa-anchor"></i></button><div class="right"><div class="wrap"><div class="side content"><div> ç›®å½•</div><ul id="content-side" class="content-ul"><li><a href="#comments">Comments</a></ul></div></div></div></div><div class="page clearfix" post><div class="left"><h1>Unity åŸºæœ¬çŸ©é˜µ(ç¿»è¯‘ä¸€)</h1><div class="label"><div class="label-card"> <i class="fa fa-calendar"></i>2018-01-01</div><div class="label-card"> <i class="fa fa-user"></i>catlikecoding</div><div class="label-card"></div><div class="label-card"> <span class="categories"> <i class="fa fa-th-list"></i> <a href="/category/#ç¿»è¯‘" title="Category: ç¿»è¯‘" rel="category">ç¿»è¯‘</a> </span></div><div class="label-card"> <span class="pageTag"> <i class="fa fa-tags"></i> <b href="/tag/#Shader" title="Tag: Shader" rel="tag">Shader</b>&nbsp; <b href="/tag/#Unity3d" title="Tag: Unity3d" rel="tag">Unity3d</b> </span></div></div><hr><article itemscope itemtype="http://schema.org/BlogPosting"><ul id="markdown-toc"><li><a href="#å¯è§†ç©ºé—´" id="markdown-toc-å¯è§†ç©ºé—´">å¯è§†ç©ºé—´</a><ul><li><a href="#æ“æ§ä¸€ç»„3ç»´åæ ‡" id="markdown-toc-æ“æ§ä¸€ç»„3ç»´åæ ‡">æ“æ§ä¸€ç»„3ç»´åæ ‡</a></ul><li><a href="#ç©ºé—´å˜æ¢" id="markdown-toc-ç©ºé—´å˜æ¢">ç©ºé—´å˜æ¢</a><ul><li><a href="#ä½ç§»" id="markdown-toc-ä½ç§»">ä½ç§»</a><li><a href="#ç¼©æ”¾" id="markdown-toc-ç¼©æ”¾">ç¼©æ”¾</a><li><a href="#æ—‹è½¬äºŒç»´" id="markdown-toc-æ—‹è½¬äºŒç»´">æ—‹è½¬(äºŒç»´)</a></ul><li><a href="#æ—‹è½¬å®Œå…¨ä½“" id="markdown-toc-æ—‹è½¬å®Œå…¨ä½“">æ—‹è½¬å®Œå…¨ä½“</a><ul><li><a href="#2dçŸ©é˜µ" id="markdown-toc-2dçŸ©é˜µ">2DçŸ©é˜µ</a><li><a href="#3dçŸ©é˜µ" id="markdown-toc-3dçŸ©é˜µ">3DçŸ©é˜µ</a><li><a href="#ç»•xè½´å’Œyè½´çš„æ—‹è½¬çŸ©é˜µæ¨å¯¼" id="markdown-toc-ç»•xè½´å’Œyè½´çš„æ—‹è½¬çŸ©é˜µæ¨å¯¼">ç»•Xè½´å’ŒYè½´çš„æ—‹è½¬çŸ©é˜µæ¨å¯¼</a><li><a href="#ç»Ÿä¸€çš„æ—‹è½¬çŸ©é˜µ" id="markdown-toc-ç»Ÿä¸€çš„æ—‹è½¬çŸ©é˜µ">ç»Ÿä¸€çš„æ—‹è½¬çŸ©é˜µ</a></ul><li><a href="#çŸ©é˜µå˜æ¢" id="markdown-toc-çŸ©é˜µå˜æ¢">çŸ©é˜µå˜æ¢</a><ul><li><a href="#å…¶æ¬¡åæ ‡homogeneous-coordinates" id="markdown-toc-å…¶æ¬¡åæ ‡homogeneous-coordinates">å…¶æ¬¡åæ ‡(Homogeneous Coordinates)</a><li><a href="#ä½¿ç”¨çŸ©é˜µ" id="markdown-toc-ä½¿ç”¨çŸ©é˜µ">ä½¿ç”¨çŸ©é˜µ</a><li><a href="#åˆå¹¶çŸ©é˜µ" id="markdown-toc-åˆå¹¶çŸ©é˜µ">åˆå¹¶çŸ©é˜µ</a></ul><li><a href="#3dåˆ°2dæŠ•å½±çŸ©é˜µ" id="markdown-toc-3dåˆ°2dæŠ•å½±çŸ©é˜µ">3Dåˆ°2DæŠ•å½±çŸ©é˜µ</a><ul><li><a href="#æ­£äº¤ç›¸æœºorthographic-camera" id="markdown-toc-æ­£äº¤ç›¸æœºorthographic-camera">æ­£äº¤ç›¸æœºOrthographic Camera</a><li><a href="#é€è§†ç›¸æœºperspective-camera" id="markdown-toc-é€è§†ç›¸æœºperspective-camera">é€è§†ç›¸æœºPerspective Camera</a></ul></ul><p>æœ¬ç¯‡æ‘˜è¦ä¿¡æ¯</p><ul><li>matrixä»‹ç»<li>matrixæ¨å¯¼<li>æ¨¡æ‹Ÿtransformç¼©æ”¾ æ—‹è½¬ ä½ç§»åŠŸèƒ½</ul><h2 id="å¯è§†ç©ºé—´">å¯è§†ç©ºé—´</h2><p>Unity Shaderæ˜¯æ€ä¹ˆçŸ¥é“ä¸€ä¸ªåƒç´ è¯¥ç”»åœ¨å“ªä¸ªä½ç½®ï¼Ÿä¸‹é¢æ˜¯å…ˆå±•ç¤ºä¸€ç»„Cubeï¼Œä¸€æ­¥æ­¥åˆ†æä¸‹å»</p><center class="half"><img class="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender1/cube array.png" width="" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>cubeæ•°ç»„.</a></i></center> </font><h3 id="æ“æ§ä¸€ç»„3ç»´åæ ‡">æ“æ§ä¸€ç»„3ç»´åæ ‡</h3><p>åˆ›å»ºä¸€ç»„10<em>10</em>10çš„3ç»´Cubeæ•°ç»„ï¼Œå¹¶ä½œä¸º<strong>UnityMatriceså¯¹è±¡</strong>çš„æˆå‘˜å˜é‡ï¼Œæ¥ä¸‹æ¥æ˜¾ç¤ºè¿™äº›Cubeåœ¨ç©ºé—´ä¸­çš„ä½ç½®</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">void</span> <span class="nf">InitCubeArray</span><span class="p">()</span>
<span class="p">{</span> 
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span><span class="m">0</span> <span class="p">,</span> <span class="n">z</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">z</span> <span class="p">&lt;</span> <span class="n">generalCount</span><span class="p">;</span> <span class="n">z</span><span class="p">++)</span>
    <span class="p">{</span> 
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">y</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">y</span> <span class="p">&lt;</span> <span class="n">generalCount</span><span class="p">;</span> <span class="n">y</span><span class="p">++)</span>
        <span class="p">{</span> 
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">x</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">x</span> <span class="p">&lt;</span> <span class="n">generalCount</span><span class="p">;</span> <span class="n">x</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="n">cubes</span><span class="p">[</span><span class="n">i</span><span class="p">++]</span> <span class="p">=</span> <span class="nf">CreateCubesPoint</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">Transform</span> <span class="nf">CreateCubesPoint</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">,</span> <span class="kt">int</span> <span class="n">z</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">GameObject</span> <span class="n">cube</span> <span class="p">=</span> <span class="n">GameObject</span><span class="p">.</span><span class="nf">CreatePrimitive</span><span class="p">(</span><span class="n">PrimitiveType</span><span class="p">.</span><span class="n">Cube</span><span class="p">);</span>
    <span class="n">cube</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">localScale</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Vector3</span><span class="p">(</span><span class="m">0.5f</span><span class="p">,</span> <span class="m">0.5f</span><span class="p">,</span> <span class="m">0.5f</span><span class="p">);</span>
    <span class="n">cube</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">localPosition</span> <span class="p">=</span> <span class="nf">CreateCoordinate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">);</span>
    <span class="n">cube</span><span class="p">.</span><span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">MeshRenderer</span><span class="p">&gt;().</span><span class="n">material</span><span class="p">.</span><span class="n">color</span> <span class="p">=</span> <span class="nf">CreateColor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">cube</span><span class="p">.</span><span class="n">transform</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div><p>è®¾ç½®æ¯ä¸ªCubeçš„ä½ç½®ï¼Œéƒ½ä»¥(0,0,0)ä¸ºåŸç‚¹ï¼Œ(10-1)*0.5ä¸ºCenterå·¦å³ä¸¤è¾¹å¯¹ç§°</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Vector3</span> <span class="nf">CreateCoordinate</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">,</span> <span class="kt">int</span> <span class="n">z</span><span class="p">)</span>
<span class="p">{</span> 
    <span class="k">return</span> <span class="k">new</span> <span class="nf">Vector3</span><span class="p">(</span>
        <span class="n">x</span> <span class="p">-</span> <span class="n">center</span><span class="p">,</span>
        <span class="n">y</span> <span class="p">-</span> <span class="n">center</span><span class="p">,</span>
        <span class="n">z</span> <span class="p">-</span> <span class="n">center</span>
    <span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div><p>ç„¶åå†ç”¨è‡ªèº«åæ ‡xyzåˆ†é‡ä¸centerçš„æ¯”ç‡åˆå§‹åŒ–é¢œè‰²rgbã€‚æ•ˆæœå¦‚ä¸Šå›¾</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Color</span> <span class="nf">CreateColor</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">,</span> <span class="kt">int</span> <span class="n">z</span><span class="p">)</span>
<span class="p">{</span> 
    <span class="k">return</span> <span class="k">new</span> <span class="nf">Color</span><span class="p">(</span>
        <span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="n">x</span> <span class="p">/</span> <span class="n">generalCount</span><span class="p">,</span>
        <span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="n">y</span> <span class="p">/</span> <span class="n">generalCount</span><span class="p">,</span>
        <span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="n">z</span> <span class="p">/</span> <span class="n">generalCount</span>
    <span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div><h2 id="ç©ºé—´å˜æ¢">ç©ºé—´å˜æ¢</h2><p><em>positionning, rotating, and scaling</em></p><p>Cubeæ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ åœ¨ç©ºé—´ä¸­çš„å˜æ¢æœ‰å¯èƒ½ä¼šæœ‰å·®å¼‚ï¼Œè™½ç„¶æ¯ä¸ªCubeå˜æ¢çš„ç»†èŠ‚ä¸åŒï¼Œä½†å®ƒä»¬éƒ½éœ€è¦ç»è¿‡æŸä¸ªæ–¹æ³•æ¥å˜æ¢åˆ°ç©ºé—´ä¸­çš„æŸä¸ªåæ ‡ç‚¹ã€‚ä¸ºæ­¤æˆ‘ä»¬å¯ä»¥ä¸ºæ‰€æœ‰å˜æ¢åˆ›å»ºä¸€ä¸ªabstract åŸºç±»ï¼ŒåŒ…å«ä¸€ä¸ªæŠ½è±¡çš„_Applay()_æˆå‘˜æ–¹æ³•ï¼Œç”±å…·ä½“çš„å˜æ¢ç»„ä»¶å»å®ç°è¿™ä¸ªæ–¹æ³•ã€‚</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">abstract</span> <span class="k">class</span> <span class="nc">Transformation</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
<span class="p">{</span> 
    <span class="k">public</span> <span class="k">abstract</span> <span class="n">Vector3</span> <span class="nf">Apply</span><span class="p">(</span><span class="n">Vector3</span> <span class="n">point</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div><p>æˆ‘ä»¬ç»™è¿™ä¸ª<strong>UnityMatriceså¯¹è±¡</strong>æ·»åŠ <em>Transformation</em>ç»„ä»¶ï¼ŒåŒæ—¶æ£€ç´¢Cubeæ•°ç»„æ¯ä¸ªå¯¹è±¡ï¼Œå°†å…¶åæ ‡ä¼ å…¥è¿™ä¸ªç»„ä»¶çš„_Apply()_æ–¹æ³•è¿›è¡Œè®¡ç®—å¾—åˆ°æ–°åæ ‡å¹¶åº”ç”¨ï¼Œè¿™é‡Œå§‹ç»ˆä»¥(0ï¼Œ0ï¼Œ0)ä½œä¸ºæ¯ä¸ªCubeå¯¹è±¡çš„åŸç‚¹åæ ‡ï¼Œè€Œä¸èƒ½ä¾èµ–å…¶å®é™…åæ ‡ï¼Œå› ä¸ºä¼šæ¯å¸§å®æ—¶è®¡ç®—å¹¶æ”¹å˜ã€‚æœ€åæˆ‘ä»¬ç”¨æ³›å‹åˆ—è¡¨å­˜å‚¨è¿™ç§ä¸€ç³»åˆ—å˜æ¢ç»„ä»¶æ–¹ä¾¿ç»Ÿä¸€è®¡ç®—ã€‚</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">private</span> <span class="k">void</span> <span class="nf">Update</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">GetComponents</span><span class="p">&lt;</span><span class="n">Transformation</span><span class="p">&gt;(</span><span class="n">transformations</span><span class="p">);</span> 
    <span class="c1">// for (int i = 0; i &lt; cubes.Length; i++) </span>
    <span class="c1">// { </span>
    <span class="c1">//      cubes[i].localPosition = TransformPoint(cubes[i].localPosition); </span>
    <span class="c1">// }</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span><span class="m">0</span> <span class="p">,</span> <span class="n">z</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">z</span> <span class="p">&lt;</span> <span class="n">generalCount</span><span class="p">;</span> <span class="n">z</span><span class="p">++)</span>
    <span class="p">{</span> 
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">y</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">y</span> <span class="p">&lt;</span> <span class="n">generalCount</span><span class="p">;</span> <span class="n">y</span><span class="p">++)</span>
        <span class="p">{</span> 
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">x</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">x</span> <span class="p">&lt;</span> <span class="n">generalCount</span><span class="p">;</span> <span class="n">x</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="n">cubes</span><span class="p">[</span><span class="n">i</span><span class="p">++].</span><span class="n">localPosition</span> <span class="p">=</span> <span class="nf">TransformPoint</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">Vector3</span> <span class="nf">TransformPoint</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">,</span> <span class="kt">int</span> <span class="n">z</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Vector3</span> <span class="n">coordinates</span> <span class="p">=</span> <span class="nf">CreateCoordinate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">);</span> 
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">transformations</span><span class="p">.</span><span class="n">Count</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
    <span class="p">{</span>
        <span class="n">coordinates</span> <span class="p">=</span> <span class="n">transformations</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">Apply</span><span class="p">(</span><span class="n">coordinates</span><span class="p">);</span>
    <span class="p">}</span> 
    <span class="k">return</span> <span class="n">coordinates</span><span class="p">;</span>
 <span class="p">}</span>
</code></pre></div></div><h3 id="ä½ç§»">ä½ç§»</h3><p>ç°åœ¨æ¥åšç¬¬ä¸€ç§å˜æ¢ï¼štranslationä½ç§»ï¼Œè¿™å¾ˆç®€å•ã€‚é¦–å…ˆåˆ›å»ºä¸€ä¸ªç»§æ‰¿è‡ªTransformationç»„ä»¶å­ç±»ï¼Œå¹¶å®šä¹‰ä¸€ä¸ªè¡¨ç¤ºè‡ªèº«ä½ç½®å±æ€§çš„å˜é‡ï¼Œå¹¶å®ç°åŸºç±»çš„æŠ½è±¡æ–¹æ³•ã€‚ç„¶åæ·»åŠ ç»™Cubeæ•°ç»„å¯¹è±¡</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">class</span> <span class="nc">PositionTransformation</span> <span class="p">:</span> <span class="n">Transformation</span>
<span class="p">{</span> 
    <span class="k">public</span> <span class="n">Vector3</span> <span class="n">position</span><span class="p">;</span> <span class="k">public</span> <span class="k">override</span> <span class="n">Vector3</span> <span class="nf">Apply</span><span class="p">(</span><span class="n">Vector3</span> <span class="n">point</span><span class="p">)</span>
    <span class="p">{</span> 
        <span class="k">return</span> <span class="n">point</span> <span class="p">+</span> <span class="n">position</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div><p>ç°åœ¨å¯ä»¥å‘<strong>UnityMatriceså¯¹è±¡</strong>æ·»åŠ <em>PositionTransformation</em>ç»„ä»¶ã€‚è¿™å…è®¸æˆ‘ä»¬åœ¨ä¸ç§»åŠ¨<strong>UnityMatriceså¯¹è±¡</strong>çš„æƒ…å†µä¸‹ç§»åŠ¨æ•°ç»„ä¸­æ¯ä¸ªå¯¹è±¡çš„åæ ‡ï¼Œæ‰€æœ‰çš„å˜æ¢éƒ½å‘ç”Ÿåœ¨cubeçš„å±€éƒ¨ç©ºé—´ã€‚</p><center class="half"><img class="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender1/move.gif" width="" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>ä½ç§».</a></i></center> </font><h3 id="ç¼©æ”¾">ç¼©æ”¾</h3><p>æ¥ä¸‹æ¥åšç¬¬äºŒç§å˜æ¢ï¼šScalingç¼©æ”¾ã€‚</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">class</span> <span class="nc">ScaleTransformation</span> <span class="p">:</span> <span class="n">Transformation</span>
<span class="p">{</span> 
    <span class="k">public</span> <span class="n">Vector3</span> <span class="n">scale</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Vector3</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">);</span> 
    <span class="k">public</span> <span class="k">override</span> <span class="n">Vector3</span> <span class="nf">Apply</span><span class="p">(</span><span class="n">Vector3</span> <span class="n">point</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">point</span><span class="p">.</span><span class="n">x</span> <span class="p">*=</span> <span class="n">scale</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
        <span class="n">point</span><span class="p">.</span><span class="n">y</span> <span class="p">*=</span> <span class="n">scale</span><span class="p">.</span><span class="n">y</span><span class="p">;</span>
        <span class="n">point</span><span class="p">.</span><span class="n">z</span> <span class="p">*=</span> <span class="n">scale</span><span class="p">.</span><span class="n">z</span><span class="p">;</span> <span class="k">return</span> <span class="n">point</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div><center class="half"><img class="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender1/scale.gif" width="" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>ç¼©æ”¾.</a></i></center> </font><p>è¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜ï¼šå½“è¿›è¡Œç¼©æ”¾æ—¶ï¼Œç¼©æ”¾ä¼šæ”¹å˜æ¯ä¸ªCubeå¯¹è±¡çš„positionã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬å…ˆè®¡ç®—äº†ç©ºé—´åæ ‡ï¼Œç„¶åæ‰ç¼©æ”¾çš„å®ƒã€‚è€ŒUnityä¸­Transformç»„ä»¶æ˜¯å…ˆç¼©æ”¾åä½ç§»ã€‚æ‰€ä»¥æ­£ç¡®çš„è®¡ç®—é¡ºåºæ˜¯ï¼šå…ˆç¼©æ”¾åä½ç§»ã€‚</p><h3 id="æ—‹è½¬äºŒç»´">æ—‹è½¬(äºŒç»´)</h3><p>ç¬¬ä¸‰ç§å˜æ¢ï¼šRotationæ—‹è½¬ã€‚</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">class</span> <span class="nc">RotationTransform</span> <span class="p">:</span> <span class="n">Transformation</span>
<span class="p">{</span> 
    <span class="k">public</span> <span class="n">Vector3</span> <span class="n">rotation</span><span class="p">;</span> 
    <span class="k">public</span> <span class="k">override</span> <span class="n">Vector3</span> <span class="nf">Apply</span><span class="p">(</span><span class="n">Vector3</span> <span class="n">point</span><span class="p">)</span>
    <span class="p">{</span> 
        <span class="k">return</span> <span class="n">point</span><span class="p">;</span><span class="c1">//å…ˆå ä½</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div><p><strong>æ—‹è½¬è¯¥å¦‚ä½•å·¥ä½œå‘¢</strong>ï¼Ÿç°åœ¨å…ˆå‡å®šåœ¨2ç»´ç©ºé—´ä¸‹ä¸€ç‚¹Pï¼Œç»•Zè½´æ—‹è½¬ã€‚Unityä½¿ç”¨äº†å·¦æ‰‹åæ ‡ç³»ï¼Œæ­£å‘æ—‹è½¬æ˜¯é€†æ—¶é’ˆæ–¹å‘ï¼Œå¦‚ä¸‹å›¾ï¼š</p><center class="half"><img class="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender1/rotation1.png" width="" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>2ç»´ç©ºé—´ä¸‹ç»•Zè½´æ—‹è½¬.</a></i></center> </font><p><strong>æ—‹è½¬ä¸€ä¸ªç‚¹åæ ‡åä¼šå‘ä»€ä¹ˆå—</strong>ï¼Ÿå…ˆç®€å•çš„è€ƒè™‘ä¸€ä¸ªä»¥åŸç‚¹ä¸ºä¸­å¿ƒçš„å•ä½åœ†ä¸Šçš„ä¸€ç‚¹Pï¼Œè®¾påˆå§‹ä½ç½®ä¸º(1,0)ï¼Œç„¶åå†ä»¥æ¯90Â°å¢é‡è¿›è¡Œä¸€æ¬¡æ—‹è½¬ï¼Œå¦‚ä¸‹å›¾ï¼š</p><center class="half"><img class="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender1/rotation2.png" width="" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>0Â°æ—‹è½¬åˆ°90Â°å’Œ180Â°å˜åŒ–.</a></i></center> </font><p>ç”±ä¸Šå›¾å¯çŸ¥ï¼Œç‚¹p(1,0)æ—‹è½¬ä¸€æ¬¡(90Â°)å˜ä¸ºäº†(0,1)ï¼Œå†æ—‹è½¬ä¸€æ¬¡(180Â°)å˜ä¸ºäº†(-1,0)ï¼Œå†å¾€ä¸‹æ—‹è½¬ä¼šå˜ä¸º(0,-1)ï¼Œæœ€åå›åˆ°åŸä½ç½®(1,0). é‚£å¦‚æœç”¨ç‚¹(0,1)ä½œä¸ºåˆå§‹ä½ç½®ï¼Œå…¶å˜æ¢é¡ºåº(0,1)$\rightarrow$(-1,0)$\rightarrow$(0,-1)$\rightarrow$(1,0)$\rightarrow$(0,1). å› æ­¤è¿™ä¸ªç‚¹åæ ‡å§‹ç»ˆå›´ç»•0ï¼Œ1ï¼Œ0ï¼Œ-1è¿›è¡Œå¾ªç¯ï¼Œå”¯ä¸€å¾—åŒºåˆ«æ˜¯èµ·å§‹ç‚¹ä½ç½®ä¸åŒã€‚</p><p><strong>é‚£å¦‚æœä»¥45Â°å¢é‡è¿›è¡Œæ—‹è½¬å‘¢</strong>?å®ƒä¼šåœ¨XYå¹³é¢å¯¹è§’çº¿ä¸Šäº§ç”Ÿä¸€ç‚¹ï¼Œå…¶åæ ‡ä¸º($\pm \sqrt{1 \over 2},\pm \sqrt{1 \over 2}$)ï¼Œè¿™äº›ç‚¹åˆ°åŸç‚¹çš„è·ç¦»å§‹ç»ˆæ˜¯ä¸€è‡´çš„ã€‚è€Œè¿™ä¸ªå¾ªç¯é¡ºåºä¹Ÿç±»ä¼¼ä¸Šé¢ï¼Œæ˜¯$0, \sqrt{1 \over 2}, 1, \sqrt{1 \over 2}, 0, âˆ’\sqrt{1 \over 2}, âˆ’1, âˆ’\sqrt{1 \over 2}$ã€‚å¦‚æœç»§ç»­å‡å°å¢é‡å€¼ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªSineæ›²çº¿ã€‚</p><center class="half"><img class="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender1/trangle math.png" width="" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>Sine å’Œ Cosineæ›²çº¿.</a></i></center> </font><p>ç»“åˆä¸Šé¢ä¸¤å¼ å›¾ï¼ŒSineæ›²çº¿ä»£è¡¨äº†Yåˆ†é‡ï¼ŒCosineæ›²çº¿ä»£è¡¨äº†Xåˆ†é‡ï¼Œåæ ‡ç”¨æ›²çº¿è¡¨ç¤ºå°±æ˜¯$(\cos z, \sin z)$ï¼Œè‹¥èµ·å§‹ç‚¹ä¸º(1,0)åˆ™ç»“æœä¸º$(cosz,sinz)$ï¼Œ<strong>é€†æ—¶é’ˆæ—‹è½¬90Â°</strong>å(æ ¹æ®$sin(-z) = â€“sin z, cos(-z) = cos z$çš„<strong>å¯¹ç§°æ€§è´¨</strong>)åˆ™ç»“æœä¸º$(âˆ’sin z,cos z)$ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥ç”¨ç»•Zè½´è®¡ç®—sineå’Œcosineæ›²çº¿ï¼Œç”±äºæä¾›çš„æ˜¯è§’åº¦ï¼Œä½†å®é™…ä¸ŠsinåŠcosåªèƒ½ä½œç”¨äºå¼§åº¦ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è½¬åŒ–å®ƒ:</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">override</span> <span class="n">Vector3</span> <span class="nf">Apply</span><span class="p">(</span><span class="n">Vector3</span> <span class="n">point</span><span class="p">)</span>
<span class="p">{</span> 
    <span class="kt">float</span> <span class="n">radz</span> <span class="p">=</span> <span class="n">rotation</span><span class="p">.</span><span class="n">z</span> <span class="p">*</span> <span class="n">Mathf</span><span class="p">.</span><span class="n">Deg2Rad</span><span class="p">;</span>
    <span class="kt">float</span> <span class="n">sinz</span> <span class="p">=</span> <span class="n">Mathf</span><span class="p">.</span><span class="nf">Sin</span><span class="p">(</span><span class="n">radz</span><span class="p">);</span>
    <span class="kt">float</span> <span class="n">cosz</span> <span class="p">=</span> <span class="n">Mathf</span><span class="p">.</span><span class="nf">Cos</span><span class="p">(</span><span class="n">radz</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">point</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div><blockquote class="prompt-tip"><p>ä»€ä¹ˆæ˜¯å¼§åº¦? åƒåº¦æ•°ä¸€æ ·ï¼Œå¯ä»¥ç”¨ä½œæ—‹è½¬çš„åº¦é‡ã€‚ä½¿ç”¨å•ä½åœ†æ—¶ï¼Œå¼§åº¦ä¸åœ†å‘¨è¡Œè¿›çš„è·ç¦»ç›¸ç­‰ã€‚ç”±äºåœ†å‘¨çš„é•¿åº¦ç­‰äº2Ï€ä¹˜ä»¥åœ†çš„åŠå¾„ï¼Œå› æ­¤1åº¦ç­‰äº2Ï€/360 = Ï€/180å¼§åº¦ã€‚Ï€ æ˜¯åœ†çš„å‘¨é•¿ä¸å…¶ç›´å¾„ä¹‹é—´çš„æ¯”ç‡ã€‚</p></blockquote><p><strong>ä¸Šè¿°æ–¹æ³•å¯¹äºæ—‹è½¬(1,0)æˆ–(0,1)æˆ–è®¸å¾ˆå¥½ï¼Œé‚£æœ‰ç±³æœ‰æ—‹è½¬ä»»æ„ç‚¹çš„æ–¹å¼å‘¢</strong>ï¼Ÿ è¿™äº›ç‚¹éƒ½æ˜¯ç”±Xå’ŒYå®šä¹‰çš„ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ2ç»´ç‚¹(x,y)æ‹†åˆ†ä¸ºä¸€ä¸ªå…¬å¼$xX+yY$ï¼Œé‚£ä¹ˆ$x(1,0)+y(0,1)=(x, y)$æ˜¯æˆç«‹çš„ã€‚å½“æ—‹è½¬ä¹‹åï¼Œå¯ä»¥ç”¨$x(cos z, sin z)+y(-sin z, cos z)$æ¥å¾—åˆ°ç»è¿‡æ­£ç¡®æ—‹è½¬åçš„ç‚¹ã€‚ç»„åˆä¸ºåæ ‡å°±å˜æˆäº†$(xcosZâˆ’ysinZ,xsinZ+ycosZ)$.</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">override</span> <span class="n">Vector3</span> <span class="nf">Apply</span><span class="p">(</span><span class="n">Vector3</span> <span class="n">point</span><span class="p">)</span>
<span class="p">{</span> 
    <span class="kt">float</span> <span class="n">radz</span> <span class="p">=</span> <span class="n">rotation</span><span class="p">.</span><span class="n">z</span> <span class="p">*</span> <span class="n">Mathf</span><span class="p">.</span><span class="n">Deg2Rad</span><span class="p">;</span> 
    <span class="kt">float</span> <span class="n">sinz</span> <span class="p">=</span> <span class="n">Mathf</span><span class="p">.</span><span class="nf">Sin</span><span class="p">(</span><span class="n">radz</span><span class="p">);</span>
    <span class="kt">float</span> <span class="n">cosz</span> <span class="p">=</span> <span class="n">Mathf</span><span class="p">.</span><span class="nf">Cos</span><span class="p">(</span><span class="n">radz</span><span class="p">);</span> <span class="c1">//return point;</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nf">Vector3</span><span class="p">(</span>
        <span class="n">point</span><span class="p">.</span><span class="n">x</span> <span class="p">*</span> <span class="n">cosz</span> <span class="p">-</span> <span class="n">point</span><span class="p">.</span><span class="n">y</span> <span class="p">*</span> <span class="n">sinz</span><span class="p">,</span>
        <span class="n">point</span><span class="p">.</span><span class="n">x</span> <span class="p">*</span> <span class="n">sinz</span> <span class="p">+</span> <span class="n">point</span><span class="p">.</span><span class="n">y</span> <span class="p">*</span> <span class="n">cosz</span><span class="p">,</span>
        <span class="n">point</span><span class="p">.</span><span class="n">z</span>
    <span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div><p>æŒ‰ç…§ä¸Šè¿°åˆ†æçš„ç¼©æ”¾ã€æ—‹è½¬ã€ä½ç§»çš„å…ˆåè®¡ç®—é¡ºåºï¼Œå†åœ¨Unityå†…å¯¹æ¯”Transformçš„æ‹–åŠ¨æ—‹è½¬ç¼©æ”¾çš„æ˜¾ç¤ºï¼ŒäºŒè€…çš„æ•ˆæœæ˜¯ä¸€è‡´çš„ã€‚</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">void</span> <span class="nf">Start</span> <span class="p">()</span>
<span class="p">{</span> 
    <span class="c1">//...</span>
    <span class="n">gameObject</span><span class="p">.</span><span class="n">AddComponent</span><span class="p">&lt;</span><span class="n">ScaleTransformation</span><span class="p">&gt;();</span>
    <span class="n">gameObject</span><span class="p">.</span><span class="n">AddComponent</span><span class="p">&lt;</span><span class="n">RotationTransform</span><span class="p">&gt;();</span>
    <span class="n">gameObject</span><span class="p">.</span><span class="n">AddComponent</span><span class="p">&lt;</span><span class="n">PositionTransformation</span><span class="p">&gt;();</span>
<span class="p">}</span>
</code></pre></div></div><center class="half"><img class="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender1/move scale rotation.gif" width="" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>æœ€ç»ˆå˜æ¢æ•ˆæœ.</a></i></center> </font><h2 id="æ—‹è½¬å®Œå…¨ä½“">æ—‹è½¬å®Œå…¨ä½“</h2><p>-</p><p>ç°åœ¨æˆ‘ä»¬åªèƒ½ç»•Zè½´æ—‹è½¬ï¼Œä½†æ˜¯ä¸ºäº†èƒ½å¤Ÿå¤åˆ»Unityçš„Transformç»„ä»¶é‚£æ ·çš„æ—‹è½¬ï¼Œç°åœ¨å°±å¾—è¦æ”¯æŒç»•Xè½´å’Œç»•Yè½´æ—‹è½¬ã€‚è™½ç„¶åˆ†åˆ«ç»•è¿™äº›è½´æ—‹è½¬ä¸ç»•Zè½´æ—‹è½¬çš„æ–¹æ³•ç›¸ä¼¼ï¼Œä½†æ˜¯å½“ä¸€æ¬¡åŒæ—¶ç»•å¤šä¸ªè½´æ—‹è½¬æ—¶è¿™å°±å¾ˆå¤æ‚äº†ã€‚ç›®æ ‡ï¼šä¸€æ¬¡åŒæ—¶ç»•å¤šä¸ªè½´æ—‹è½¬ï¼Œè¿éš¾è€Œä¸Šã€‚</p><h3 id="2dçŸ©é˜µ">2DçŸ©é˜µ</h3><p>ç°åœ¨å¼€å§‹ï¼Œæˆ‘ä»¬è¦æŠŠåæ ‡ä¹¦å†™æ ¼å¼ç”±æ°´å¹³å¼æ›¿ä»£ä¸ºå‚ç›´å¼ã€‚æŠŠ(x,y)è¢«æ”¹å†™ä¸º \(\begin{bmatrix} x\\ y\\ \end{bmatrix}\) æŠŠ$(xcosZâˆ’ysinZ,xsinZ+ycosZ)$ä¹ŸåŒæ ·è¢«æ‹†åˆ†ä¸º \(\begin{bmatrix} xcosZ-ysinZ\\ xsinZ+ycosZ\\ \end{bmatrix}\) ï¼Œå†æŠŠè¿™ä¸ªè¡¨è¾¾å¼è¿›ä¸€æ­¥æ‹†åˆ†ï¼š \(\begin{bmatrix} cosZ&amp;-sinZ\\ sinZ&amp;cosZ\\ \end{bmatrix}\) \(\begin{bmatrix} x\\ y\\ \end{bmatrix}\) è¿™å°±æ˜¯çŸ©é˜µä¹˜æ³•ï¼Œ 2x2çŸ©é˜µçš„ç¬¬ä¸€åˆ—å€¼ä»£è¡¨Xè½´ï¼Œç¬¬äºŒåˆ—å€¼ä»£è¡¨äº†Yè½´ï¼Œè®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š \(\begin{bmatrix} Xx&amp;Yx\\ Xy&amp;Yy\\ \end{bmatrix}\) \(\begin{bmatrix} a\\ b\\ \end{bmatrix}\) = \(\begin{bmatrix} aXx + bYx\\ aXy + bYy\\ \end{bmatrix}\)</p><blockquote class="prompt-tip"><p>ç”±äºUnityæ˜¯é‡‡ç”¨å·¦æ‰‹æ³•åˆ™ï¼Œåœ¨ä¸Šæ–‡ä¸­å•ä½åœ†ä¸Šä¸€ç‚¹ç»•Zè½´æ—‹è½¬çš„å¢é‡åº¦ä¸åŒï¼Œcosä»£è¡¨Xè½´ï¼Œsinä»£è¡¨Yè½´ï¼Œåœ¨ç»“åˆæœ¬æ–‡çš„çŸ©é˜µå¯å¾— \(\begin{bmatrix} cos\theta&amp;-sin\theta\\ sin\theta&amp;cos\theta\\ \end{bmatrix}\) $=cos\theta$ \(\begin{bmatrix} 1&amp;0\\ 0&amp;1\\ \end{bmatrix}\) $+sin\theta$ \(\begin{bmatrix} 0&amp;-1\\ 1&amp;0\\ \end{bmatrix}\)</p></blockquote><p>æ•°å­¦ä¸Šå®šä¹‰ï¼Œå½“ä¸¤ä¸ªçŸ©é˜µç›¸ä¹˜æ—¶ï¼Œåªæœ‰åœ¨ç¬¬ä¸€ä¸ªçŸ©é˜µçš„åˆ—æ•°ï¼ˆcolumnï¼‰å’Œç¬¬äºŒä¸ªçŸ©é˜µçš„è¡Œæ•°ï¼ˆrowï¼‰ç›¸åŒæ—¶æ‰æœ‰æ„ä¹‰ã€‚ç»“æœçŸ©é˜µçš„æ¯é¡¹å…ƒç´ ç­‰äºç¬¬ä¸€ä¸ªçŸ©é˜µè¡Œå…ƒç´ ä¸ç¬¬äºŒä¸ªçŸ©é˜µåˆ—å…ƒç´ çš„ä¹˜ç§¯ä¹‹å’Œ \(\begin{bmatrix} 1&amp;2\\ 3&amp;4\\ \end{bmatrix}\) \(\begin{bmatrix} a&amp;c\\ b&amp;d\\ \end{bmatrix}\) = \(\begin{bmatrix} 1a+2b&amp;1c+2d\\ 3a+4b&amp;3c+4d\\ \end{bmatrix}\)</p><blockquote class="prompt-danger"><p>AçŸ©é˜µ * BçŸ©é˜µ = AçŸ©é˜µçš„è¡Œ * BçŸ©é˜µçš„åˆ—ï¼›åªæœ‰å½“AçŸ©é˜µåˆ—æ•° = BçŸ©é˜µè¡Œæ•°æ—¶ï¼ŒçŸ©é˜µç›¸ä¹˜æ‰æœ‰æ•ˆã€‚å› æ­¤ç»“æœçŸ©é˜µçš„è¡Œæ•°ç­‰äºç¬¬ä¸€ä¸ªçŸ©é˜µçš„è¡Œï¼Œåˆ—æ•°ç­‰äºç¬¬äºŒä¸ªçŸ©é˜µçš„åˆ—ç›¸åŒã€‚</p></blockquote><h3 id="3dçŸ©é˜µ">3DçŸ©é˜µ</h3><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬æœ‰äº†ä¸€ä¸ª2x2é˜¶çŸ©é˜µï¼Œå¯ä»¥ç”¨è¿™ä¸ªçŸ©é˜µæ¥ç»•Zè½´æ—‹è½¬ä¸€ä¸ª2Dç‚¹ã€‚ä½†æˆ‘ä»¬å®é™…ä¸Šä½¿ç”¨çš„æ˜¯3Dåæ ‡ã€‚è‹¥è¯•å›¾ç”¨è¿™ä¸ªçŸ©é˜µä¹˜æ³• \(\begin{bmatrix} cosZ&amp;-sinZ\\ sinZ&amp;cosZ\\ \end{bmatrix}\) \(\begin{bmatrix} x\\ y\\ z\\ \end{bmatrix}\) å°±æ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºè¿™ä¸¤ä¸ªçŸ©é˜µçš„è¡Œä¸åˆ—çš„ä¸ªæ•°ä¸åŒ¹é…ã€‚ä¸ºç¡®ä¿æ»¡è¶³çŸ©é˜µç›¸ä¹˜ï¼Œæˆ‘ä»¬å°±éœ€è¦å¡«å……è¿™ä¸ªç¬¬ä¸‰ç»´Zè½´ï¼Œå…ˆç”¨0å¡«å……ç¬¬ä¸€ä¸ªçŸ©é˜µç¬¬ä¸‰è¡Œï¼š \(\begin{bmatrix} cosZ&amp;-sinZ&amp;0\\ sinZ&amp;cosZ&amp;0\\ 0&amp;0&amp;0\\ \end{bmatrix}\) \(\begin{bmatrix} x\\ y\\ z\\ \end{bmatrix}\) = \(\begin{bmatrix} xcosZ-ysinZ+0z\\ xsinZ+ycosZ+0z\\ 0x+0y+0z\\ \end{bmatrix}\) = \(\begin{bmatrix} xcosZ-ysinZ\\ xsinZ+ycosZ\\ 0\\ \end{bmatrix}\)</p><p>å¾—åˆ°çš„ç»“æœä¸­Xè½´å’ŒYè½´æ˜¯æ­£ç¡®çš„ï¼Œä½†æ˜¯Zè½´ç»“æœæ€»æ˜¯ä¸º0ã€‚ä¸ºäº†ç¡®ä¿ç»•Zæ—‹è½¬è€Œä¸æ”¹å˜Zè½´çš„å€¼ï¼Œæˆ‘ä»¬å…ˆæ’å…¥ä¸€ä¸ªæ•°å­—1åœ¨æ—‹è½¬çŸ©é˜µçš„å³ä¸‹è§’ä½ç½®ã€‚ç®€åŒ–ç†è§£ï¼Œè¿™ä¸ªç¬¬ä¸‰åˆ—å€¼å°±æ˜¯ä»£è¡¨äº†Zè½´ï¼š \(\begin{bmatrix} cosZ&amp;-sinZ&amp;0\\ sinZ&amp;cosZ&amp;0\\ 0&amp;0&amp;1\\ \end{bmatrix}\) \(\begin{bmatrix} x\\ y\\ z\\ \end{bmatrix}\) = \(\begin{bmatrix} xcosZ-ysinZ\\ xsinZ+ycosZ\\ z\\ \end{bmatrix}\)</p><blockquote class="prompt-tip"><p>ç”±æ•°å­¦ä¸Šå®šä¹‰ï¼Œä»»ä½•çŸ©é˜µä¸å•ä½çŸ©é˜µç›¸ä¹˜éƒ½ç­‰äºæœ¬èº«ï¼Œå•ä½çŸ©é˜µå¦‚åŒä¹˜æ³•ä¸­çš„1<br /> \(\begin{bmatrix} 1&amp;0&amp;0\\ 0&amp;1&amp;0\\ 0&amp;0&amp;1\\ \end{bmatrix}\) \(\begin{bmatrix} x\\ y\\ z\\ \end{bmatrix}\) = \(\begin{bmatrix} x\\ y\\ z\\ \end{bmatrix}\)</p></blockquote><h3 id="ç»•xè½´å’Œyè½´çš„æ—‹è½¬çŸ©é˜µæ¨å¯¼">ç»•Xè½´å’ŒYè½´çš„æ—‹è½¬çŸ©é˜µæ¨å¯¼</h3><p>æ ¹æ®ç»•Zè½´æ—‹è½¬çš„æ–¹å¼æ¨ç†å¯ä»¥å¾—å‡ºç»•Xè½´å’ŒYè½´çš„æ—‹è½¬çŸ©é˜µã€‚</p><p>ä»¥ç»•Yè½´ä¸ºä¾‹ï¼Œé¦–å…ˆï¼ŒXè½´æ˜¯ä»¥ \(\begin{bmatrix} 1\\ 0\\ 0\\ \end{bmatrix}\) å¼€å§‹ï¼Œç»è¿‡<strong>é€†æ—¶é’ˆæ—‹è½¬90Â°</strong>åä»¥ \(\begin{bmatrix} 0\\ 0\\ -1\\ \end{bmatrix}\) ç»“æŸã€‚é‚£ä¹ˆç»è¿‡æ—‹è½¬åçš„Xè½´å¯ä»¥è¡¨ç¤ºä¸º \(\begin{bmatrix} cosY\\ 0\\ -sinY\\ \end{bmatrix}\) è€ŒZè½´ä¸Xè½´å‚ç›´ï¼Œæ‰€ä»¥Zè½´å°±æ˜¯ \(\begin{bmatrix} sinY\\ 0\\ cosY\\ \end{bmatrix}\) è€ŒYè½´å§‹ç»ˆä¿æŒä¸å˜ï¼Œæœ€åç»•Yè½´çš„æ—‹è½¬çŸ©é˜µï¼š \(\begin{bmatrix} cosY&amp;0&amp;sinY\\ 0&amp;1&amp;0\\ -sinY&amp;0&amp;cosY\\ \end{bmatrix}\) åŒç†ç»•Xè½´çš„æ—‹è½¬çŸ©é˜µï¼Œ Xè½´ä¸å˜ï¼š \(\begin{bmatrix} 1&amp;0&amp;0\\ 0&amp;cosX&amp;-sinX\\ 0&amp;sinX&amp;cosX\\ \end{bmatrix}\)</p><p>é‚£ä¹ˆå°±æ­¤å¯ä»¥å¾—å‡ºä¸‰ä¸ªçŸ©é˜µï¼š</p><ul><li>ç»•Xè½´æ—‹è½¬çŸ©é˜µ \(\begin{bmatrix} 1&amp;0&amp;0\\ 0&amp;cos\alpha&amp;sin\alpha\\ 0&amp;-sin\alpha&amp;cos\alpha\\ \end{bmatrix}\)<li>ç»•Yè½´æ—‹è½¬çŸ©é˜µ \(\begin{bmatrix} cos\theta&amp;0&amp;-sin\theta\\ 0&amp;1&amp;0\\ sin\theta&amp;0&amp;cos\theta\\ \end{bmatrix}\)<li>ç»•Zè½´æ—‹è½¬çŸ©é˜µ \(\begin{bmatrix} cos\theta&amp;sin\theta&amp;0\\ -sin\theta&amp;cos\theta&amp;0\\ 0&amp;0&amp;1\\ \end{bmatrix}\)</ul><h3 id="ç»Ÿä¸€çš„æ—‹è½¬çŸ©é˜µ">ç»Ÿä¸€çš„æ—‹è½¬çŸ©é˜µ</h3><p>é€šè¿‡ä¸Šæ–‡æˆ‘ä»¬åˆ†åˆ«å¾—åˆ°äº†å•ç‹¬ç»•æŸä¸ªè½´çš„æ—‹è½¬çŸ©é˜µï¼Œç°åœ¨å¼€å§‹æˆ‘ä»¬è¦ç»„åˆèµ·æ¥ä½¿ç”¨ã€‚è¿™é‡Œçš„åŒæ—¶æ—‹è½¬æœ¬è´¨ä¸Šä¹Ÿæ˜¯åˆ†æ­¥è¿›è¡Œçš„ï¼Œå…ˆç»•Zè½´æ—‹è½¬ï¼Œç„¶åç»•Yè½´ï¼Œæœ€åæ˜¯ç»•Xè½´ã€‚</p><p>è¿™é‡Œæœ‰ä¸¤ç§ç®—æ³•ï¼š</p><p>ç¬¬ä¸€ç§ï¼šå…ˆè®¡ç®—åæ ‡ç‚¹ç»•Zæ—‹è½¬ï¼Œå¾—å‡ºçš„ç»“æœåæ ‡å†è®¡ç®—ç»•Yè½´æ—‹è½¬ï¼Œå†å¾—å‡ºçš„ç»“æœåæ ‡è®¡ç®—ç»•Xè½´æ—‹è½¬ï¼Œæœ€åå¾—åˆ°æœ€ç»ˆçš„æ—‹è½¬åæ ‡ã€‚</p><p>ç¬¬äºŒç§ï¼šæŠŠæ¯ä¸ªæ—‹è½¬çŸ©é˜µç›¸ä¹˜å¾—åˆ°ä¸€ä¸ªæœ€ç»ˆçš„æ–°çš„æ—‹è½¬çŸ©é˜µï¼Œè¿™å°†åŒæ—¶ä½œç”¨ä¸ä¸‰ä¸ªè½´æ—‹è½¬ã€‚é¦–å…ˆè®¡ç®—Yä¹˜Zï¼Œè¿™ä¸ªç»“æœçŸ©é˜µçš„ç¬¬ä¸€é¡¹çš„å€¼æ˜¯$cosYcosZâˆ’0sinZâˆ’0sinY=cosYcosZ$ï¼Œæœ€ç»ˆçŸ©é˜µ \(\begin{bmatrix} cosYcosZ&amp;-cosYsinZ&amp;sinY\\ sinZ&amp;cosZ&amp;0\\ -sinYcosZ&amp;sinYsinZ&amp;cosY\\ \end{bmatrix}\)</p><p>æœ€åè®¡ç®—X Ã— (Y Ã— Z)å¾—å‡ºæœ€ç»ˆçŸ©é˜µï¼š \(\begin{bmatrix} cosYcosZ&amp;-cosYsinZ&amp;sinY\\ cosXsinZ+sinXsinYcosZ&amp;cosXcosZ-sinXsinYsinZ&amp;-sinXcosY\\ sinXsinZ-cosXsinYcosZ&amp;sinXcosZ+cosXsinYsinZ&amp;cosXcosY\\ \end{bmatrix}\)</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="n">Vector3</span> <span class="n">rotation</span><span class="p">;</span><span class="c1">//æ¯ä¸ªåˆ†é‡è¡¨ç¤ºè§’åº¦</span>
<span class="k">public</span> <span class="kt">int</span> <span class="n">rotDelta</span><span class="p">;</span> <span class="k">private</span> <span class="k">void</span> <span class="nf">Update</span><span class="p">()</span>
<span class="p">{</span>
     <span class="n">rotation</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Vector3</span><span class="p">(</span><span class="n">rotDelta</span><span class="p">,</span> <span class="n">rotDelta</span><span class="p">,</span> <span class="n">rotDelta</span><span class="p">);</span>
<span class="p">}</span> 
<span class="k">public</span> <span class="k">override</span> <span class="n">Vector3</span> <span class="nf">Apply</span><span class="p">(</span><span class="n">Vector3</span> <span class="n">point</span><span class="p">)</span>
<span class="p">{</span> 
    <span class="kt">float</span> <span class="n">radx</span> <span class="p">=</span> <span class="n">rotation</span><span class="p">.</span><span class="n">x</span> <span class="p">*</span> <span class="n">Mathf</span><span class="p">.</span><span class="n">Deg2Rad</span><span class="p">;</span>
    <span class="kt">float</span> <span class="n">rady</span> <span class="p">=</span> <span class="n">rotation</span><span class="p">.</span><span class="n">y</span> <span class="p">*</span> <span class="n">Mathf</span><span class="p">.</span><span class="n">Deg2Rad</span><span class="p">;</span>
    <span class="kt">float</span> <span class="n">radz</span> <span class="p">=</span> <span class="n">rotation</span><span class="p">.</span><span class="n">z</span> <span class="p">*</span> <span class="n">Mathf</span><span class="p">.</span><span class="n">Deg2Rad</span><span class="p">;</span>
    <span class="kt">float</span> <span class="n">sinx</span> <span class="p">=</span> <span class="n">Mathf</span><span class="p">.</span><span class="nf">Sin</span><span class="p">(</span><span class="n">radx</span><span class="p">);</span>
    <span class="kt">float</span> <span class="n">cosx</span> <span class="p">=</span> <span class="n">Mathf</span><span class="p">.</span><span class="nf">Cos</span><span class="p">(</span><span class="n">radx</span><span class="p">);</span>
    <span class="kt">float</span> <span class="n">siny</span> <span class="p">=</span> <span class="n">Mathf</span><span class="p">.</span><span class="nf">Sin</span><span class="p">(</span><span class="n">rady</span><span class="p">);</span>
    <span class="kt">float</span> <span class="n">cosy</span> <span class="p">=</span> <span class="n">Mathf</span><span class="p">.</span><span class="nf">Cos</span><span class="p">(</span><span class="n">rady</span><span class="p">);</span>
    <span class="kt">float</span> <span class="n">sinz</span> <span class="p">=</span> <span class="n">Mathf</span><span class="p">.</span><span class="nf">Sin</span><span class="p">(</span><span class="n">radz</span><span class="p">);</span>
    <span class="kt">float</span> <span class="n">cosz</span> <span class="p">=</span> <span class="n">Mathf</span><span class="p">.</span><span class="nf">Cos</span><span class="p">(</span><span class="n">radz</span><span class="p">);</span>

    <span class="n">Vector3</span> <span class="n">xRot</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Vector3</span><span class="p">(</span>
         <span class="n">cosy</span> <span class="p">*</span> <span class="n">cosz</span><span class="p">,</span>
         <span class="n">cosx</span> <span class="p">*</span> <span class="n">sinz</span> <span class="p">+</span> <span class="n">sinx</span> <span class="p">*</span> <span class="n">siny</span> <span class="p">*</span> <span class="n">cosz</span><span class="p">,</span>
         <span class="n">sinx</span> <span class="p">*</span> <span class="n">sinz</span> <span class="p">-</span> <span class="n">cosx</span> <span class="p">*</span> <span class="n">siny</span> <span class="p">*</span> <span class="n">cosz</span>
     <span class="p">);</span>
     <span class="n">Vector3</span> <span class="n">yRot</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Vector3</span><span class="p">(</span> <span class="p">-</span><span class="n">cosy</span> <span class="p">*</span> <span class="n">sinz</span><span class="p">,</span>
         <span class="n">cosx</span> <span class="p">*</span> <span class="n">cosz</span> <span class="p">-</span> <span class="n">sinx</span> <span class="p">*</span> <span class="n">siny</span> <span class="p">*</span> <span class="n">sinz</span><span class="p">,</span>
         <span class="n">sinx</span> <span class="p">*</span> <span class="n">cosz</span> <span class="p">+</span> <span class="n">cosx</span> <span class="p">*</span> <span class="n">siny</span> <span class="p">*</span> <span class="n">sinz</span>
     <span class="p">);</span>
     <span class="n">Vector3</span> <span class="n">zRot</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Vector3</span><span class="p">(</span>
         <span class="n">siny</span><span class="p">,</span> <span class="p">-</span><span class="n">sinx</span> <span class="p">*</span> <span class="n">cosy</span><span class="p">,</span>
         <span class="n">cosx</span> <span class="p">*</span> <span class="n">cosy</span>
     <span class="p">);</span>
     <span class="k">return</span> <span class="n">xRot</span> <span class="p">*</span> <span class="n">point</span><span class="p">.</span><span class="n">x</span> <span class="p">+</span> <span class="n">yRot</span> <span class="p">*</span> <span class="n">point</span><span class="p">.</span><span class="n">y</span> <span class="p">+</span> <span class="n">zRot</span> <span class="p">*</span> <span class="n">point</span><span class="p">.</span><span class="n">z</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div><h2 id="çŸ©é˜µå˜æ¢">çŸ©é˜µå˜æ¢</h2><p><em>å®ç°ä¸€ä¸ªçŸ©é˜µå®Œæˆç¼©æ”¾ã€æ—‹è½¬ã€ä½ç§»çš„è®¡ç®—</em></p><p>ä¸ºäº†å®ç°è¿™ä¸ªç›®æ ‡ï¼Œæ‰€ä»¥å€Ÿé‰´3.4æ—‹è½¬çŸ©é˜µç»„åˆçš„æ–¹å¼ï¼Œå…ˆå¯¹ç¼©æ”¾å’Œä½ç§»ç»„åˆï¼Œå³ä½ç§» x ç¼©æ”¾ã€‚</p><p><strong>ç¼©æ”¾</strong>ï¼Œæ ¹æ®å•ä½çŸ©é˜µçš„æ€§è´¨ï¼Œä»»ä½•çŸ©é˜µä¸å•ä½çŸ©é˜µç›¸ä¹˜çš„ç»“æœéƒ½æ˜¯æœ¬èº«ã€‚é‚£ä¹ˆå¯¹å•ä½çŸ©é˜µè¿›è¡Œç¼©æ”¾å³å¯ï¼š \(\begin{bmatrix} 2&amp;0&amp;0\\ 0&amp;3&amp;0\\ 0&amp;0&amp;4\\ \end{bmatrix}\) \(\begin{bmatrix} x\\ y\\ z\\ \end{bmatrix}\) = \(\begin{bmatrix} 2x\\ 3y\\ 4z\\ \end{bmatrix}\)</p><p><strong>ä½ç§»</strong>ï¼Œä¸æ˜¯å¯¹ä¸‰ä¸ªåˆ†é‡å®Œå…¨é‡æ–°è®¡ç®—ï¼Œè€Œæ˜¯åœ¨ç°æœ‰çš„åæ ‡ä¹‹ä¸Šè¿›è¡Œåç§»ã€‚å› æ­¤ç°åœ¨ä¸èƒ½ç®€å•çš„é‡æ–°è¡¨ç¤ºä¸º3x3é˜¶çŸ©é˜µï¼Œè€Œæ˜¯éœ€è¦é¢å¤–å¢åŠ ä¸€åˆ—è¡¨ç¤ºåç§»ã€‚ \(\begin{bmatrix} 1&amp;0&amp;0&amp;2\\ 0&amp;1&amp;0&amp;3\\ 0&amp;0&amp;1&amp;4\\ \end{bmatrix}\) \(\begin{bmatrix} x\\ y\\ z\\ \end{bmatrix}\) = \(\begin{bmatrix} x+2\\ y+3\\ z+4\\ \end{bmatrix}\)</p><p>ä½†æ˜¯ï¼Œåˆç”±äºçŸ©é˜µä¹˜æ³•è§„å®šï¼Œç¬¬ä¸€ä¸ªçŸ©é˜µçš„åˆ—æ•°ç­‰äºç¬¬äºŒä¸ªçŸ©é˜µçš„è¡Œæ•°æ‰æœ‰æ„ä¹‰ã€‚ä¸Šå›¾å°±æ˜¯é”™è¯¯çš„ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦ç»™åæ ‡çŸ©é˜µå¢åŠ ç¬¬å››ä¸ªå…ƒç´ ï¼Œåç§»çŸ©é˜µå¢åŠ ä¸€è¡Œã€‚å½“å®ƒä»¬å¢åŠ çš„è¿™ä¸ªåˆ†é‡è¿›è¡ŒçŸ©é˜µç›¸ä¹˜æ—¶ï¼Œå…¶ç»“æœä¸º1(æˆ‘ä»¬å…ˆä¿ç•™ä¸‹è¿™ä¸ªæ•°å­—1ï¼Œä»¥å¤‡åç»­ä½¿ç”¨).é‚£å°±å˜æˆäº†4x4é˜¶çŸ©é˜µæ ·å¼å’Œä¸€ä¸ª4Dç‚¹ã€‚ \(\begin{bmatrix} 1&amp;0&amp;0&amp;2\\ 0&amp;1&amp;0&amp;3\\ 0&amp;0&amp;1&amp;4\\ 0&amp;0&amp;0&amp;0\\ \end{bmatrix}\) \(\begin{bmatrix} x\\ y\\ z\\ 1\\ \end{bmatrix}\) = \(\begin{bmatrix} x+2\\ y+3\\ z+4\\ 1\\ \end{bmatrix}\)</p><p>æ ¹æ®ä½ç§»çŸ©é˜µï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç»Ÿä¸€ç”¨4Ã—4çš„å˜æ¢çŸ©é˜µã€‚ç¼©æ”¾å’Œæ—‹è½¬çŸ©é˜µä¼šé¢å¤–å¢åŠ ä¸€è¡Œä¸€åˆ—ï¼Œå…¶å³ä¸‹è§’æ˜¯1ã€‚æ‰€æœ‰çš„ç‚¹éƒ½å¸¦æœ‰ä¸€ä¸ªç¬¬å››ç»´åæ ‡åˆ†é‡ï¼Œå®ƒæ€»æ˜¯1â€”â€”å…¶æ¬¡åæ ‡ã€‚</p><h3 id="å…¶æ¬¡åæ ‡homogeneous-coordinates">å…¶æ¬¡åæ ‡(Homogeneous Coordinates)</h3><p>ä¸çŸ¥é“å°±é—®ï¼š</p><ul><li><em>è¿™ä¸ªåæ ‡çš„ç¬¬å››åˆ†é‡åæ ‡æ˜¯ä¸ªå•¥ï¼Ÿ</em><li><em>å®ƒæœ‰å•¥ç”¨å•Šï¼Ÿ</em><li><em>æˆ‘ä»¬åªçŸ¥é“ä¸Šæ–‡æåˆ°ä½ç§»æ—¶æœ‰ç”¨ï¼Œé‚£ä¹ˆç¼©æ”¾ã€æ—‹è½¬æœ‰ç”¨å—ï¼Ÿ</em><li><em>å½“å®ƒçš„å€¼ä¸º0ï¼Œ1ï¼Œ-1æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ</em></ul><p>æœ‰è¿™æ ·ä¸€ä¸ªä¸œè¥¿ä¸å«åæ ‡è€Œå«å‘é‡ï¼Œå®ƒå¯ä»¥è¢«ç¼©æ”¾å’Œæ—‹è½¬ï¼Œä½†ä¸èƒ½è¢«ç§»åŠ¨ã€‚å‘é‡æè¿°äº†ç›¸å¯¹äºæŸä¸ªç‚¹çš„åç§»ï¼Œå…·æœ‰æ–¹å‘å’Œé•¿åº¦å±æ€§ï¼Œæ²¡æœ‰ä½ç½®å±æ€§ã€‚</p><p>å®ƒ \(\begin{bmatrix} x\\ y\\ z\\ 1\\ \end{bmatrix}\) è¡¨ç¤ºä¸ºä¸€ä¸ªç‚¹ï¼Œè€Œå®ƒ \(\begin{bmatrix} x\\ y\\ z\\ 0\\ \end{bmatrix}\) è¡¨ç¤ºä¸ºä¸€ä¸ªå‘é‡ã€‚è¿™æ ·åŒºåˆ†éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç›¸åŒçš„çŸ©é˜µæ¥å˜æ¢ä¸€ä¸ªç‚¹çš„ä½ç½®ã€æ³•çº¿å’Œåˆ‡çº¿ã€‚</p><p>å½“ç¬¬å››ä¸ªåæ ‡å€¼æ˜¯0æˆ–1æˆ–å…¶ä»–æ•°å€¼æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿç­”æ¡ˆæ˜¯ä»€ä¹ˆä¹Ÿä¸ä¼šï¼Œå‡†ç¡®çš„è¯´æ˜¯æ²¡æœ‰å·®å¼‚ã€‚<strong>è¿™ä¸ªåæ ‡çš„æœ¯è¯­å«åšå…¶æ¬¡åæ ‡</strong>ï¼Œå®ƒçš„æ„æ€æ˜¯ç©ºé—´ä¸­æ¯ä¸ªç‚¹éƒ½å¯ä»¥ç”¨ä¸€ä¸ªæ— ç©·æ•°é‡åæ ‡é›†å’Œæ¥è¡¨ç¤ºã€‚è€Œç°åœ¨æ™®éåšæ³•çš„å½¢å¼æ˜¯ä½¿ç”¨1ä½œä¸ºç¬¬å››ä¸ªåæ ‡å€¼ï¼Œæ‰€æœ‰å…¶ä»–çš„æ•°å­—éƒ½èƒ½é€šè¿‡ä½¿ç”¨æ•´ä¸ªé›†åˆä¹˜ä»¥ä»»æ„æ•°æ¥æ‰¾åˆ°</p><p>\(\begin{bmatrix} x\\ y\\ z\\ 1\\ \end{bmatrix}\) \(\begin{bmatrix} 2x\\ 2y\\ 2z\\ 2\\ \end{bmatrix}\) \(\begin{bmatrix} 3x\\ 3y\\ 3z\\ 3\\ \end{bmatrix}\) \(\begin{bmatrix} wx\\ wy\\ wz\\ w\\ \end{bmatrix}\) = $w$ \(\begin{bmatrix} x\\ y\\ z\\ 1\\ \end{bmatrix}\)</p><p>å½“æˆ‘ä»¬çŸ¥é“äº†ä¸€ä¸ªå…¶æ¬¡åæ ‡æ—¶ï¼Œéœ€è¦è½¬ä¸º3Dåæ ‡ï¼Œåªéœ€è¦æŠŠç¬¬å››ä¸ªåæ ‡åŒ–ä¸º1ï¼Œæ€ä¹ˆåšå‘¢ï¼Ÿæ²¡é”™ï¼Œå°±æ˜¯æŠŠæ¯ä¸ªåæ ‡é™¤ä»¥ç¬¬å››ä¸ªåæ ‡ï¼Œç„¶åå†èˆå¼ƒç¬¬å››ä¸ªåæ ‡ \(\begin{bmatrix} x\\ y\\ z\\ w\\ \end{bmatrix}\) =$1 \over w$ \(\begin{bmatrix} x\\ y\\ z\\ w\\ \end{bmatrix}\) = \(\begin{bmatrix} x \over w\\ y \over w\\ z \over w\\ 1\\ \end{bmatrix}\) $\rightarrow$ \(\begin{bmatrix} x \over w\\ y \over w\\ z \over w\\ \end{bmatrix}\)</p><p>æ‰€ä»¥å½“ç¬¬å››ä¸ªåæ ‡ä¸º0æ—¶æ˜¯ä¸èƒ½åšä¸Šé¢çš„é™¤æ³•çš„ï¼Œå› æ­¤å½“ç¬¬å››ä¸ªåæ ‡å€¼ä¸º0æ—¶ï¼Œè¡¨ç¤ºä¸ºå‘é‡ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆå®ƒä»¬åƒæ–¹å‘ä¸€æ ·ã€‚</p><h3 id="ä½¿ç”¨çŸ©é˜µ">ä½¿ç”¨çŸ©é˜µ</h3><p>æˆ‘ä»¬èƒ½ç”¨Unityçš„Matrix4x4ç»“æ„ä½“æ¥å®ŒæˆçŸ©é˜µä¹˜æ³•ã€‚ä»ç°åœ¨å¼€å§‹ï¼Œæˆ‘ä»¬å°†ç”¨å®ƒæ¥ä»£æ›¿ä¸Šé¢çš„3Dæ—‹è½¬æ–¹æ³•ã€‚</p><p>åœ¨Transformationå¢åŠ ä¸€ä¸ªæŠ½è±¡åªè¯»å±æ€§ä»¥æ£€ç´¢å˜æ¢çŸ©é˜µã€‚</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">abstract</span> <span class="n">Matrix4x4</span> <span class="n">Matrix</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
</code></pre></div></div><p>Transformationç»„ä»¶çš„Applyæ–¹æ³•ä¸å†éœ€è¦è®¾ä¸ºæŠ½è±¡ï¼Œå®ƒå°†è·å–åˆ°çŸ©é˜µå¹¶æ‰§è¡Œä¹˜æ³•è¿ç®—ã€‚</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="n">Vector3</span> <span class="nf">Apply</span> <span class="p">(</span><span class="n">Vector3</span> <span class="n">point</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">Matrix</span><span class="p">.</span><span class="nf">MultiplyPoint</span><span class="p">(</span><span class="n">point</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div><p>æ³¨æ„è¿™ä¸ª<a href="http://docs.unity3d.com/Documentation/ScriptReference/Matrix4x4.html">Matrix4x4.MultiplyPoint</a>éœ€è¦ä¸€ä¸ª3Dåæ ‡å‚æ•°ï¼Œåæ ‡å‚æ•°å‡å®šäº†ç¬¬å››ä¸ªå€¼ä¸º1.è¯¥æ–¹æ³•ä¼šè´Ÿè´£æŠŠå¾—åˆ°çš„å…¶æ¬¡åæ ‡è½¬ä¸º3Dåæ ‡ï¼Œè‹¥åªæƒ³è®¡ç®—æ–¹å‘å‘é‡å¯ä»¥ä½¿ç”¨<a href="http://docs.unity3d.com/Documentation/ScriptReference/Matrix4x4.html">Matrix4x4.MultiplyVector</a>.è¯¥æ–¹æ³•ä¼šå¿½ç•¥ç¬¬å››ä¸ªåæ ‡ã€‚</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="n">Vector3</span> <span class="nf">MultiplyPoint</span><span class="p">(</span><span class="n">Vector3</span> <span class="n">v</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Vector3</span> <span class="n">vector</span><span class="p">;</span>
    <span class="n">vector</span><span class="p">.</span><span class="n">x</span> <span class="p">=</span> <span class="p">(((</span><span class="k">this</span><span class="p">.</span><span class="n">m00</span> <span class="p">*</span> <span class="n">v</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="p">+</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">m01</span> <span class="p">*</span> <span class="n">v</span><span class="p">.</span><span class="n">y</span><span class="p">))</span> <span class="p">+</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">m02</span> <span class="p">*</span> <span class="n">v</span><span class="p">.</span><span class="n">z</span><span class="p">))</span> <span class="p">+</span> <span class="k">this</span><span class="p">.</span><span class="n">m03</span><span class="p">;</span>
    <span class="n">vector</span><span class="p">.</span><span class="n">y</span> <span class="p">=</span> <span class="p">(((</span><span class="k">this</span><span class="p">.</span><span class="n">m10</span> <span class="p">*</span> <span class="n">v</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="p">+</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">m11</span> <span class="p">*</span> <span class="n">v</span><span class="p">.</span><span class="n">y</span><span class="p">))</span> <span class="p">+</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">m12</span> <span class="p">*</span> <span class="n">v</span><span class="p">.</span><span class="n">z</span><span class="p">))</span> <span class="p">+</span> <span class="k">this</span><span class="p">.</span><span class="n">m13</span><span class="p">;</span>
    <span class="n">vector</span><span class="p">.</span><span class="n">z</span> <span class="p">=</span> <span class="p">(((</span><span class="k">this</span><span class="p">.</span><span class="n">m20</span> <span class="p">*</span> <span class="n">v</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="p">+</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">m21</span> <span class="p">*</span> <span class="n">v</span><span class="p">.</span><span class="n">y</span><span class="p">))</span> <span class="p">+</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">m22</span> <span class="p">*</span> <span class="n">v</span><span class="p">.</span><span class="n">z</span><span class="p">))</span> <span class="p">+</span> <span class="k">this</span><span class="p">.</span><span class="n">m23</span><span class="p">;</span> 
    <span class="kt">float</span> <span class="n">num</span> <span class="p">=</span> <span class="p">(((</span><span class="k">this</span><span class="p">.</span><span class="n">m30</span> <span class="p">*</span> <span class="n">v</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="p">+</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">m31</span> <span class="p">*</span> <span class="n">v</span><span class="p">.</span><span class="n">y</span><span class="p">))</span> <span class="p">+</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">m32</span> <span class="p">*</span> <span class="n">v</span><span class="p">.</span><span class="n">z</span><span class="p">))</span> <span class="p">+</span> <span class="k">this</span><span class="p">.</span><span class="n">m33</span><span class="p">;</span><span class="c1">//å…¶æ¬¡åæ ‡</span>
    <span class="n">num</span> <span class="p">=</span> <span class="m">1f</span> <span class="p">/</span> <span class="n">num</span><span class="p">;</span>
    <span class="n">vector</span><span class="p">.</span><span class="n">x</span> <span class="p">*=</span> <span class="n">num</span><span class="p">;</span><span class="c1">//è½¬æ¢è®¡ç®—</span>
    <span class="n">vector</span><span class="p">.</span><span class="n">y</span> <span class="p">*=</span> <span class="n">num</span><span class="p">;</span><span class="c1">//è½¬æ¢è®¡ç®—</span>
    <span class="n">vector</span><span class="p">.</span><span class="n">z</span> <span class="p">*=</span> <span class="n">num</span><span class="p">;</span><span class="c1">//è½¬æ¢è®¡ç®—</span>
    <span class="k">return</span> <span class="n">vector</span><span class="p">;</span>
<span class="p">}</span> 
<span class="k">public</span> <span class="n">Vector3</span> <span class="nf">MultiplyVector</span><span class="p">(</span><span class="n">Vector3</span> <span class="n">v</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Vector3</span> <span class="n">vector</span><span class="p">;</span>
    <span class="n">vector</span><span class="p">.</span><span class="n">x</span> <span class="p">=</span> <span class="p">((</span><span class="k">this</span><span class="p">.</span><span class="n">m00</span> <span class="p">*</span> <span class="n">v</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="p">+</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">m01</span> <span class="p">*</span> <span class="n">v</span><span class="p">.</span><span class="n">y</span><span class="p">))</span> <span class="p">+</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">m02</span> <span class="p">*</span> <span class="n">v</span><span class="p">.</span><span class="n">z</span><span class="p">);</span>
    <span class="n">vector</span><span class="p">.</span><span class="n">y</span> <span class="p">=</span> <span class="p">((</span><span class="k">this</span><span class="p">.</span><span class="n">m10</span> <span class="p">*</span> <span class="n">v</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="p">+</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">m11</span> <span class="p">*</span> <span class="n">v</span><span class="p">.</span><span class="n">y</span><span class="p">))</span> <span class="p">+</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">m12</span> <span class="p">*</span> <span class="n">v</span><span class="p">.</span><span class="n">z</span><span class="p">);</span>
    <span class="n">vector</span><span class="p">.</span><span class="n">z</span> <span class="p">=</span> <span class="p">((</span><span class="k">this</span><span class="p">.</span><span class="n">m20</span> <span class="p">*</span> <span class="n">v</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="p">+</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">m21</span> <span class="p">*</span> <span class="n">v</span><span class="p">.</span><span class="n">y</span><span class="p">))</span> <span class="p">+</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">m22</span> <span class="p">*</span> <span class="n">v</span><span class="p">.</span><span class="n">z</span><span class="p">);</span> 
    <span class="k">return</span> <span class="n">vector</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div><p>å…·ä½“çš„Transformationç±»ç°åœ¨å¿…é¡»å°†å…¶<em>Apply()</em>æ–¹æ³•æ›´æ”¹ä¸º<em>Matrix</em>å±æ€§ã€‚</p><p>é¦–å…ˆæ˜¯PositionTransformationç»„ä»¶ï¼Œ<a href="http://docs.unity3d.com/Documentation/ScriptReference/Matrix4x4.html">Matrix4x4.SetRow</a>æ¥å£èƒ½å¾ˆç®€æ˜“åœ°å¡«å……è¿™ä¸ªçŸ©é˜µã€‚</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">override</span> <span class="n">Matrix4x4</span> <span class="n">Matrix</span> <span class="p">{</span> 
    <span class="k">get</span> <span class="p">{</span>
        <span class="n">Matrix4x4</span> <span class="n">matrix</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Matrix4x4</span><span class="p">();</span>
        <span class="n">matrix</span><span class="p">.</span><span class="nf">SetRow</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Vector4</span><span class="p">(</span><span class="m">1f</span><span class="p">,</span> <span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">,</span> <span class="n">position</span><span class="p">.</span><span class="n">x</span><span class="p">));</span>
        <span class="n">matrix</span><span class="p">.</span><span class="nf">SetRow</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Vector4</span><span class="p">(</span><span class="m">0f</span><span class="p">,</span> <span class="m">1f</span><span class="p">,</span> <span class="m">0f</span><span class="p">,</span> <span class="n">position</span><span class="p">.</span><span class="n">y</span><span class="p">));</span>
        <span class="n">matrix</span><span class="p">.</span><span class="nf">SetRow</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Vector4</span><span class="p">(</span><span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">,</span> <span class="m">1f</span><span class="p">,</span> <span class="n">position</span><span class="p">.</span><span class="n">z</span><span class="p">));</span>
        <span class="n">matrix</span><span class="p">.</span><span class="nf">SetRow</span><span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Vector4</span><span class="p">(</span><span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">,</span> <span class="m">1f</span><span class="p">));</span>
        <span class="k">return</span> <span class="n">matrix</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div><p>å…¶æ¬¡æ˜¯<strong>ScaleTransformation</strong>.</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">override</span> <span class="n">Matrix4x4</span> <span class="n">Matrix</span> <span class="p">{</span> <span class="k">get</span> <span class="p">{</span>
        <span class="n">Matrix4x4</span> <span class="n">matrix</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Matrix4x4</span><span class="p">();</span>
        <span class="n">matrix</span><span class="p">.</span><span class="nf">SetRow</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Vector4</span><span class="p">(</span><span class="n">scale</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">));</span>
        <span class="n">matrix</span><span class="p">.</span><span class="nf">SetRow</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Vector4</span><span class="p">(</span><span class="m">0f</span><span class="p">,</span> <span class="n">scale</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">));</span>
        <span class="n">matrix</span><span class="p">.</span><span class="nf">SetRow</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Vector4</span><span class="p">(</span><span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">,</span> <span class="n">scale</span><span class="p">.</span><span class="n">z</span><span class="p">,</span> <span class="m">0f</span><span class="p">));</span>
        <span class="n">matrix</span><span class="p">.</span><span class="nf">SetRow</span><span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Vector4</span><span class="p">(</span><span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">,</span> <span class="m">1f</span><span class="p">));</span> <span class="k">return</span> <span class="n">matrix</span><span class="p">;</span>
     <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div><p>æœ€åæ˜¯<strong>RotationTransformation</strong>, å®ƒè®¾ç½®è¡Œä¸åˆ—å°±æ›´ç®€å•äº†ï¼ŒæŠŠä¹‹å‰çš„æ–¹æ³•æ”¹æ”¹å°±èƒ½ç”¨ã€‚</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">override</span> <span class="n">Matrix4x4</span> <span class="n">Matrix</span> <span class="p">{</span> 
    <span class="k">get</span> <span class="p">{</span> 
        <span class="kt">float</span> <span class="n">radx</span> <span class="p">=</span> <span class="n">rotation</span><span class="p">.</span><span class="n">x</span> <span class="p">*</span> <span class="n">Mathf</span><span class="p">.</span><span class="n">Deg2Rad</span><span class="p">;</span>
        <span class="kt">float</span> <span class="n">rady</span> <span class="p">=</span> <span class="n">rotation</span><span class="p">.</span><span class="n">y</span> <span class="p">*</span> <span class="n">Mathf</span><span class="p">.</span><span class="n">Deg2Rad</span><span class="p">;</span>
        <span class="kt">float</span> <span class="n">radz</span> <span class="p">=</span> <span class="n">rotation</span><span class="p">.</span><span class="n">z</span> <span class="p">*</span> <span class="n">Mathf</span><span class="p">.</span><span class="n">Deg2Rad</span><span class="p">;</span>
        <span class="kt">float</span> <span class="n">sinx</span> <span class="p">=</span> <span class="n">Mathf</span><span class="p">.</span><span class="nf">Sin</span><span class="p">(</span><span class="n">radx</span><span class="p">);</span>
        <span class="kt">float</span> <span class="n">cosx</span> <span class="p">=</span> <span class="n">Mathf</span><span class="p">.</span><span class="nf">Cos</span><span class="p">(</span><span class="n">radx</span><span class="p">);</span>
        <span class="kt">float</span> <span class="n">siny</span> <span class="p">=</span> <span class="n">Mathf</span><span class="p">.</span><span class="nf">Sin</span><span class="p">(</span><span class="n">rady</span><span class="p">);</span>
        <span class="kt">float</span> <span class="n">cosy</span> <span class="p">=</span> <span class="n">Mathf</span><span class="p">.</span><span class="nf">Cos</span><span class="p">(</span><span class="n">rady</span><span class="p">);</span>
        <span class="kt">float</span> <span class="n">sinz</span> <span class="p">=</span> <span class="n">Mathf</span><span class="p">.</span><span class="nf">Sin</span><span class="p">(</span><span class="n">radz</span><span class="p">);</span>
        <span class="kt">float</span> <span class="n">cosz</span> <span class="p">=</span> <span class="n">Mathf</span><span class="p">.</span><span class="nf">Cos</span><span class="p">(</span><span class="n">radz</span><span class="p">);</span>

        <span class="n">Matrix4x4</span> <span class="n">matrix</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Matrix4x4</span><span class="p">();</span>
        <span class="n">matrix</span><span class="p">.</span><span class="nf">SetColumn</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Vector4</span><span class="p">(</span>
            <span class="n">cosy</span> <span class="p">*</span> <span class="n">cosz</span><span class="p">,</span>
            <span class="n">cosx</span> <span class="p">*</span> <span class="n">sinz</span> <span class="p">+</span> <span class="n">sinx</span> <span class="p">*</span> <span class="n">siny</span> <span class="p">*</span> <span class="n">cosz</span><span class="p">,</span>
            <span class="n">sinx</span> <span class="p">*</span> <span class="n">sinz</span> <span class="p">-</span> <span class="n">cosx</span> <span class="p">*</span> <span class="n">siny</span> <span class="p">*</span> <span class="n">cosz</span><span class="p">,</span>
            <span class="m">0f</span>
        <span class="p">));</span>
        <span class="n">matrix</span><span class="p">.</span><span class="nf">SetColumn</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Vector4</span><span class="p">(</span> <span class="p">-</span><span class="n">cosy</span> <span class="p">*</span> <span class="n">sinz</span><span class="p">,</span>
            <span class="n">cosx</span> <span class="p">*</span> <span class="n">cosz</span> <span class="p">-</span> <span class="n">sinx</span> <span class="p">*</span> <span class="n">siny</span> <span class="p">*</span> <span class="n">sinz</span><span class="p">,</span>
            <span class="n">sinx</span> <span class="p">*</span> <span class="n">cosz</span> <span class="p">+</span> <span class="n">cosx</span> <span class="p">*</span> <span class="n">siny</span> <span class="p">*</span> <span class="n">sinz</span><span class="p">,</span>
            <span class="m">0f</span>
        <span class="p">));</span>
        <span class="n">matrix</span><span class="p">.</span><span class="nf">SetColumn</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Vector4</span><span class="p">(</span>
            <span class="n">siny</span><span class="p">,</span> <span class="p">-</span><span class="n">sinx</span> <span class="p">*</span> <span class="n">cosy</span><span class="p">,</span>
            <span class="n">cosx</span> <span class="p">*</span> <span class="n">cosy</span><span class="p">,</span>
        <span class="p">));</span>
        <span class="n">matrix</span><span class="p">.</span><span class="nf">SetColumn</span><span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Vector4</span><span class="p">(</span><span class="m">0f</span><span class="p">,</span><span class="m">0f</span><span class="p">,</span><span class="m">0f</span><span class="p">,</span><span class="m">1f</span><span class="p">));</span>
        <span class="k">return</span> <span class="n">matrix</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div><h3 id="åˆå¹¶çŸ©é˜µ">åˆå¹¶çŸ©é˜µ</h3><p>ç°åœ¨æˆ‘ä»¬æŠŠä¸Šè¿°æ‰€æœ‰å˜æ¢çŸ©é˜µåˆå¹¶ä¸ºä¸€ä¸ªçŸ©é˜µã€‚ ä¸ºæ­¤å…ˆåœ¨UnityMatricesç±»å¢åŠ ä¸€ä¸ªçŸ©é˜µç±»å‹å­—æ®µtransformationã€‚æˆ‘ä»¬å°†åœ¨Updateå‡½æ•°æ¯å¸§æ›´æ–°è¯¥å˜é‡å€¼ï¼Œè¯¥æ­¥éª¤ä¸ºå…ˆè·å–åˆ°ç¬¬ä¸€ä¸ªTransformationç»„ä»¶çš„çŸ©é˜µï¼Œå¹¶ä¾æ¬¡ä¸å…¶ä»–çŸ©é˜µç›¸ä¹˜ï¼Œéœ€è¦ç¡®ä¿è¿™å—æ­£ç¡®çš„ç›¸ä¹˜é¡ºåºã€‚</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">private</span> <span class="k">void</span> <span class="nf">Update</span><span class="p">()</span> <span class="p">{</span> 
    <span class="nf">UpdateTransformation</span><span class="p">();</span> <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span><span class="m">0</span> <span class="p">,</span> <span class="n">z</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">z</span> <span class="p">&lt;</span> <span class="n">generalCount</span><span class="p">;</span> <span class="n">z</span><span class="p">++)</span>
    <span class="p">{</span>
        <span class="c1">//... </span>
    <span class="p">}</span> 
<span class="p">}</span>
<span class="k">void</span> <span class="nf">UpdateTransformation</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">GetComponents</span><span class="p">&lt;</span><span class="n">Transformation</span><span class="p">&gt;(</span><span class="n">transformations</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">transformations</span><span class="p">.</span><span class="n">Count</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">transformation</span> <span class="p">=</span> <span class="n">transformations</span><span class="p">[</span><span class="m">0</span><span class="p">].</span><span class="n">Matrix</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">1</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">transformations</span><span class="p">.</span><span class="n">Count</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span> 
        <span class="p">{</span>
            <span class="n">transformation</span> <span class="p">=</span> <span class="n">transformations</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">Matrix</span> <span class="p">*</span> <span class="n">transformation</span><span class="p">;</span>     
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div><p>æœ€åä¸å†æ‰§è¡ŒApplyæ–¹æ³•ï¼Œè€Œæ”¹ç”¨çŸ©é˜µä¹˜æ³•ä»£æ›¿ï¼š</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Vector3</span> <span class="nf">TransformPoint</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">,</span> <span class="kt">int</span> <span class="n">z</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Vector3</span> <span class="n">coordinates</span> <span class="p">=</span> <span class="nf">CreateCoordinate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">);</span>
    <span class="c1">// for (int i = 0; i &lt; transformations.Count; i++)</span>
    <span class="c1">// { </span>
        <span class="c1">// coordinates = transformations[i].Apply(coordinates); </span>
    <span class="c1">// }</span>
    <span class="k">return</span> <span class="n">transformation</span><span class="p">.</span><span class="nf">MultiplyPoint</span><span class="p">(</span><span class="n">coordinates</span><span class="p">);;</span>
<span class="p">}</span>
</code></pre></div></div><p>è¿™ä¸ªæ–°æ–¹æ³•æ˜¯éå¸¸æœ‰æ•ˆçš„ï¼Œå› ä¸ºæˆ‘ä»¬ä¹‹å‰ä½¿ç”¨çš„æ–¹æ³•æ˜¯åˆ†åˆ«ç»™æ¯ä¸ªç‚¹ä¹˜ä¸€ä¸ªå˜æ¢çŸ©é˜µã€‚è€Œç°åœ¨æˆ‘ä»¬åªéœ€è¦ä¸€æ¬¡åˆ›å»ºä¸€ä¸ªç»Ÿä¸€çš„å˜æ¢çŸ©é˜µä½œç”¨ä¸æ‰€æœ‰ç‚¹ã€‚Unityä½¿ç”¨ç±»ä¼¼çš„æ–¹æ¡ˆå°†æ¯ä¸ªå¯¹è±¡çš„å˜æ¢å±‚æ¬¡ç»“æ„ç®€åŒ–ä¸ºå•ä¸ªå˜æ¢çŸ©é˜µã€‚</p><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿å®ƒæ›´æœ‰æ•ˆã€‚æ‰€æœ‰çš„å˜æ¢çŸ©é˜µéƒ½æœ‰ä¸€ä¸ªç›¸åŒçš„è¡Œâ€”â€”[0 0 0 1]ã€‚çŸ¥é“äº†è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥å¿½ç•¥è¿™ä¸€è¡Œï¼Œè·³è¿‡æ‰€æœ‰0çš„è®¡ç®—å’Œæœ€åçš„é™¤æ³•è½¬æ¢ã€‚Matrix4x4.MultiplayPoint3x4æ–¹æ³•å°±æ˜¯è¿™æ ·åšçš„ã€‚</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="n">Vector3</span> <span class="nf">MultiplyPoint3x4</span><span class="p">(</span><span class="n">Vector3</span> <span class="n">v</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Vector3</span> <span class="n">vector</span><span class="p">;</span>
    <span class="n">vector</span><span class="p">.</span><span class="n">x</span> <span class="p">=</span> <span class="p">(((</span><span class="k">this</span><span class="p">.</span><span class="n">m00</span> <span class="p">*</span> <span class="n">v</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="p">+</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">m01</span> <span class="p">*</span> <span class="n">v</span><span class="p">.</span><span class="n">y</span><span class="p">))</span> <span class="p">+</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">m02</span> <span class="p">*</span> <span class="n">v</span><span class="p">.</span><span class="n">z</span><span class="p">))</span> <span class="p">+</span> <span class="k">this</span><span class="p">.</span><span class="n">m03</span><span class="p">;</span>
    <span class="n">vector</span><span class="p">.</span><span class="n">y</span> <span class="p">=</span> <span class="p">(((</span><span class="k">this</span><span class="p">.</span><span class="n">m10</span> <span class="p">*</span> <span class="n">v</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="p">+</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">m11</span> <span class="p">*</span> <span class="n">v</span><span class="p">.</span><span class="n">y</span><span class="p">))</span> <span class="p">+</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">m12</span> <span class="p">*</span> <span class="n">v</span><span class="p">.</span><span class="n">z</span><span class="p">))</span> <span class="p">+</span> <span class="k">this</span><span class="p">.</span><span class="n">m13</span><span class="p">;</span>
    <span class="n">vector</span><span class="p">.</span><span class="n">z</span> <span class="p">=</span> <span class="p">(((</span><span class="k">this</span><span class="p">.</span><span class="n">m20</span> <span class="p">*</span> <span class="n">v</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="p">+</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">m21</span> <span class="p">*</span> <span class="n">v</span><span class="p">.</span><span class="n">y</span><span class="p">))</span> <span class="p">+</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">m22</span> <span class="p">*</span> <span class="n">v</span><span class="p">.</span><span class="n">z</span><span class="p">))</span> <span class="p">+</span> <span class="k">this</span><span class="p">.</span><span class="n">m23</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">vector</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div><p>è¿™ä¸ªæ–¹æ³•æœ‰æ—¶å€™æœ‰ç”¨ï¼Œæœ‰æ—¶å€™ä¸èƒ½ç”¨ã€‚å› ä¸ºæœ‰æ—¶æˆ‘ä»¬éœ€è¦çš„ä¸€äº›å˜æ¢çŸ©é˜µä¼šæ”¹å˜è¿™æœ€åä¸€è¡Œã€‚</p><p>åˆ°ç›®å‰ä¸ºæ­¢åªæœ‰ä½ç§»å˜æ¢éœ€è¦ç¬¬å››è¡Œã€‚æ‰€ä»¥ç¼©æ”¾ã€æ—‹è½¬ä½¿ç”¨Matrix4x4.MultiplayPoint3x4è®¡ç®—é€Ÿåº¦ä¼šæ›´å¿«ã€‚ç°åœ¨å°±æŠŠApply()æ–¹æ³•æ”¹ä¸ºè™šæ–¹æ³•ï¼Œå†ç”±æ—‹è½¬ã€ç¼©æ”¾ç»„ä»¶é‡å†™ï¼Œä»£ç å°±ä¸è´´äº†ã€‚</p><h2 id="3dåˆ°2dæŠ•å½±çŸ©é˜µ">3Dåˆ°2DæŠ•å½±çŸ©é˜µ</h2><p><em>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬èƒ½å¤ŸæŠŠä¸€ä¸ªç‚¹çš„åæ ‡ä»ä¸€ä¸ª3Dç©ºé—´å˜æ¢åˆ°å¦ä¸€ä¸ª3Dç©ºé—´ã€‚ä½†æ˜¯è¿™äº›ç‚¹åˆå¦‚ä½•å±•ç¤ºåˆ°2Dç©ºé—´å‘¢ï¼Ÿè¿™è‚¯å®šéœ€è¦ä¸€ä¸ªä»3Dåˆ°2Dçš„å˜æ¢çŸ©é˜µã€‚é‚£ä¹ˆæˆ‘ä»¬å¼€å§‹å¯»æ‰¾è¿™ä¸ªçŸ©é˜µå§ï¼</em></p><p>å…ˆæ„é€ ä¸€ä¸ªæ–°çš„ç»§æ‰¿è‡ªTransformationçš„å®ä½“å˜æ¢ç»„ä»¶ä½œç”¨äºæ‘„åƒæœºçš„æŠ•å½±ï¼Œé»˜è®¤å€¼ä¸ºå•ä½çŸ©é˜µã€‚</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">class</span> <span class="nc">CameraTransformation</span> <span class="p">:</span> <span class="n">Transformation</span>
<span class="p">{</span> 
    <span class="k">public</span> <span class="k">override</span> <span class="n">Matrix4x4</span> <span class="n">Matrix</span> <span class="p">{</span> 
        <span class="k">get</span> <span class="p">{</span>
            <span class="n">Matrix4x4</span> <span class="n">matrix</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Matrix4x4</span><span class="p">();</span>
            <span class="n">matrix</span><span class="p">.</span><span class="nf">SetRow</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Vector4</span><span class="p">(</span><span class="m">1f</span><span class="p">,</span> <span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">));</span>
            <span class="n">matrix</span><span class="p">.</span><span class="nf">SetRow</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Vector4</span><span class="p">(</span><span class="m">0f</span><span class="p">,</span> <span class="m">1f</span><span class="p">,</span> <span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">));</span>
            <span class="n">matrix</span><span class="p">.</span><span class="nf">SetRow</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Vector4</span><span class="p">(</span><span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">,</span> <span class="m">1f</span><span class="p">,</span> <span class="m">0f</span><span class="p">));</span>
            <span class="n">matrix</span><span class="p">.</span><span class="nf">SetRow</span><span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Vector4</span><span class="p">(</span><span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">,</span> <span class="m">1f</span><span class="p">));</span>
            <span class="k">return</span> <span class="n">matrix</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div><h3 id="æ­£äº¤ç›¸æœºorthographic-camera">æ­£äº¤ç›¸æœºOrthographic Camera</h3><p>ä»3Då˜æ¢åˆ°2Dç©ºé—´æœ€ç›´æ¥ç²—æš´çš„æ–¹å¼æ˜¯ä¸¢å¼ƒä¸€ä¸ªç»´åº¦æ•°æ®ã€‚å°±å¥½åƒæŠŠ3ç»´ç©ºé—´å‹ç¼©åˆ°2ç»´å¹³é¢ï¼Œè¿™ä¸ªå¹³é¢å°±åƒä¸€ä¸ªç”»å¸ƒï¼Œç”¨æ¥æ¸²æŸ“å±å¹•ã€‚ç°åœ¨æˆ‘ä»¬æŠŠZè½´ä¸¢å¼ƒï¼Œè¯•è¯•çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆ</p>\[\begin{bmatrix} 1&amp;0&amp;0&amp;0\\ 0&amp;1&amp;0&amp;0\\ 0&amp;0&amp;0&amp;0\\ 0&amp;0&amp;0&amp;1\\ \end{bmatrix}\]<p>æŠŠä»£ç ä¿®æ”¹ä¸º</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">class</span> <span class="nc">CameraTransformation</span> <span class="p">:</span> <span class="n">Transformation</span>
<span class="p">{</span> 
    <span class="k">public</span> <span class="k">override</span> <span class="n">Matrix4x4</span> <span class="n">Matrix</span> <span class="p">{</span> 
        <span class="k">get</span> <span class="p">{</span>
            <span class="n">Matrix4x4</span> <span class="n">matrix</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Matrix4x4</span><span class="p">();</span>
            <span class="n">matrix</span><span class="p">.</span><span class="nf">SetRow</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Vector4</span><span class="p">(</span><span class="m">1f</span><span class="p">,</span> <span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">));</span>
            <span class="n">matrix</span><span class="p">.</span><span class="nf">SetRow</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Vector4</span><span class="p">(</span><span class="m">0f</span><span class="p">,</span> <span class="m">1f</span><span class="p">,</span> <span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">));</span>
            <span class="n">matrix</span><span class="p">.</span><span class="nf">SetRow</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Vector4</span><span class="p">(</span><span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">));</span>
            <span class="n">matrix</span><span class="p">.</span><span class="nf">SetRow</span><span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Vector4</span><span class="p">(</span><span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">,</span> <span class="m">1f</span><span class="p">));</span>
            <span class="k">return</span> <span class="n">matrix</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div><center class="half"><img class="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender1/3d view.png" width="" alt="loading failed, need vpn." /> <img class="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender1/2d view.png" width="" alt="loading failed, need vpn." /> <img class="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender1/plane.png" width="" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>3dè½¬æ¢åˆ°2d.</a></i></center> </font><p>å®é™…ä¸Šï¼Œè¿™ç§ç²—æš´çš„æ–¹æ³•è¿˜è›®åƒé‚£ä¹ˆå›äº‹ï¼Œç¡®å®å˜æˆäº†2Däº†ã€‚å…¶ä»–çš„Xã€Yè½´åŒç†ï¼Œå°±ä¸æ¼”ç¤ºäº†ã€‚è¿™å°±æ˜¯æ­£äº¤æŠ•å½±ã€‚ä¸ç®¡ç›¸æœºå¦‚ä½•ç¼©æ”¾ã€æ—‹è½¬ã€ä½ç§»ï¼Œå§‹ç»ˆå‘ˆç°çš„2Dæ•ˆæœã€‚ç§»åŠ¨ç›¸æœºçš„è§†è§‰æ•ˆæœå’Œç§»åŠ¨ä¸–ç•Œçš„ç›¸åæ–¹å‘æ˜¯ä¸€è‡´çš„ï¼Œä¹Ÿå°±æ˜¯3ä¸ªå˜æ¢ç»„ä»¶çš„å˜é‡ä¸æ‘„åƒæœºçš„ç¼©æ”¾ã€æ—‹è½¬ã€ä½ç§»å˜é‡æ˜¯äº’ä¸ºæ­£è´Ÿå…³ç³»ã€‚</p><h3 id="é€è§†ç›¸æœºperspective-camera">é€è§†ç›¸æœºPerspective Camera</h3><p>æ­£äº¤ç›¸æœºä¸èƒ½æ¨¡æ‹Ÿ3Dä¸–ç•Œå°±å¾ˆå°´å°¬ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€ä¸ªé€è§†ç›¸æœºï¼Œç”±äºè§†è§’çš„åŸå› ï¼Œå‘ˆç°ä¸€ä¸ªåŸå°è¿‘å¤§çš„è§†è§‰ã€‚é‚£ä¹ˆåŸºäºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®ç‚¹åˆ°æ‘„åƒæœºçš„è·ç¦»é‡å»ºè¿™ä¸ªè§†è§‰æ•ˆæœã€‚</p><p>ä»¥Zè½´ä¸ºä¾‹ï¼Œ<strong>æŠŠå•ä½çŸ©é˜µä»£è¡¨Zè½´çš„åˆ—å…ƒç´ å…¨éƒ¨ç½®0ï¼Œå†æŠŠå•ä½çŸ©é˜µæœ€åä¸€è¡Œæ”¹ä¸º[0,0,1,0]ï¼Œè¿™æ­¥æ”¹å˜å°†ç¡®ä¿ç»“æœåæ ‡çš„ç¬¬å››ä¸ªå€¼ç­‰äºZåæ ‡ï¼Œæœ€åæ‰€æœ‰åæ ‡éƒ½é™¤ä»¥Z</strong> \(\begin{bmatrix} 1&amp;0&amp;0&amp;0\\ 0&amp;1&amp;0&amp;0\\ 0&amp;0&amp;0&amp;0\\ 0&amp;0&amp;1&amp;0\\ \end{bmatrix}\) \(\begin{bmatrix} x\\ y\\ z\\ 1\\ \end{bmatrix}\) = \(\begin{bmatrix} x\\ y\\ 0\\ z\\ \end{bmatrix}\) $\rightarrow$ \(\begin{bmatrix} x \over z\\ y \over z\\ 0\\ \end{bmatrix}\)</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">override</span> <span class="n">Matrix4x4</span> <span class="n">Matrix</span> <span class="p">{</span> 
    <span class="k">get</span> <span class="p">{</span>
        <span class="n">Matrix4x4</span> <span class="n">matrix</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Matrix4x4</span><span class="p">();</span>
        <span class="n">matrix</span><span class="p">.</span><span class="nf">SetRow</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Vector4</span><span class="p">(</span><span class="m">1f</span><span class="p">,</span> <span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">));</span>
        <span class="n">matrix</span><span class="p">.</span><span class="nf">SetRow</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Vector4</span><span class="p">(</span><span class="m">0f</span><span class="p">,</span> <span class="m">1f</span><span class="p">,</span> <span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">));</span>
        <span class="n">matrix</span><span class="p">.</span><span class="nf">SetRow</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Vector4</span><span class="p">(</span><span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">));</span>
        <span class="n">matrix</span><span class="p">.</span><span class="nf">SetRow</span><span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Vector4</span><span class="p">(</span><span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">,</span> <span class="m">1f</span><span class="p">,</span> <span class="m">0f</span><span class="p">));</span>
        <span class="k">return</span> <span class="n">matrix</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div><p>ä¸æ­£äº¤æŠ•å½±æœ€å¤§çš„ä¸åŒæ˜¯è¿™äº›ç‚¹ä¸ä¼šç›´æ¥ç§»å‘åˆ°å¹³é¢ï¼Œè€Œæ˜¯ä»–ä»¬ä¼šç§»å‘æ‘„åƒæœºçš„ä½ç½®ï¼Œå½“ç„¶è¿™åªå¯¹ä½äºæ‘„åƒæœºå‰é¢çš„ç‚¹æœ‰æ•ˆï¼Œè€Œåœ¨æ‘„åƒæœºåé¢çš„ç‚¹å°±ä¸ä¼šæ­£ç¡®çš„æŠ•å½±ã€‚å…ˆç¡®ä¿æ‰€æœ‰ç‚¹éƒ½èƒ½ä½äºæ‘„åƒæœºçš„å‰æ–¹ï¼ŒæŠŠæ‘„åƒæœºçš„Unity.Transformç»„ä»¶Position.Zå€¼è°ƒå¥½ï¼Œä¿è¯æ‰€æœ‰ç‚¹éƒ½å…ˆå¯è§ã€‚</p><center class="half"><img class="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender1/3d view2.png" width="" alt="loading failed, need vpn." /> <img class="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender1/plane2.png" width="" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>é€è§†æŠ•å½±.</a></i></center> </font><p>è®¾ç½®ä¸€ä¸ªç‚¹åˆ°å¹³é¢çš„æŠ•å½±è·ç¦»ï¼Œå®ƒä¹Ÿä¼šå½±å“æŠ•å½±è§†è§‰æ•ˆæœã€‚å®ƒå°±åƒç›¸æœºçš„ç„¦è·ï¼Œå€¼è¶Šå¤§è§†é‡å°±è¶Šå°ã€‚ç°åœ¨æˆ‘ä»¬å…ˆå®šä¹‰ä¸€ä¸ªå˜é‡<em>focalLength</em>å€¼é»˜è®¤ä¸º1ï¼Œè¿™èƒ½äº§ç”Ÿ90Â°çš„è§†é‡ã€‚</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="kt">float</span> <span class="n">focalLength</span> <span class="p">=</span> <span class="m">1f</span><span class="p">;</span>
</code></pre></div></div><p>å½“è¿™ä¸ªfocalLengthå€¼è¶Šå¤§å°±åƒç›¸æœºåœ¨è¿›è¡Œèšç„¦ï¼Œè¿™æœ‰æ•ˆåœ°å¢åŠ äº†æ‰€æœ‰ç‚¹çš„æ¯”ä¾‹(æƒ³è±¡ä¸€ä¸‹ç›¸æœºå˜ç„¦)ã€‚å½“æˆ‘ä»¬å‹ç¼©Zè½´æ—¶ï¼Œæ˜¯ä¸å¿…è¿›è¡Œç¼©æ”¾çš„ \(\begin{bmatrix} fl&amp;0&amp;0&amp;0\\ 0&amp;fl&amp;0&amp;0\\ 0&amp;0&amp;0&amp;0\\ 0&amp;0&amp;1&amp;0\\ \end{bmatrix}\) \(\begin{bmatrix} x\\ y\\ z\\ 1\\ \end{bmatrix}\) = \(\begin{bmatrix} xfl\\ yfl\\ 0\\ z\\ \end{bmatrix}\) $\rightarrow$ \(\begin{bmatrix} xfl \over z\\ yfl \over z\\ 0\\ \end{bmatrix}\)</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">override</span> <span class="n">Matrix4x4</span> <span class="n">Matrix</span> <span class="p">{</span> 
    <span class="k">get</span> <span class="p">{</span>
        <span class="n">Matrix4x4</span> <span class="n">matrix</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Matrix4x4</span><span class="p">();</span>
        <span class="n">matrix</span><span class="p">.</span><span class="nf">SetRow</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Vector4</span><span class="p">(</span><span class="n">focalLength</span><span class="p">,</span> <span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">));</span>
        <span class="n">matrix</span><span class="p">.</span><span class="nf">SetRow</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Vector4</span><span class="p">(</span><span class="m">0f</span><span class="p">,</span> <span class="n">focalLength</span><span class="p">,</span> <span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">));</span>
        <span class="n">matrix</span><span class="p">.</span><span class="nf">SetRow</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Vector4</span><span class="p">(</span><span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">));</span>
        <span class="n">matrix</span><span class="p">.</span><span class="nf">SetRow</span><span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Vector4</span><span class="p">(</span><span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">,</span> <span class="m">1f</span><span class="p">,</span> <span class="m">0f</span><span class="p">));</span>
        <span class="k">return</span> <span class="n">matrix</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div><p>ç°åœ¨æœ‰äº†ä¸€ä¸ªç®€å•çš„é€è§†ç›¸æœºï¼Œå¦‚æœè¦å®Œå…¨æ¨¡æ‹ŸUnityçš„é€è§†ç›¸æœºï¼Œæˆ‘ä»¬è¿˜å¿…é¡»å¤„ç†è¿‘å¹³é¢å’Œè¿œå¹³é¢ã€‚è¿™å°†éœ€è¦å¤„ç†æŠ•å½±åˆ°ä¸€ä¸ªç«‹æ–¹ä½“è€Œä¸æ˜¯ä¸€ä¸ªå¹³é¢ï¼Œå› æ­¤éœ€è¦ä¿ç•™æ·±åº¦ä¿¡æ¯ã€‚ç„¶åè¿˜æœ‰è§†é‡è£åˆ‡æ–¹é¢çš„é—®é¢˜ã€‚æ­¤å¤–ï¼ŒUnityçš„æ‘„åƒå¤´æ˜¯åœ¨è´ŸZæ–¹å‘ä¸Šæ‹æ‘„çš„ï¼Œè¿™éœ€è¦å¯¹ä¸€äº›æ•°å­—è¿›è¡Œæ±‚è´Ÿã€‚</p><p>çŸ©é˜µä¸å¯æ€•ã€‚</p></article><hr><div class='like-post'> <a style="color:rgb(112, 40, 85);" id="likeBtn" onclick="likePost(1);"> <i class="fa fa-thumbs-o-up fa-2x" aria-hidden="true"></i> </a> <span id="likeNum">0</span><div class="text-xs text-slate-500 mx-2">çœŸè¯šç‚¹èµï¼Œæ‰‹ç•™ä½™é¦™</div></div><h2 id="similar_posts">Similar Posts</h2><ul><li class="relatedPost"> <a href="/2018/01/25/Unity_Parallax_Normals_Heightmap/">è§†å·®å’Œæ³•çº¿ã€é«˜åº¦å›¾å›é¡¾(ç¿»è¯‘äºŒå) </a><li class="relatedPost"> <a href="/2018/01/24/Unity_GPU_Instance/">Unity GPU Instance(ç¿»è¯‘åä¹) </a><li class="relatedPost"> <a href="/2018/01/23/Unity_RealTime_GI_LOD/">Unity å®æ—¶ GI & LPPV & LOD(ç¿»è¯‘åå…«) </a><li class="relatedPost"> <a href="/2018/01/21/Unity_Mix_Lighting/">Unity æ··åˆå…‰ç…§(ç¿»è¯‘åä¸ƒ) </a><li class="relatedPost"> <a href="/2018/01/19/Unity_Static_Lightting/">Unity å…‰ç…§çƒ˜ç„™(ç¿»è¯‘åå…­) </a><li class="relatedPost"> <a href="/2018/01/17/Unity_Deferred_Lights/">Unity Deferred Lights-å»¶è¿Ÿå…‰ç…§(ç¿»è¯‘åäº”) </a></ul><div class="post-recent"><div class="pre"><p><strong>ä¸Šä¸€ç¯‡</strong> <a href="/2017/10/03/CG_Function_Library/">CGå‡½æ•°æ ‡å‡†åº“</a></p></div><div class="nex"><p><strong>ä¸‹ä¸€ç¯‡</strong> <a href="/2018/01/02/Unity_Shader_Fundamentals/">Unity Shader åŸºæœ¬è¯­æ³•(ç¿»è¯‘äºŒ)</a></p></div></div><h2 id="comments">Comments</h2><div id="vcomments"></div><script type="text/javascript"> /*è¯„è®ºç›¸å…³*/ function delayLoadValine() { new Valine({ el: '#vcomments', verify: "true", notify: "false", app_id: "JgYk2pcFa3QxhhWPhDjjoPvv-MdYXbMMI", app_key: "fjDLTSUgCNGrSKgCID672IJx", avatar: "monsterid", placeholder: "æ¬¢è¿è¯„è®ºï¼", pageSize: "10 || 10", master: "b5586e582cb181c6b0fc8b2ce828bd50", tagMeta: ["åšä¸»","å°ä¼™ä¼´","è®¿å®¢"], enableQQ: true, requiredFields: [], serverURLs: "https://leanapi.damonc.top", recordIP: "true", visitor: "true", }); $(document).ready(function(){ fetch('https://hitokoto.cn') .then(response => response.json()) .then(data => { document.getElementById("veditor").setAttribute( "placeholder", data.hitokoto+"â€”"+data.from ); setTimeout(() => { addPostVisitedTimes(); }, 1000); } ) .catch(console.error); }); } /*ç‚¹èµç›¸å…³*/ var curIpVisitRecord = null; var curPost = null; var curUrl = "https://www.damonc.top/2018/01/01/Unity_Matrix_Transform/"; function getVisitorIpAndJudge() { $.getJSON('https://api.ipify.org?format=json', function(data){ saveOrUpdateIpRecord(data.ip) }); } function saveOrUpdateIpRecord(ip) { var Visitor = AV.Object.extend("visitors_record"); var post_url = curUrl; var query = new AV.Query(Visitor); query.equalTo("visitor_ip", ip); query.equalTo("post_url", post_url); query.find().then(function(results) { if (results.length > 0) { /* if(window.console){ console.log('è¯¥IPå·²è®¿é—®è¿‡è¯¥æ–‡ç« '); }*/ curIpVisitRecord = results[0]; updateIpRecord(); refreshLikeBtn(); } else { /*if(window.console){ console.log('è¯¥IPç¬¬ä¸€æ¬¡è®¿é—®è¯¥æ–‡ç« ï¼Œä¿å­˜æ–°çš„è®¿é—®è®°å½•ï¼Œå¹¶å¢åŠ è®¿é—®æ¬¡æ•°'); }*/ addNewIpRecord(ip, post_url); } }, function(error) { addPostVisitedTimes(); }); } function addPostVisitedTimes() { var AV_Posts = AV.Object.extend("Posts"); var url = curUrl; var title = "Unity åŸºæœ¬çŸ©é˜µ(ç¿»è¯‘ä¸€)"; var query = new AV.Query(AV_Posts); query.equalTo("post_url", url); query.find().then(function(results) { if (results.length > 0) { curPost = results[0]; curPost.increment("visited_times"); curPost.save(); loadLikeNums(); } else { curPost = new AV_Posts(); /* Set ACL */ var acl = new AV.ACL(); acl.setPublicReadAccess(true); acl.setPublicWriteAccess(true); curPost.setACL(acl); /* End Set ACL */ curPost.set("post_title", title); curPost.set("post_url", url); curPost.set("visited_times", 1); curPost.set('like_times', 0); curPost.save(); } getVisitorIpAndJudge(); }, function(error) { console.log('Error:' + error.code + " " + error.message); }); } function showPostVisitedTimes() { var AV_Posts = AV.Object.extend("Posts"); var $visitors = $(".leancloud_visitors"); var url = $visitors.attr('id').trim(); var title = $visitors.attr('data-flag-title').trim(); var query = new AV.Query(AV_Posts); query.equalTo("post_url", url); query.find().then(function(results) { if (results.length > 0) { curPost = results[0]; loadLikeNums(); } else { /*if(window.console){ console.log('å¼‚å¸¸æƒ…å†µï¼Œä¸åº”è¯¥æ²¡è®°å½•çš„'); }*/ } }, function(error) { console.log('Error:' + error.code + " " + error.message); }); } function updateIpRecord(){ var lastTime = curIpVisitRecord.updatedAt; var curTime = new Date(); var timePassed = curTime.getTime() - lastTime.getTime(); if(timePassed > 300000) { /*if(window.console){ console.log('è·ç¦»è¯¥IPä¸Šä¸€æ¬¡è®¿é—®è¯¥æ–‡ç« å·²è¶…è¿‡äº†5åˆ†é’Ÿï¼Œæ›´æ–°è®¿é—®è®°å½•ï¼Œå¹¶å¢åŠ è®¿é—®æ¬¡æ•°'); }*/ addPostVisitedTimes(); curIpVisitRecord.save(); } else { /*console.log('è¿™æ˜¯è¯¥IP 1åˆ†é’Ÿå†…é‡å¤è®¿é—®è¯¥æ–‡ç« ï¼Œä¸æ›´æ–°è®¿é—®è®°å½•ï¼Œä¸å¢åŠ è®¿é—®æ¬¡æ•°');*/ } } function addNewIpRecord(ip, post_url){ var Visitor = AV.Object.extend("visitors_record"); curIpVisitRecord = new Visitor(); /* Set ACL */ var acl = new AV.ACL(); acl.setPublicReadAccess(true); acl.setPublicWriteAccess(true); curIpVisitRecord.setACL(acl); curIpVisitRecord.set("visitor_ip", ip); curIpVisitRecord.set("post_url", post_url); curIpVisitRecord.set("like_this_post", 0); curIpVisitRecord.save(); } function loadLikeNums() { var likeTimes = curPost.get('like_times'); $("#likeNum").text(likeTimes); } function refreshLikeBtn() { var likeState = curIpVisitRecord.get('like_this_post'); if(likeState == 1){ $("#likeBtn").css("color", "red"); $("#likeBtn").attr("onclick", "likePost(-1)"); } else { $("#likeBtn").css("color", "black"); $("#likeBtn").attr("onclick", "likePost(1)"); } loadLikeNums(); } function likePost(type) { if(curPost == null || curIpVisitRecord == null) { alert('å»¶è¿Ÿ10såæ‰èƒ½ç‚¹èµ, è¯·ç¨ç­‰...'); return } var newNum; var getlikeTime = curPost.get('like_times'); if(typeof getlikeTime == "undefined" || getlikeTime == null || getlikeTime == "") { newNum = parseInt(type); }else{ newNum = parseInt(type) + parseInt(getlikeTime); } curPost.set('like_times', newNum); curPost.save().then(function(curPost){ var likeThisPost = type == -1 ? 0 : 1; curIpVisitRecord.set("like_this_post", likeThisPost); curIpVisitRecord.save().then(function(){ refreshLikeBtn(); }); },function(error){ console.log('Failed to create visitor record, with error message: ' + error.message); }); } /*å¯åŠ¨æ‰§è¡Œ*/ setTimeout(() => { delayLoadValine(); }, 10000); </script></div></div><script> /** * target _blank */ (function() { var aTags = document.querySelectorAll('article a:not([id])'); for (var i = 0; i < aTags.length; i++) { aTags[i].setAttribute('target', '_blank'); } }()); </script> <script src="/js/pageContent.js " charset="utf-8"></script><footer class="site-footer"><div class="wrapper"><p class="description"> äº‘ä¸Šçš„æ—¥å­!</p><p class="contact"> <a href="https://github.com/bitfeng" title="GitHub"><i class="fa fa-github" aria-hidden="true"></i></a> <a href="mailto:damonc@126.com" title="email"><i class="fa fa-envelope-o" aria-hidden="true"></i></a></p><p> æœ¬ç«™æ€»è®¿é—®é‡<span id="busuanzi_value_site_pv"></span>æ¬¡ï¼Œæœ¬ç«™è®¿å®¢æ•°<span id="busuanzi_value_site_uv"></span>äººæ¬¡ï¼Œæœ¬æ–‡æ€»é˜…è¯»é‡<span id="busuanzi_value_page_pv"></span>æ¬¡</p></div></footer><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="back-to-top"> <a href="#top" data-scroll> <i class="fa fa-arrow-up" aria-hidden="true"></i> </a></div><script src=" /js/main.js " charset="utf-8"></script> <script src=" /js/smooth-scroll.min.js " charset="utf-8"></script> <script type="text/javascript"> smoothScroll.init({ speed: 500, easing: 'easeInOutCubic', offset: 20, }); function displayWindowSize() { var w = document.documentElement.clientWidth; var h = document.documentElement.clientHeight; var rightDiv = document.querySelector('.right'); var footer = document.querySelector('.site-footer'); if(!rightDiv || !footer){ return; } if(w <= 1700){ rightDiv.style.display='none'; footer.style.display='none'; }else{ rightDiv.style.display='block'; footer.style.display = "block"; } } window.addEventListener("resize", displayWindowSize); displayWindowSize(); </script>
