<!DOCTYPE html><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="baidu-site-verification" content="code-BGVivWGmxV" /><title>Unity Shader åŸºæœ¬è¯­æ³•(ç¿»è¯‘äºŒ)</title><meta name="description" content="æœ¬ç¯‡æ‘˜è¦ä¿¡æ¯ é¡¶ç‚¹å˜æ¢ Color pixels shader å±æ€§ ä»é¡¶ç‚¹ä¼ æ•°æ®è‡³ç‰‡å…ƒå‡½æ•° æŸ¥çœ‹ç¼–è¯‘åçš„shaderä»£ç "><link rel="shortcut icon" href="/favicon.ico?" type="image/x-icon"><link rel="icon" href="/favicon.ico?" type="image/x-icon"><link rel="stylesheet" href="/css/main.css "><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"><link rel="stylesheet" href=" /css/font_8v3czwksspqlg14i.css "><link rel="canonical" href="https://www.damonc.top/2018/01/02/Unity_Shader_Fundamentals/"><link rel="alternate" type="application/rss+xml" title="çˆ±ç©¿æ‹–é‹" href="https://www.damonc.top/feed.xml "> <script type="text/javascript" src=" /js/jquery_3_2_0.min.js " charset="utf-8"></script> <script type="text/javascript" src=" /js/Valine.min.js " charset="utf-8"></script> <script> var _hmt = _hmt || []; (function() { var hm = document.createElement("script"); hm.src = "//hm.baidu.com/hm.js?8c087101d4768b7aa439cef954b30a8f"; var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s); })(); </script> <script> (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= 'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-WN45VXRK'); </script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <scrip type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/js-polyfills/0.1.43/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><body class="custom-background"> <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WN45VXRK" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><header id="top"><div class="wrapper"> <a href="/" class="brand">çˆ±ç©¿æ‹–é‹</a> <small>è‡ªç”±è‡ªåœ¨ğŸ©´</small> <button id="headerMenu" class="menu"><i class="fa fa-bars"></i></button><nav id="headerNav"><ul><li> <a href="/"> <i class="fa fa-home"></i>Home </a><li> <a href="/archive/"> <i class="fa fa-archive"></i>å½’æ¡£ </a><li> <a href="/category/"> <i class="fa fa-th-list"></i>åˆ†ç±» </a><li> <a href="/tag/"> <i class="fa fa-tags"></i>æ ‡ç­¾ </a></ul></nav></div></header><div class="home-right-bar"> <button class="anchor"><i class="fa fa-anchor"></i></button><div class="right"><div class="wrap"><div class="side content"><div> ç›®å½•</div><ul id="content-side" class="content-ul"><li><a href="#comments">Comments</a></ul></div></div></div></div><div class="page clearfix" post><div class="left"><h1>Unity Shader åŸºæœ¬è¯­æ³•(ç¿»è¯‘äºŒ)</h1><div class="label"><div class="label-card"> <i class="fa fa-calendar"></i>2018-01-02</div><div class="label-card"> <i class="fa fa-user"></i>catlikecoding</div><div class="label-card"></div><div class="label-card"> <span class="categories"> <i class="fa fa-th-list"></i> <a href="/category/#ç¿»è¯‘" title="Category: ç¿»è¯‘" rel="category">ç¿»è¯‘</a> </span></div><div class="label-card"> <span class="pageTag"> <i class="fa fa-tags"></i> <b href="/tag/#Shader" title="Tag: Shader" rel="tag">Shader</b>&nbsp; <b href="/tag/#Unity3d" title="Tag: Unity3d" rel="tag">Unity3d</b> </span></div></div><hr><article><ul id="markdown-toc"><li><a href="#åœºæ™¯åˆå§‹åŒ–" id="markdown-toc-åœºæ™¯åˆå§‹åŒ–">åœºæ™¯åˆå§‹åŒ–</a><ul><li><a href="#å‰¥ç¦»å¤©ç©ºç›’" id="markdown-toc-å‰¥ç¦»å¤©ç©ºç›’">å‰¥ç¦»å¤©ç©ºç›’</a></ul><li><a href="#å›¾åƒæ¸²æŸ“" id="markdown-toc-å›¾åƒæ¸²æŸ“">å›¾åƒæ¸²æŸ“</a><ul><li><a href="#åˆ›å»ºä¸€ä¸ªshader" id="markdown-toc-åˆ›å»ºä¸€ä¸ªshader">åˆ›å»ºä¸€ä¸ªShader</a><li><a href="#shaderç¨‹åº" id="markdown-toc-shaderç¨‹åº">Shaderç¨‹åº</a><li><a href="#shaderæ±‡ç¼–" id="markdown-toc-shaderæ±‡ç¼–">Shaderæ±‡ç¼–</a><li><a href="#å¼•å…¥å…¶ä»–æ–‡ä»¶" id="markdown-toc-å¼•å…¥å…¶ä»–æ–‡ä»¶">å¼•å…¥å…¶ä»–æ–‡ä»¶</a><li><a href="#äº§ç”Ÿè¾“å‡ºè¾“å‡ºè¯­ä¹‰" id="markdown-toc-äº§ç”Ÿè¾“å‡ºè¾“å‡ºè¯­ä¹‰">äº§ç”Ÿè¾“å‡º(è¾“å‡ºè¯­ä¹‰)</a><li><a href="#é¡¶ç‚¹å˜æ¢" id="markdown-toc-é¡¶ç‚¹å˜æ¢">é¡¶ç‚¹å˜æ¢</a></ul><li><a href="#åƒç´ é¢œè‰²" id="markdown-toc-åƒç´ é¢œè‰²">åƒç´ é¢œè‰²</a><ul><li><a href="#ä½¿ç”¨shaderå±æ€§properties" id="markdown-toc-ä½¿ç”¨shaderå±æ€§properties">ä½¿ç”¨Shaderå±æ€§Properties</a><li><a href="#ä»é¡¶ç‚¹åˆ°ç‰‡å…ƒ" id="markdown-toc-ä»é¡¶ç‚¹åˆ°ç‰‡å…ƒ">ä»é¡¶ç‚¹åˆ°ç‰‡å…ƒ</a><li><a href="#ç»“æ„ä½“" id="markdown-toc-ç»“æ„ä½“">ç»“æ„ä½“</a><li><a href="#è°ƒæ•´é¢œè‰²" id="markdown-toc-è°ƒæ•´é¢œè‰²">è°ƒæ•´é¢œè‰²</a></ul><li><a href="#çº¹ç†" id="markdown-toc-çº¹ç†">çº¹ç†</a><ul><li><a href="#ä½¿ç”¨uvåæ ‡" id="markdown-toc-ä½¿ç”¨uvåæ ‡">ä½¿ç”¨UVåæ ‡</a><li><a href="#æ·»åŠ çº¹ç†" id="markdown-toc-æ·»åŠ çº¹ç†">æ·»åŠ çº¹ç†</a><li><a href="#å¹³é“ºå’Œåç§»" id="markdown-toc-å¹³é“ºå’Œåç§»">å¹³é“ºå’Œåç§»</a></ul><li><a href="#çº¹ç†è®¾ç½®" id="markdown-toc-çº¹ç†è®¾ç½®">çº¹ç†è®¾ç½®</a><ul><li><a href="#mipmapå’Œfilter" id="markdown-toc-mipmapå’Œfilter">Mipmapå’ŒFilter</a><li><a href="#aniso-level" id="markdown-toc-aniso-level">Aniso Level</a></ul></ul><p>æœ¬ç¯‡æ‘˜è¦ä¿¡æ¯</p><ul><li>é¡¶ç‚¹å˜æ¢<li>Color pixels<li>shader å±æ€§<li>ä»é¡¶ç‚¹ä¼ æ•°æ®è‡³ç‰‡å…ƒå‡½æ•°<li>æŸ¥çœ‹ç¼–è¯‘åçš„shaderä»£ç </ul><h2 id="åœºæ™¯åˆå§‹åŒ–">åœºæ™¯åˆå§‹åŒ–</h2><p>æ–°å»ºä¸€ä¸ªé»˜è®¤åœºæ™¯ï¼Œæ–°å»ºä¸€ä¸ªåœ†çƒã€‚è¿™ä¸ªé»˜è®¤åœºæ™¯æœ¬èº«è¿›è¡Œäº†å¤§é‡å¤æ‚çš„æ¸²æŸ“ï¼Œä¸ºäº†æ›´å®¹æ˜“çš„æŒæ¡Unityçš„æ¸²æŸ“è¿‡ç¨‹ï¼Œæˆ‘ä»¬å…ˆåšä¸€äº›ç®€åŒ–è®¾ç½®ï¼ŒæŠŠé»˜è®¤çš„æŸäº›èŠ±é‡Œèƒ¡å“¨çš„ä¸œè¥¿å…ˆå‰¥ç¦»æ‰ã€‚</p><h3 id="å‰¥ç¦»å¤©ç©ºç›’">å‰¥ç¦»å¤©ç©ºç›’</h3><p>æ‰“å¼€<em>Window</em>-<em>Lighting</em>ï¼ŒæŸ¥çœ‹å…‰ç…§è®¾ç½®é€‰é¡¹ã€‚å¼¹å‡ºå¸¦æœ‰3ä¸ªé€‰é¡¹å¡çš„é¢æ¿ï¼Œæˆ‘ä»¬å…ˆå…³æ³¨<em>Scene</em>é€‰é¡¹å¡.</p><center class="half"><img id="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender2/default-lighting.png" width="250" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>é»˜è®¤å…‰ç…§.</a></i></center> </font><p>ç¬¬ä¸€é€‰é¡¹å¡<em>Environment</em>æ˜¯è·Ÿç¯å¢ƒå…‰ç…§ç›¸å…³ï¼Œåœ¨è¿™é‡Œå¯ä»¥è®¾ç½®å¤©ç©ºç›’ã€‚è¿™ä¸ªDefault-Skyboxå½“å‰æ­£è¢«ç”¨äºåœºæ™¯çš„èƒŒæ™¯å…‰ã€ç¯å¢ƒå…‰ã€å’Œåå°„å…‰ã€‚è®¾ç½®ä¸ºnoneå°±èƒ½å…³é—­è¿™äº›å…‰ã€‚é¡ºä¾¿æŠŠä¸‹é¢çš„<em>Realtime Ligting</em>å’Œ<em>Mixed Lighting</em>ä¹Ÿå…³æ‰ï¼Œç°åœ¨è¿˜ç”¨ä¸ä¸Šï¼Œåé¢ä¼šé™†ç»­ä»‹ç»ã€‚</p><p>å…³é—­äº†å¤©ç©ºç›’ï¼Œç¯å¢ƒé¢œè‰²è‡ªåŠ¨åˆ‡æ¢ä¸ºäº†çº¯è‰²ï¼Œè¿™ä¸ªé¢œè‰²é»˜è®¤æ˜¯å¸¦ç€ä¸€ä¸è“çš„é»‘ç°è‰²(è¯´å¥½çš„çº¯å‘¢ï¼Œå¤–è¡¨å¾ˆé»‘å†…å¿ƒå¾ˆè“ï¼Ÿ)ã€‚è€Œåå°„å…‰ä¼šå˜æˆçº¯é»‘è‰²ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼Œè®¾ç½®åçƒä½“å˜æš—äº†ï¼ŒèƒŒæ™¯å˜æˆäº†çº¯è‰²ã€‚è€Œè¿™ä¸ªèƒŒæ™¯æ·±è“è‰²ä»å“ªé‡Œæ¥çš„å‘¢ï¼Ÿ</p><center class="half"><img id="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender2/default-spere.png" width="250" alt="loading failed, need vpn." /> <img id="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender2/without-skybox.png" width="250" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>ç®€å•å…‰ç…§.</a></i></center> </font><p>è¿™ä¸ªæ·±è“è‰²è¢«å®šä¹‰åœ¨æ‘„åƒæœºï¼Œå®ƒé»˜è®¤ä½¿ç”¨å¤©ç©ºç›’æ¸²æŸ“ï¼Œå½“å¤©ç©ºç›’å¤±æ•ˆååœºæ™¯ä¼šé»˜è®¤é€€å›åˆ°ä½¿ç”¨ç›¸æœºçº¯è‰²æ¨¡å¼ã€‚</p><center class="half"><img id="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender2/camera.png" width="250" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>é»˜è®¤çš„æ‘„åƒæœºè®¾ç½®.</a></i></center> </font><p>ä¸ºäº†è¿›ä¸€æ­¥ç®€åŒ–æ¸²æŸ“ï¼Œå†éšè—æˆ–åˆ é™¤æ–¹å‘å…‰å¯¹è±¡ã€‚è¿™å°†æ¶ˆé™¤åœºæ™¯ä¸­çš„ç›´æ¥å…‰ç…§ï¼Œä»¥åŠæ‰€æœ‰å®ƒæŠ•å°„çš„é˜´å½±ã€‚å‰©ä¸‹çº¯è‰²èƒŒæ™¯å’Œçƒä½“çš„è½®å»“ã€‚</p><center class="half"><img id="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender2/without-light.png" width="250" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>æœªç€è‰²çƒä½“.</a></i></center> </font><h2 id="å›¾åƒæ¸²æŸ“">å›¾åƒæ¸²æŸ“</h2><p>åˆ†ä¸¤æ­¥ç»˜åˆ¶ä¸Šé¢çš„åœºæ™¯ï¼Œä¸€æ˜¯ä½¿ç”¨ç›¸æœºçš„èƒŒæ™¯è‰²å¡«å……å›¾åƒï¼Œç„¶åå†åœ¨ä¸Šé¢ç”»å‡ºçƒä½“çš„è½®å»“ã€‚</p><p><strong>Unityå¦‚ä½•çŸ¥é“è¯¥ç”»è¿™ä¸ªçƒä½“å‘¢?</strong>æˆ‘ä»¬æœ‰ä¸€ä¸ªçƒä½“å¯¹è±¡å¹¶ä¸”ç»‘å®šäº†_MeshRenderer_ç»„ä»¶ï¼Œå¦‚æœè¿™ä¸ªçƒä½“ä½äºæ‘„åƒæœºçš„è§†é‡å†…ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šè¢«æ¸²æŸ“å‡ºæ¥ã€‚Unityé€šè¿‡æ£€æµ‹çƒä½“çš„è¾¹ç•Œç›’æ˜¯å¦ä¸æ‘„åƒæœºçš„è§†é”¥ä½“ç›¸æœºæ¥éªŒè¯è¿™ä¸€ç‚¹ã€‚åŒ…å›´ç›’åœ¨Unityä¸­å®šä¹‰ä¸º<code class="language-plaintext highlighter-rouge">Boundsç»“æ„ä½“</code><strong>Collider.bounds, Mesh.bounds, Renderer.bounds</strong>.</p><center class="half"><img id="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender2/sphere-object.png" width="250" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>çƒä½“é»˜è®¤è‡ªå¸¦ç»„ä»¶.</a></i></center> </font><p>Transformç»„ä»¶ç”¨äºæ›´æ”¹åæ ‡ã€æ–¹å‘ï¼Œä»¥åŠç½‘æ ¼å’ŒåŒ…å›´ç›’çš„å°ºå¯¸ã€‚<a href="&quot;https://www.damonc.top/posts/Unity-Matrix&amp;Transform/&quot;">è¿™é‡Œ</a>æœ‰å¯¹Transformå±‚æ¬¡ç»“æ„çš„æ¸…æ™°æè¿°ã€‚å¦‚æœä¸€ä¸ªç‰©ä½“æœ€ç»ˆå¤„äºæ‘„åƒæœºè§†é‡å†…ï¼Œå®ƒå°±ä¼šè¢«å®‰æ’æ¸²æŸ“ã€‚</p><p>æœ€åï¼ŒGPUè´Ÿè´£æ¸²æŸ“ç‰©ä½“çš„meshã€‚è¿™äº›å…·ä½“çš„æ¸²æŸ“æŒ‡ä»¤åœ¨ç‰©ä½“çš„materialå®šä¹‰å¥½çš„ï¼Œè¿™ä¸ªmaterialå¼•ç”¨äº†ä¸€ä¸ªshader-GPUç¨‹åºã€‚</p><center class="half"><img id="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender2/cpu-gpu.png" width="250" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>2uåˆ†å·¥.</a></i></center> </font><p>å½“å‰è¿™ä¸ªçƒä½“ä½¿ç”¨äº†Unityçš„é»˜è®¤æè´¨ï¼Œè‡ªå¸¦äº†ä¸€ä¸ªæ ‡å‡†shaderã€‚æˆ‘ä»¬ç°åœ¨æŠŠå®ƒå»æ‰æ›¿æ¢æˆè‡ªå·±çš„shaderï¼Œä»å¤´å¼€å§‹å†™ã€‚</p><h3 id="åˆ›å»ºä¸€ä¸ªshader">åˆ›å»ºä¸€ä¸ªShader</h3><p>é€šè¿‡ç‚¹å‡»_Assets / Create / Shader / Unlit Shaderåˆ›å»ºå¹¶å‘½åè‡ªå·±çš„shaderï¼ŒåŒå‡»shaderæ–‡ä»¶æ‰“å¼€ï¼Œå¹¶åˆ é™¤é‡Œé¢çš„å†…å®¹ä»å¤´å†™ã€‚</p><center class="half"><img id="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender2/my-first-shader.png" width="250" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>ç¬¬ä¸€ä¸ªshader.</a></i></center> </font><p>Shaderæ˜¯é€šè¿‡<em>shader</em>å…³é”®å­—å®šä¹‰ï¼Œå…³é”®å­—æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œåœ¨ä¸‹æ‹‰ç•Œé¢ä¸­é€‰æ‹©æ—¶æ˜¾ç¤ºçš„ä¹Ÿæ˜¯è¯¥å…³é”®å­—ã€‚å®ƒä¸å¿…ä¸æ–‡ä»¶åç›¸åŒã€‚</p><div class="language-hlsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Shader</span> <span class="s">"Unlit/MyShader"</span>
<span class="p">{</span>
    <span class="c1">//...</span>
<span class="p">}</span>
</code></pre></div></div><p>ä¿å­˜æ–‡ä»¶ï¼Œå›åˆ°ç¼–è¾‘å™¨ä¼šæ”¶åˆ°è­¦å‘Šæç¤ºnone of subshaders/fallbacks are suitableï¼Œå› ä¸ºå®ƒæ˜¯ç©ºçš„ï¼Œæ²¡æœ‰sub-shaderæˆ–å›è°ƒshaderã€‚å°½ç®¡è¿™ä¸ªshaderæ²¡æœ‰å†…å®¹ä¹Ÿæœ‰è­¦å‘Šï¼Œæˆ‘ä»¬ä»èƒ½æŒ‡å®šç»™materialã€‚ç‚¹å‡»_Assets / Create / Material_åˆ›å»ºï¼Œç„¶åé€šè¿‡ä¸‹æ‹‰èœå•æŒ‡å®šã€‚</p><center class="half"><img id="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender2/my-material.png" width="250" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>ç»™æè´¨æŒ‡å®šShader.</a></i></center> </font><p>ç»™çƒä½“æŒ‡å®šä¸Šæˆ‘ä»¬æ–°å»ºçš„Materialï¼Œæ›¿æ¢æ‰é»˜è®¤çš„ã€‚è¿™æ—¶çš„çƒä½“ä¼šç«‹å³å˜æˆç´«çº¢è‰²ã€‚å‘ç”Ÿè¿™ä¸ªçš„åŸå› æ˜¯Unityåˆ‡æ¢åˆ°äº†é”™è¯¯çš„shaderï¼Œå®ƒæ•…æ„ä½¿ç”¨è¿™ä¸ªé¢œè‰²æ¥æé†’å¼€å‘è€…è¿™æ˜¯ä¸€ä¸ªé”™è¯¯ã€‚</p><center class="half"><img id="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender2/material-with-shader.png" width="250" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>æŒ‡å®šMyMaterial.</a></i></center> </font><p>shader warningä¸­æåˆ°äº†æ²¡æœ‰sub-shader. æˆ‘ä»¬å¯ä»¥ä½¿ç”¨sub-shaderæ“ä½œshaderå˜é‡è¿›è¡Œåˆ†ç»„, è¿™å…è®¸ç¨‹åºå‘˜ä¸ºä¸åŒçš„ç¼–è¯‘å¹³å°æä¾›ä¸åŒçš„sub-shader.ä¾‹å¦‚æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªsub-shaderæ—¢æ”¯æŒpcåˆæ”¯æŒæ‰‹æœºå¹³å°.å®šä¹‰ä¸€ä¸ªSubShaderå—</p><div class="language-hlsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Shader</span> <span class="s">"Unlit/MyShader"</span>
<span class="p">{</span>
    <span class="n">SubShader</span>
    <span class="p">{</span>
        <span class="c1">//...</span>
    <span class="p">}</span>
 <span class="p">}</span>
</code></pre></div></div><p>sub-shaderè‡³å°‘åŒ…å«ä¸€ä¸ªä»¥ä¸Šçš„passå—, passä»£ç å—æ˜¯ç‰©ä½“å®é™…è¢«æ¸²æŸ“çš„åœ°æ–¹ï¼Œæˆ‘ä»¬å…ˆå†™ä¸€ä¸ªpassï¼Œç„¶ååœ¨å†™å¤šä¸ªpassã€‚ä¸ºäº†å‘ˆç°å¤šç§æ•ˆæœï¼Œpassæ•°é‡å¯èƒ½ä¼šè¶…è¿‡ä¸€ä¸ªä»¥ä¸Šï¼Œè€Œåˆ™ä»£è¡¨ç€ç‰©ä½“è¦è¢«æ¸²æŸ“å¤šæ¬¡ã€‚</p><div class="language-hlsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Shader</span> <span class="s">"Unlit/MyShader"</span>
<span class="p">{</span>
     <span class="n">SubShader</span>
     <span class="p">{</span>
        <span class="n">Pass</span>
        <span class="p">{</span>        
            <span class="c1">//...</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div><p>æˆ‘ä»¬çš„çƒä½“ç°åœ¨åº”è¯¥å˜æˆäº†ç™½è‰²ï¼Œå› ä¸ºæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªç©ºpassæ¸²æŸ“ï¼Œè¿™ä¹Ÿæ„å‘³ç€æˆ‘ä»¬çš„Shaderæ²¡æœ‰å‡ºç°ä»»ä½•é”™è¯¯äº†ã€‚</p><center class="half"><img id="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender2/sphere-with-pass.png" width="250" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>ç©ºshaderæ•ˆæœ.</a></i></center> </font><h3 id="shaderç¨‹åº">Shaderç¨‹åº</h3><p>ç°åœ¨æˆ‘ä»¬è¦å¼€å§‹ç¼–å†™shaderä»£ç äº†ï¼Œæˆ‘ä»¬ç”¨çš„Unityç€è‰²å™¨è¯­è¨€æ˜¯HLSLå’ŒCGç€è‰²å™¨è¯­è¨€çš„å˜ä½“ã€‚æ‰€ä»¥å¿…é¡»æŒ‡ç¤º<strong>CGPROGRAM</strong>å…³é”®å­—ä¸ºä»£ç çš„å¼€å§‹ï¼ŒåŒæ—¶è¦ç”¨<strong>ENDCG</strong>å…³é”®å­—åšä¸ºç»“æŸã€‚</p><div class="language-hlsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Pass</span><span class="p">{</span>
    <span class="n">CGPROGRAM</span>

    <span class="n">ENDCG</span>
<span class="p">}</span>
</code></pre></div></div><p>å†æ¬¡æ‰“å¼€ç¼–è¾‘å™¨ç¼–è¯‘åæœ‰ä¸€ä¸ªè­¦å‘Š<em>Both vertex and fragment programs must be present</em>,è¡¨ç¤ºæ²¡æœ‰é¡¶ç‚¹å’Œç‰‡å…ƒç¨‹åºã€‚shaderç”±è¿™ä¸¤ä¸ªç¨‹åºç»„æˆï¼Œvertexé¡¶ç‚¹ç¨‹åºè´Ÿè´£å¤„ç†ç½‘æ ¼çš„é¡¶ç‚¹æ•°æ®ï¼Œè¿™åŒ…å«äº†ä»å¯¹è±¡ç©ºé—´åˆ°æ˜¾ç¤ºç©ºé—´çš„è½¬æ¢ï¼›è€Œfragmentç‰‡å…ƒç¨‹åºè´Ÿè´£ä¸ºç½‘æ ¼çš„ä¸‰è§’å½¢å†…çš„å•ä¸ªåƒç´ è¿›è¡Œç€è‰²ã€‚</p><center class="half"><img id="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender2/vertex-fragment-programs.png" width="250" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>é¡¶ç‚¹ç‰‡å…ƒå‡½æ•°.</a></i></center> </font><p>åŒæ—¶ï¼Œæˆ‘ä»¬å¿…é¡»é€šè¿‡pragmaæŒ‡ä»¤å‘Šè¯‰ç¼–è¯‘å™¨ä½¿ç”¨å“ªäº›ç¨‹åº</p><div class="language-hlsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">CGPROGRAM</span>

<span class="cp">#pragma vertex MyVertexProgram
#pragma fragment MyFragmentProgram
</span>
<span class="n">ENDCG</span>
</code></pre></div></div><p>ç¼–è¯‘å™¨å†æ¬¡å‘å‡ºæ¥é”™è¯¯æç¤ºï¼Œè¿™æ¬¡æ˜¯å› ä¸ºå®ƒä¸èƒ½æ‰¾åˆ°æˆ‘ä»¬æŒ‡å®šçš„ç¨‹åºç‰‡æ®µï¼Œå› ä¸ºæˆ‘ä»¬å…‰å£°æ˜æ²¡å®ç°ã€‚é¦–å…ˆvertexå’Œfragmentè¢«å†™æˆæ–¹æ³•ï¼Œç±»ä¼¼C#å‡½æ•°ã€‚å…ˆç®€å•åœ°åˆ›å»ºä¸¤ä¸ªåŒåçš„voidæ–¹æ³•ã€‚</p><div class="language-hlsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">CGPROGRAM</span>

<span class="cp">#pragma vertex MyVertexProgram
#pragma fragment MyFragmentProgram
</span>
<span class="kt">void</span> <span class="nf">MyVertexProgram</span><span class="p">()</span> <span class="p">{</span>

<span class="p">}</span>

<span class="kt">void</span> <span class="nf">MyFragmentProgram</span><span class="p">()</span> <span class="p">{</span>

<span class="p">}</span>

<span class="n">ENDCG</span>
</code></pre></div></div><p>è¿™æ¬¡ç¼–è¯‘åæ²¡æœ‰æŠ¥é”™ï¼Œä½†æ˜¯çƒä½“ä»å±å¹•ä¸Šæ¶ˆå¤±äº†ã€‚</p><h3 id="shaderæ±‡ç¼–">Shaderæ±‡ç¼–</h3><p>Unityçš„shaderç¼–è¯‘å™¨æŠŠæˆ‘ä»¬çš„ä»£ç æ ¹æ®ä¸åŒtarget-compileæˆäº†ä¸åŒç¨‹åºã€‚ä¸åŒçš„å¹³å°éœ€è¦ä¸åŒçš„è§£å†³æ–¹æ¡ˆï¼Œä¾‹å¦‚Direct3Dæ˜¯æœåŠ¡äºWindowså¹³å°ï¼ŒOpenGLé’ˆå¯¹MacOsï¼ŒOpenGL ESé’ˆå¯¹æ‰‹æœºå¹³å°ã€‚è¿™é‡Œæˆ‘ä»¬ä¸æ˜¯åœ¨å¤„ç†å•ä¸ªç¼–è¯‘å™¨ï¼Œè€Œæ˜¯å¤šä¸ªç¼–è¯‘å™¨ã€‚</p><p>æœ€ç»ˆä½¿ç”¨å“ªç§ç¼–è¯‘å™¨å–å†³äºç›®æ ‡å¹³å°ï¼Œè¿™äº›ç¼–è¯‘å™¨ä¹Ÿæ˜¯ä¸å®Œå…¨ç›¸åŒçš„ï¼Œæ¯ä¸ªå¹³å°å¯èƒ½å¾—åˆ°ä¸åŒçš„ç»“æœã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬çš„ç©ºç¨‹åºåœ¨OpenGLå’ŒDirect3D 11ä¸‹èƒ½å¾ˆå¥½çš„å·¥ä½œï¼Œä½†åœ¨Direct3D 9å°±ä¼šæŠ¥é”™ã€‚</p><p>åœ¨ç¼–è¾‘å™¨ä¸‹ç‚¹é€‰<em>MyFirstShader</em>ï¼Œåœ¨inspectoré¢æ¿å¯ä»¥æŸ¥çœ‹è¯¥shaderçš„ä¸€äº›ä¿¡æ¯ï¼Œä»¥åŠç¼–è¯‘é”™è¯¯ã€‚è¿™ä¹Ÿæœ‰ä¸€ä¸ª<em>Compiled code and show</em>æŒ‰é’®å’Œä¸‹æ‹‰èœå•ã€‚</p><center class="half"><img id="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender2/shader-inspector.png" width="250" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>shaderæ£€è§†é¢æ¿ä¿¡æ¯.</a></i></center> </font><p>å¦‚æœä½ ç‚¹å‡»è¯¥æŒ‰é’®ï¼ŒUnityå°†ä¼šç¼–è¯‘è¯¥shaderå¹¶æ‰“å¼€å®ƒï¼Œæ¥ç€å°±å¯ä»¥æŸ¥çœ‹ç”Ÿæˆçš„ä»£ç ã€‚æˆ‘ä»¬è¯•ç€å…ˆé€‰æ‹©OpenGL Coreï¼Œç„¶åå†é€‰æ‹©D3D11ï¼Œçœ‹çœ‹åº•å±‚ä»£ç æ˜¯æ€ä¹ˆå›äº‹çš„ã€‚</p><div class="language-hlsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Shader</span> <span class="s">"Unlit/MyShader"</span> <span class="p">{</span>
<span class="n">SubShader</span> 
<span class="p">{</span>
    <span class="n">Pass</span> 
    <span class="p">{</span>
        <span class="n">No</span> <span class="n">keywords</span> <span class="n">set</span> <span class="k">in</span> <span class="kr">this</span> <span class="n">variant</span><span class="p">.</span>
        <span class="o">--</span> <span class="n">Vertex</span> <span class="n">shader</span> <span class="k">for</span> <span class="s">"glcore"</span><span class="o">:</span>
        <span class="n">Shader</span> <span class="n">Disassembly</span><span class="o">:</span>
        <span class="cp">#ifdef VERTEX
</span>        <span class="cp">#version 150
</span>        <span class="cp">#extension GL_ARB_explicit_attrib_location : require
</span>        <span class="cp">#extension GL_ARB_shader_bit_encoding : enable
</span>
        <span class="kt">void</span> <span class="n">main</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="cp">#endif
</span>
        <span class="cp">#ifdef FRAGMENT
</span>        <span class="cp">#version 150
</span>        <span class="cp">#extension GL_ARB_explicit_attrib_location : require
</span>        <span class="cp">#extension GL_ARB_shader_bit_encoding : enable
</span>
        <span class="kt">void</span> <span class="n">main</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="cp">#endif
</span>
        <span class="o">--</span> <span class="n">Fragment</span> <span class="n">shader</span> <span class="k">for</span> <span class="s">"glcore"</span><span class="o">:</span>
        <span class="n">Shader</span> <span class="n">Disassembly</span><span class="o">:</span>
        <span class="c1">// All GLSL source is contained within the vertex program</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div><p>æç‚¼å‡ºä¸¤ä¸ªmainå‡½æ•°ï¼Œæœ‰vertexå’Œfragmentç¨‹åº</p><div class="language-hlsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#ifdef VERTEX
</span><span class="kt">void</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">#endif
</span>
<span class="cp">#ifdef FRAGMENT
</span><span class="kt">void</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">#endif
</span></code></pre></div></div><p>D3D11è‡ªè¡ŒæŸ¥çœ‹ï¼Œå› ä¸ºç¼–è¯‘åçš„ä»£ç å®åœ¨æ˜¯å¤ªé•¿äº†ï¼Œä¸æ–¹ä¾¿è´´ä¸Šæ¥ã€‚åªé€‰å–äº†ä¸€ä¸ªç‰‡æ®µï¼š</p><div class="language-hlsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Pass</span> <span class="p">{</span>
    <span class="n">No</span> <span class="n">keywords</span> <span class="n">set</span> <span class="k">in</span> <span class="kr">this</span> <span class="n">variant</span><span class="p">.</span>
    <span class="o">--</span> <span class="n">Vertex</span> <span class="n">shader</span> <span class="k">for</span> <span class="s">"d3d11"</span><span class="o">:</span>
    <span class="n">Shader</span> <span class="n">Disassembly</span><span class="o">:</span>
        <span class="n">vs_4_0</span>
    <span class="mi">0</span><span class="o">:</span> <span class="n">ret</span>


    <span class="o">--</span> <span class="n">Fragment</span> <span class="n">shader</span> <span class="k">for</span> <span class="s">"d3d11"</span><span class="o">:</span>
    <span class="n">Shader</span> <span class="n">Disassembly</span><span class="o">:</span>
        <span class="n">ps_4_0</span>
    <span class="mi">0</span><span class="o">:</span> <span class="n">ret</span>
<span class="p">}</span>
</code></pre></div></div><h3 id="å¼•å…¥å…¶ä»–æ–‡ä»¶">å¼•å…¥å…¶ä»–æ–‡ä»¶</h3><p>ç¼–å†™shaderä»£ç å¾ˆè´¹åŠ²ï¼Œæœ‰æ—¶éœ€è¦é‡å¤å†™ç±»ä¼¼çš„å‡½æ•°ï¼Œä¸ºäº†ç®€åŒ–ä¹¦å†™ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªç±»ä¼¼C#ç¨‹åºçš„åŠŸèƒ½ï¼Œå¼•ç”¨å…¶ä»–ç±»ä¸­çš„é€šç”¨å˜é‡ã€å‡½æ•°ç­‰ã€‚ä½¿ç”¨<code class="language-plaintext highlighter-rouge">#includeæŒ‡ä»¤å°±èƒ½åŠ è½½ä¸€ä¸ªæ–‡ä»¶ã€‚å…ˆè¯•ç€åŠ è½½Unityå†…éƒ¨è‡ªå¸¦çš„UnityCG.cginc</code></p><div class="language-hlsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">CGPROGRAM</span>

    <span class="cp">#pragma vertex MyVertexProgram
</span>    <span class="cp">#pragma fragment MyFragmentProgram
</span>
    <span class="cp">#include</span> <span class="cpf">"UnityCG.cginc"</span><span class="cp">
</span>
    <span class="kt">void</span> <span class="nf">MyVertexProgram</span><span class="p">()</span> <span class="p">{</span>

    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">MyFragmentProgram</span><span class="p">()</span> <span class="p">{</span>

    <span class="p">}</span>

<span class="n">ENDCG</span>
</code></pre></div></div><p>ä¸‹é¢æ˜¯_UnityCg.cginc_çš„å¼•ç”¨å±‚æ¬¡ç»“æ„</p><center class="half"><img id="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender2/include-files.png" width="250" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>UnityCG.cgincç»“æ„.</a></i></center> </font><p><em>UnityShaderVariables.cginc</em>å®šä¹‰äº†ä¸€å¤§å †æ¸²æŸ“æ‰€éœ€çš„ç€è‰²å™¨å˜é‡ï¼Œæ¯”å¦‚<strong>çŸ©é˜µå˜æ¢ã€ç›¸æœºå’Œå…‰ç…§æ•°æ®ç­‰ç­‰</strong>ã€‚</p><p><em>UnityInstancing.cginc</em>å†…ç½®åœ¨å¼•æ“å®‰è£…åŒ…å†…ï¼Œè¿™æ˜¯ä¸€ç§<strong>å‡å°‘ç»˜åˆ¶è°ƒç”¨çš„ç‰¹å®šå‘ˆç°æŠ€æœ¯</strong>ã€‚è™½ç„¶å®ƒä¸ç›´æ¥åŒ…å«æ–‡ä»¶ï¼Œä½†å®ƒä¾èµ–äºUnityShaderVariablesã€‚</p><p><em>HLSLSupport.cginc</em>è®¾ç½®äº†ä¸€äº›æ— è®ºæ‚¨çš„ç›®æ ‡æ˜¯å“ªä¸ªå¹³å°éƒ½å¯ä»¥ä½¿ç”¨ç›¸åŒçš„ä»£ç çš„åŠŸèƒ½ã€‚</p><p>è¯·æ³¨æ„ï¼Œè¿™äº›æ–‡ä»¶çš„å†…å®¹å°†è¢«å¤åˆ¶åˆ°æ–‡ä»¶ä¸­ï¼Œå–ä»£includeæŒ‡ä»¤ã€‚è¿™å‘ç”Ÿåœ¨é¢„å¤„ç†æ­¥éª¤ä¸­ï¼Œè¯¥æ­¥éª¤æ‰§è¡Œæ‰€æœ‰é¢„å¤„ç†æŒ‡ä»¤ã€‚æ¯”å¦‚#includeå’Œ#pragmaã€‚</p><h3 id="äº§ç”Ÿè¾“å‡ºè¾“å‡ºè¯­ä¹‰">äº§ç”Ÿè¾“å‡º(è¾“å‡ºè¯­ä¹‰)</h3><p>ä¸ºäº†æ¸²æŸ“ç‰©ä½“ï¼Œshaderå¿…é¡»è¦äº§ç”Ÿç»“æœã€‚</p><p><strong>Vertexé¡¶ç‚¹å‡½æ•°å¿…é¡»è¦è¿”å›æ¯ä¸ªé¡¶ç‚¹çš„æœ€ç»ˆåæ ‡ï¼šSV_POSITION</strong>ã€‚ä¸€ä¸ªé¡¶ç‚¹æœ‰å‡ ä¸ªåæ ‡åˆ†é‡ï¼Ÿ4ä¸ªï¼Œå› ä¸ºæˆ‘ä»¬ä½¿ç”¨äº†4x4å˜æ¢çŸ©é˜µã€‚ç°åœ¨æŠŠå‡½æ•°ç±»å‹ä»voidæ”¹ä¸ºfloat4,ä¸€ä¸ªfloat4ç±»å‹æ˜¯ä¸€ä¸ªç”±4ä¸ªfloatç±»å‹ç®€å•ç»„æˆã€‚</p><div class="language-hlsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">float4</span> <span class="nf">MyVertexProgram</span><span class="p">()</span> <span class="o">:</span> <span class="nb">SV_POSITION</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div><p><strong>Fragmentç‰‡å…ƒå‡½æ•°è¿”å›åƒç´ çš„æœ€ç»ˆé¢œè‰²ï¼šSV_TARGETã€‚</strong>ä¹Ÿæ˜¯float4ã€‚</p><div class="language-hlsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">float4</span> <span class="nf">MyFragmentProgram</span><span class="p">()</span> <span class="o">:</span> <span class="n">SV_TARGET</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div><p>Vertexé¡¶ç‚¹å‡½æ•°çš„è¾“å‡ºä½œä¸ºFragmentç‰‡å…ƒå‡½æ•°çš„è¾“å…¥ã€‚è¾“å…¥çš„å‚æ•°éœ€è¦åŒ¹é…ï¼</p><div class="language-hlsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">float4</span> <span class="nf">MyFragmentProgram</span><span class="p">(</span>
    <span class="kt">float4</span> <span class="n">position</span> <span class="o">:</span> <span class="nb">SV_POSITION</span>
<span class="p">)</span> <span class="o">:</span> <span class="n">SV_TARGET</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div><p>ç„¶åçœ‹çœ‹Unityçš„shaderæ±‡ç¼–</p><div class="language-hlsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//--D3D11--</span>
<span class="o">--</span> <span class="n">Vertex</span> <span class="n">shader</span> <span class="k">for</span> <span class="s">"d3d11"</span><span class="o">:</span>
<span class="n">Shader</span> <span class="n">Disassembly</span><span class="o">:</span>
      <span class="n">vs_4_0</span>                            <span class="c1">//é¡¶ç‚¹ç€è‰²å™¨ç‰ˆæœ¬</span>
      <span class="n">dcl_output_siv</span> <span class="n">o0</span><span class="p">.</span><span class="n">xyzw</span><span class="p">,</span> <span class="n">position</span>  <span class="c1">//å£°æ˜o0ä½œä¸ºè¾“å‡ºå€¼ï¼Œå¸¦æœ‰ç³»ç»Ÿå€¼</span>
   <span class="mi">0</span><span class="o">:</span> <span class="n">mov</span> <span class="n">o0</span><span class="p">.</span><span class="n">xyzw</span><span class="p">,</span> <span class="n">l</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>           <span class="c1">//æŠŠ(0,0,0,0)ç§»åŠ¨åˆ°o0ä¸­</span>
   <span class="mi">1</span><span class="o">:</span> <span class="n">ret</span>                               <span class="c1">//è¿”å›</span>

<span class="o">--</span> <span class="n">Fragment</span> <span class="n">shader</span> <span class="k">for</span> <span class="s">"d3d11"</span><span class="o">:</span>
<span class="n">Shader</span> <span class="n">Disassembly</span><span class="o">:</span>
      <span class="n">ps_4_0</span>
      <span class="n">dcl_output</span> <span class="n">o0</span><span class="p">.</span><span class="n">xyzw</span>
   <span class="mi">0</span><span class="o">:</span> <span class="n">mov</span> <span class="n">o0</span><span class="p">.</span><span class="n">xyzw</span><span class="p">,</span> <span class="n">l</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
   <span class="mi">1</span><span class="o">:</span> <span class="n">ret</span>

<span class="c1">//GL CORE--</span>
<span class="cp">#ifdef VERTEX
</span><span class="kt">void</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">gl_Position</span> <span class="o">=</span> <span class="n">vec4</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">#endif
</span>
<span class="cp">#ifdef FRAGMENT
</span><span class="n">layout</span><span class="p">(</span><span class="n">location</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">out</span> <span class="n">vec4</span> <span class="n">SV_TARGET0</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">SV_TARGET0</span> <span class="o">=</span> <span class="n">vec4</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">#endif
</span></code></pre></div></div><h3 id="é¡¶ç‚¹å˜æ¢">é¡¶ç‚¹å˜æ¢</h3><p>æŠŠçƒç»™æˆ‘ç”»å‡ºæ¥ï¼</p><p>ä¸ºäº†å¾—åˆ°æ¨¡å‹ç©ºé—´çš„é¡¶ç‚¹åæ ‡ï¼Œç»™ertexé¡¶ç‚¹å‡½æ•°å¢åŠ ä¸€æ¡è¯­ä¹‰<em>POSITON</em>ã€‚è€Œæ¨¡å‹ç©ºé—´çš„é¡¶ç‚¹åæ ‡æ˜¯å…¶æ¬¡åæ ‡ã€‚å…ˆç›´æ¥è¿”å›è¿™ä¸ªé¡¶ç‚¹åæ ‡ï¼Œè´´æ±‡ç¼–ï¼š</p><div class="language-hlsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//D3d11-</span>
      <span class="n">vs_4_0</span>                            <span class="c1">//ç‰ˆæœ¬</span>
      <span class="n">dcl_input</span> <span class="n">v0</span><span class="p">.</span><span class="n">xyzw</span>                 <span class="c1">//ç”³æ˜v0 è¾“å…¥ç³»ç»Ÿå€¼</span>
      <span class="n">dcl_output_siv</span> <span class="n">o0</span><span class="p">.</span><span class="n">xyzw</span><span class="p">,</span> <span class="n">position</span>  <span class="c1">//ç”³æ˜o0 è¾“å‡ºç³»ç»Ÿå€¼</span>
   <span class="mi">0</span><span class="o">:</span> <span class="n">mov</span> <span class="n">o0</span><span class="p">.</span><span class="n">xyzw</span><span class="p">,</span> <span class="n">v0</span><span class="p">.</span><span class="n">xyzw</span>              <span class="c1">//æŠŠv0å€¼ ç§»åŠ¨åˆ° o0</span>
   <span class="mi">1</span><span class="o">:</span> <span class="n">ret</span>

<span class="c1">//--GL CORE</span>
<span class="cp">#ifdef VERTEX
</span><span class="k">in</span>  <span class="n">vec4</span> <span class="n">in_POSITION0</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">gl_Position</span> <span class="o">=</span> <span class="n">in_POSITION0</span><span class="p">;</span>
    <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">#endifView Code
</span></code></pre></div></div><center class="half"><img id="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender2/raw-position.png" width="200" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>æ‰­æ›²çš„çƒ.</a></i></center> </font><p>ä½¿ç”¨MVPï¼šmodel_view_projectionçŸ©é˜µå˜æ¢é¡¶ç‚¹åæ ‡ï¼Œè¯¥å€¼å®šä¹‰åœ¨<em>UnityShaderVariables</em>æ–‡ä»¶ï¼Œå˜é‡åæ˜¯<code class="language-plaintext highlighter-rouge">UNITY_MATRIX_MVPã€‚æ”¹ä¸ºï¼š</code></p><p><a href="http://developer.download.nvidia.com/cg/mul.html">mul</a>å‡½æ•°å®šä¹‰</p><div class="language-hlsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">return</span> <span class="nf">mul</span><span class="p">(</span><span class="n">UNITY_MATRIX_MVP</span><span class="p">,</span> <span class="n">position</span><span class="p">);</span>
</code></pre></div></div><p>è´´æ±‡ç¼–çœ‹çœ‹</p><div class="language-hlsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">--</span> <span class="n">Vertex</span> <span class="n">shader</span> <span class="k">for</span> <span class="s">"d3d11"</span><span class="o">:</span>
<span class="c1">// Stats: 8 math</span>
<span class="n">Uses</span> <span class="n">vertex</span> <span class="n">data</span> <span class="n">channel</span> <span class="s">"Vertex"</span>
<span class="c1">//cbufferså¸¸é‡æ•°æ®</span>
<span class="n">Constant</span> <span class="kt">Buffer</span> <span class="s">"UnityPerDraw"</span> <span class="p">(</span><span class="mi">160</span> <span class="n">bytes</span><span class="p">)</span> <span class="n">on</span> <span class="n">slot</span> <span class="mi">0</span> <span class="p">{</span>
  <span class="n">Matrix4x4</span> <span class="n">unity_ObjectToWorld</span> <span class="n">at</span> <span class="mi">0</span>
<span class="p">}</span>
<span class="n">Constant</span> <span class="kt">Buffer</span> <span class="s">"UnityPerFrame"</span> <span class="p">(</span><span class="mi">384</span> <span class="n">bytes</span><span class="p">)</span> <span class="n">on</span> <span class="n">slot</span> <span class="mi">1</span> <span class="p">{</span>
  <span class="n">Matrix4x4</span> <span class="n">unity_MatrixVP</span> <span class="n">at</span> <span class="mi">272</span>
<span class="p">}</span>

<span class="n">Shader</span> <span class="n">Disassembly</span><span class="o">:</span>
      <span class="c1">//ç‰ˆæœ¬</span>
      <span class="n">vs_4_0</span>
      <span class="c1">//å£°æ˜å¸¸é‡ç¼“å†²åŒºcbuffersï¼Œé€å­—ç´¢å¼•</span>
      <span class="n">dcl_constantbuffer</span> <span class="n">CB0</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">immediateIndexed</span>
      <span class="c1">//cbuffers</span>
      <span class="n">dcl_constantbuffer</span> <span class="n">CB1</span><span class="p">[</span><span class="mi">21</span><span class="p">],</span> <span class="n">immediateIndexed</span>
      <span class="c1">//å£°æ˜è¾“å…¥v0</span>
      <span class="n">dcl_input</span> <span class="n">v0</span><span class="p">.</span><span class="n">xyz</span>
      <span class="c1">//å£°æ˜è¾“å…¥o0</span>
      <span class="n">dcl_output_siv</span> <span class="n">o0</span><span class="p">.</span><span class="n">xyzw</span><span class="p">,</span> <span class="n">position</span>
      <span class="c1">//å£°æ˜ä¸´æ—¶å¯„å­˜å™¨2ä¸ª(r0-r1)</span>
      <span class="n">dcl_temps</span> <span class="mi">2</span>
      <span class="c1">//å°†v0ä¸cb0[1]ç›¸ä¹˜ä¼ é€’ç»™r0</span>
    <span class="mi">0</span><span class="o">:</span> <span class="nb">mul</span> <span class="n">r0</span><span class="p">.</span><span class="n">xyzw</span><span class="p">,</span> <span class="n">v0</span><span class="p">.</span><span class="n">yyyy</span><span class="p">,</span> <span class="n">cb0</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">xyzw</span>
    <span class="cm">/*ç¬¬0è¡Œçš„è®¡ç®—æ­¥éª¤
    dest.x = cb0[0].x * v0.x + r0.x;
    dest.y = cb0[0].y * v0.x + r0.y;
    dest.z = cb0[0].z * v0.x + r0.z;
    dest.w = cb0[0].w * v0.x + r0.w;*/</span>

    <span class="c1">//r0 = cb0 * v0 + r0</span>
    <span class="mi">1</span><span class="o">:</span> <span class="nb">mad</span> <span class="n">r0</span><span class="p">.</span><span class="n">xyzw</span><span class="p">,</span> <span class="n">cb0</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">xyzw</span><span class="p">,</span> <span class="n">v0</span><span class="p">.</span><span class="n">xxxx</span><span class="p">,</span> <span class="n">r0</span><span class="p">.</span><span class="n">xyzw</span>
    <span class="c1">//åŒç†1ï¼š</span>
    <span class="mi">2</span><span class="o">:</span> <span class="nb">mad</span> <span class="n">r0</span><span class="p">.</span><span class="n">xyzw</span><span class="p">,</span> <span class="n">cb0</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">xyzw</span><span class="p">,</span> <span class="n">v0</span><span class="p">.</span><span class="n">zzzz</span><span class="p">,</span> <span class="n">r0</span><span class="p">.</span><span class="n">xyzw</span>    
    <span class="c1">//r0 = r0 + cb0</span>
    <span class="mi">3</span><span class="o">:</span> <span class="n">add</span> <span class="n">r0</span><span class="p">.</span><span class="n">xyzw</span><span class="p">,</span> <span class="n">r0</span><span class="p">.</span><span class="n">xyzw</span><span class="p">,</span> <span class="n">cb0</span><span class="p">[</span><span class="mi">3</span><span class="p">].</span><span class="n">xyzw</span>
    <span class="c1">//r1 = r0 * cb1</span>
    <span class="mi">4</span><span class="o">:</span> <span class="nb">mul</span> <span class="n">r1</span><span class="p">.</span><span class="n">xyzw</span><span class="p">,</span> <span class="n">r0</span><span class="p">.</span><span class="n">yyyy</span><span class="p">,</span> <span class="n">cb1</span><span class="p">[</span><span class="mi">18</span><span class="p">].</span><span class="n">xyzw</span>
    <span class="mi">5</span><span class="o">:</span> <span class="nb">mad</span> <span class="n">r1</span><span class="p">.</span><span class="n">xyzw</span><span class="p">,</span> <span class="n">cb1</span><span class="p">[</span><span class="mi">17</span><span class="p">].</span><span class="n">xyzw</span><span class="p">,</span> <span class="n">r0</span><span class="p">.</span><span class="n">xxxx</span><span class="p">,</span> <span class="n">r1</span><span class="p">.</span><span class="n">xyzw</span>    <span class="c1">//åŒç†1ï¼š</span>
    <span class="mi">6</span><span class="o">:</span> <span class="nb">mad</span> <span class="n">r1</span><span class="p">.</span><span class="n">xyzw</span><span class="p">,</span> <span class="n">cb1</span><span class="p">[</span><span class="mi">19</span><span class="p">].</span><span class="n">xyzw</span><span class="p">,</span> <span class="n">r0</span><span class="p">.</span><span class="n">zzzz</span><span class="p">,</span> <span class="n">r1</span><span class="p">.</span><span class="n">xyzw</span>    <span class="c1">//åŒç†1ï¼š</span>
    <span class="mi">7</span><span class="o">:</span> <span class="nb">mad</span> <span class="n">o0</span><span class="p">.</span><span class="n">xyzw</span><span class="p">,</span> <span class="n">cb1</span><span class="p">[</span><span class="mi">20</span><span class="p">].</span><span class="n">xyzw</span><span class="p">,</span> <span class="n">r0</span><span class="p">.</span><span class="n">wwww</span><span class="p">,</span> <span class="n">r1</span><span class="p">.</span><span class="n">xyzw</span>    <span class="c1">//åŒç†1ï¼š</span>
    <span class="mi">8</span><span class="o">:</span> <span class="n">retView</span> <span class="n">Code</span>
</code></pre></div></div><center class="half"><img id="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender2/correct-position.png" width="250" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>æ­£ç¡®çš„çƒ.</a></i></center> </font><h2 id="åƒç´ é¢œè‰²">åƒç´ é¢œè‰²</h2><p>å…ˆç»™Fragmentå‡½æ•°è¿”å›ç‚¹ä¸œè¥¿ï¼Œ</p><div class="language-hlsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">float4</span> <span class="nf">MyFragmentProgram</span><span class="p">(</span><span class="kt">float4</span> <span class="n">position</span> <span class="o">:</span> <span class="nb">SV_POSITION</span><span class="p">)</span> <span class="o">:</span> <span class="n">SV_TARGET</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="kt">float4</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div><center class="half"><img id="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender2/yellow-sphere.png" width="250" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>é»„è‰²çƒ.</a></i></center> </font><h3 id="ä½¿ç”¨shaderå±æ€§properties">ä½¿ç”¨Shaderå±æ€§Properties</h3><p>éœ€è¦åœ¨passå—å†…å£°æ˜ä¸€ä¸ªåŒç±»å‹çš„åŒå‘½åå˜é‡float4 _Tint;</p><div class="language-hlsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">float4</span> <span class="nf">MyFragmentProgram</span><span class="p">(</span><span class="kt">float4</span> <span class="n">position</span> <span class="o">:</span> <span class="nb">SV_POSITION</span><span class="p">)</span> <span class="o">:</span> <span class="n">SV_TARGET</span><span class="p">{</span>
    <span class="k">return</span> <span class="n">_Tint</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div><p>çœ‹çœ‹ç‰‡å…ƒå‡½æ•°çš„æ±‡ç¼–</p><div class="language-hlsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">--</span> <span class="n">Fragment</span> <span class="n">shader</span> <span class="k">for</span> <span class="s">"d3d11"</span><span class="o">:</span>
<span class="n">Constant</span> <span class="kt">Buffer</span> <span class="s">"$Globals"</span> <span class="p">(</span><span class="mi">48</span> <span class="n">bytes</span><span class="p">)</span> <span class="n">on</span> <span class="n">slot</span> <span class="mi">0</span> <span class="p">{</span>
  <span class="n">Vector4</span> <span class="n">_Tint</span> <span class="n">at</span> <span class="mi">32</span>
<span class="p">}</span>

<span class="n">Shader</span> <span class="n">Disassembly</span><span class="o">:</span>
      <span class="n">ps_4_0</span>
      <span class="n">dcl_constantbuffer</span> <span class="n">CB0</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">immediateIndexed</span>
      <span class="n">dcl_output</span> <span class="n">o0</span><span class="p">.</span><span class="n">xyzw</span>
   <span class="mi">0</span><span class="o">:</span> <span class="n">mov</span> <span class="n">o0</span><span class="p">.</span><span class="n">xyzw</span><span class="p">,</span> <span class="n">cb0</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">xyzw</span>
   <span class="mi">1</span><span class="o">:</span> <span class="n">retView</span> <span class="n">Code</span>
</code></pre></div></div><center class="half"><img id="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender2/green-sphere.png" width="250" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>çº¯è‰²çƒ.</a></i></center> </font><h3 id="ä»é¡¶ç‚¹åˆ°ç‰‡å…ƒ">ä»é¡¶ç‚¹åˆ°ç‰‡å…ƒ</h3><p>ä¸Šå›¾çº¯è‰²çƒï¼Œæ¯ä¸ªåƒç´ éƒ½æ˜¯åŒä¸€ä¸ªé¢œè‰²ï¼Œä½†æ˜¯ç¾æœ¯ç»™çš„æ•ˆæœå›¾æ˜¯äº”å½©æ–‘æ–“çš„ï¼Œ<strong>å°±éœ€è¦GPUå…‰æ …åŒ–ä¸‰è§’å½¢ï¼Œå–ä¸‰ä¸ªå¤„ç†è¿‡çš„é¡¶ç‚¹è¿›è¡Œæ’å€¼ï¼Œæ‰¾åˆ°ä¸‰è§’å½¢å†…æ‰€æœ‰åƒç´ å¹¶ç€è‰²</strong>ã€‚</p><center class="half"><img id="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender2/interpolation.png" width="250" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>shaderç¨‹åºæ‰§è¡Œæµç¨‹.</a></i></center> </font><p>å¤„ç†è¿‡çš„é¡¶ç‚¹æ•°æ®ä¸ç›´æ¥ä¼ é€’ç»™Fragmentç‰‡å…ƒå‡½æ•°ï¼Œè€Œåœ¨ç‰‡å…ƒå‡½æ•°ä¸­è®¿é—®æ’å€¼æœ¬åœ°æ•°æ®ï¼Œéœ€è¦å¢åŠ ä¸€ä¸ªå‚æ•°ï¼Œå¹¶æŒ‡å®šè¯­ä¹‰<em>TEXCOORD0</em>ï¼Œå®ƒè¡¨ç¤ºè´´å›¾çš„UVåæ ‡ã€‚</p><div class="language-hlsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">float4</span> <span class="nf">MyVertexProgram</span>
<span class="p">(</span>
    <span class="kt">float4</span> <span class="n">position</span><span class="o">:</span> <span class="nb">POSITION</span><span class="p">,</span>
    <span class="k">out</span> <span class="kt">float3</span> <span class="n">localPosition</span> <span class="o">:</span> <span class="nb">TEXCOORD0</span>
<span class="p">)</span> <span class="o">:</span> <span class="nb">SV_POSITION</span><span class="p">{</span>
    <span class="n">localPosition</span> <span class="o">=</span> <span class="n">position</span><span class="p">.</span><span class="n">xyz</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">UnityObjectToClipPos</span><span class="p">(</span><span class="n">position</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">float4</span> <span class="nf">MyFragmentProgram</span>
<span class="p">(</span>
    <span class="kt">float4</span> <span class="n">position</span> <span class="o">:</span> <span class="nb">SV_POSITION</span><span class="p">,</span>
    <span class="kt">float3</span> <span class="n">localPosition</span> <span class="o">:</span> <span class="nb">TEXCOORD0</span>
<span class="p">)</span> <span class="o">:</span> <span class="n">SV_TARGET</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="kt">float4</span><span class="p">(</span><span class="n">localPosition</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div><center class="half"><img id="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender2/local-position.png" width="250" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>æ’å€¼æœ¬åœ°æ•°æ®ä½œä¸ºé¢œè‰².</a></i></center> </font><h3 id="ç»“æ„ä½“">ç»“æ„ä½“</h3><p>ç®€åŒ–ä¼ é€’Fragmentå‡½æ•°çš„å‚æ•°ï¼Œæ–°å»ºä¸€ä¸ªç»“æ„ä½“</p><div class="language-hlsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">struct</span> <span class="n">Interpolators</span><span class="p">{</span>
    <span class="kt">float4</span> <span class="n">position</span> <span class="o">:</span> <span class="nb">SV_POSITION</span><span class="p">;</span>
    <span class="kt">float3</span> <span class="n">localPosition</span> <span class="o">:</span> <span class="nb">TEXCOORD0</span><span class="p">;</span>
<span class="p">};</span>

<span class="n">Interpolators</span> <span class="nf">MyVertexProgram</span> <span class="p">(</span><span class="kt">float4</span> <span class="n">position</span><span class="o">:</span> <span class="nb">POSITION</span> <span class="p">){</span>
    <span class="n">Interpolators</span> <span class="n">i</span><span class="p">;</span>
    <span class="n">i</span><span class="p">.</span><span class="n">localPosition</span> <span class="o">=</span> <span class="n">position</span><span class="p">.</span><span class="n">xyz</span><span class="p">;</span>
    <span class="n">i</span><span class="p">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">UnityObjectToClipPos</span><span class="p">(</span><span class="n">position</span><span class="p">);</span>
     <span class="k">return</span> <span class="n">i</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">float4</span> <span class="nf">MyFragmentProgram</span> <span class="p">(</span><span class="n">Interpolators</span> <span class="n">i</span><span class="p">)</span> <span class="o">:</span> <span class="n">SV_TARGET</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="kt">float4</span><span class="p">(</span><span class="n">i</span><span class="p">.</span><span class="n">localPosition</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
 <span class="p">}</span>
</code></pre></div></div><blockquote class="prompt-tip"><p><strong>UnityObjectToClipPos</strong>æ˜¯Unity5.6ä¹‹åçš„ä¼˜åŒ–ï¼š å®ƒå¯¹åº”mul(UNITY_MATRIX_MVP, v.vertex)ï¼Œä½†æ˜¯è¯¥å‡½æ•°ä½¿ç”¨äº†å¸¸æ•°1ä½œä¸ºç¬¬å››ä¸ªåæ ‡è€Œä¸æ˜¯ ä¾èµ–ç½‘æ ¼æ•°æ®ï¼Œæºç :</p><div file="cg" class="language-hlsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">inline</span> <span class="kt">float4</span> <span class="nf">UnityObjectToClipPosInstanced</span><span class="p">(</span><span class="k">in</span> <span class="kt">float3</span> <span class="n">pos</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">float4</span> <span class="n">w</span> <span class="o">=</span> <span class="nb">mul</span><span class="p">(</span><span class="n">unity_ObjectToWorldArray</span><span class="p">[</span><span class="n">unity_InstanceID</span><span class="p">],</span>
                  <span class="kt">float4</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">mul</span><span class="p">(</span><span class="n">UNITY_MATRIX_VP</span><span class="p">,</span> <span class="n">w</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div></div><p>å› ä¸ºé€šè¿‡ç½‘æ ¼æä¾›çš„æ•°å§‹ç»ˆä¸º1ï¼Œä½†æ˜¯ç¼–è¯‘å™¨ä¸èƒ½çŸ¥æ™“ã€‚æ‰€å¹¸å¹²è„†å°±ç›´æ¥å†™æ­»ä¸º1.0ï¼Œä¼˜åŒ–æ‰è¿è¡Œ æ—¶å†å»è®¡ç®—ç¬¬å››ä¸ªæ•°åˆ°åº•æ˜¯å¤šå°‘è¿™ä¸€æ­¥ã€‚</p></blockquote><h3 id="è°ƒæ•´é¢œè‰²">è°ƒæ•´é¢œè‰²</h3><p>å› ä¸ºè´Ÿé¢œè‰²è¢«çº¦æŸé™åˆ¶ä¸ºé›¶ï¼Œæˆ‘ä»¬çš„çƒä½“æœ€ç»ˆå˜å¾—ç›¸å½“æš—ã€‚ çƒä½“çš„è‡ªèº«åŠå¾„ä¸º$1\over 2$ï¼Œå› æ­¤é¢œè‰²é€šé“æœ€ç»ˆä»‹äº$-{1\over 2}$å’Œ$1\over 2$ä¹‹é—´ã€‚æˆ‘ä»¬å¸Œæœ›å°†å®ƒä»¬ç§»åŠ¨åˆ° 0-1 èŒƒå›´å†…ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å‘æ‰€æœ‰é€šé“æ·»åŠ $1\over 2$æ¥å®ç°ã€‚</p><div class="language-hlsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">return</span> <span class="nf">float4</span><span class="p">(</span><span class="n">i</span><span class="p">.</span><span class="n">localPosition</span> <span class="o">+</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</code></pre></div></div><p>å†çœ‹çœ‹æ±‡ç¼–ä»£ç </p><div class="language-hlsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">uniform</span> 	<span class="n">vec4</span> <span class="n">_Tint</span><span class="p">;</span>
<span class="k">in</span>  <span class="n">vec3</span> <span class="n">vs_TEXCOORD0</span><span class="p">;</span>
<span class="n">layout</span><span class="p">(</span><span class="n">location</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">out</span> <span class="n">vec4</span> <span class="n">SV_TARGET0</span><span class="p">;</span>
<span class="n">vec4</span> <span class="n">t0</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">t0</span><span class="p">.</span><span class="n">xyz</span> <span class="o">=</span> <span class="n">vs_TEXCOORD0</span><span class="p">.</span><span class="n">xyz</span> <span class="o">+</span> <span class="n">vec3</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">);</span>
    <span class="n">t0</span><span class="p">.</span><span class="n">w</span> <span class="o">=</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">;</span>
    <span class="n">SV_TARGET0</span> <span class="o">=</span> <span class="n">t0</span> <span class="o">*</span> <span class="n">_Tint</span><span class="p">;</span>
    <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div><div class="language-hlsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ConstBuffer</span> <span class="s">"$Globals"</span> <span class="mi">128</span>
<span class="n">Vector</span> <span class="mi">96</span> <span class="p">[</span><span class="n">_Tint</span><span class="p">]</span>
<span class="n">BindCB</span>  <span class="s">"$Globals"</span> <span class="mi">0</span>
      <span class="n">ps_4_0</span>
      <span class="n">dcl_constantbuffer</span> <span class="n">cb0</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="n">immediateIndexed</span>
      <span class="n">dcl_input_ps</span> <span class="k">linear</span> <span class="n">v0</span><span class="p">.</span><span class="n">xyz</span>
      <span class="n">dcl_output</span> <span class="n">o0</span><span class="p">.</span><span class="n">xyzw</span>
      <span class="n">dcl_temps</span> <span class="mi">1</span>
   <span class="mi">0</span><span class="o">:</span> <span class="n">add</span> <span class="n">r0</span><span class="p">.</span><span class="n">xyz</span><span class="p">,</span> <span class="n">v0</span><span class="p">.</span><span class="n">xyzx</span><span class="p">,</span> <span class="n">l</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">500000</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">500000</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">500000</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mo">000000</span><span class="p">)</span>
   <span class="mi">1</span><span class="o">:</span> <span class="n">mov</span> <span class="n">r0</span><span class="p">.</span><span class="n">w</span><span class="p">,</span> <span class="n">l</span><span class="p">(</span><span class="mi">1</span><span class="p">.</span><span class="mo">000000</span><span class="p">)</span>
   <span class="mi">2</span><span class="o">:</span> <span class="nb">mul</span> <span class="n">o0</span><span class="p">.</span><span class="n">xyzw</span><span class="p">,</span> <span class="n">r0</span><span class="p">.</span><span class="n">xyzw</span><span class="p">,</span> <span class="n">cb0</span><span class="p">[</span><span class="mi">6</span><span class="p">].</span><span class="n">xyzw</span>
   <span class="mi">3</span><span class="o">:</span> <span class="n">ret</span>
</code></pre></div></div><center class="half"><img id="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender2/local-position-01.png" width="250" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>è°ƒæ•´ä¹‹åçš„é¢œè‰².</a></i></center> </font><h2 id="çº¹ç†">çº¹ç†</h2><p>å¦‚æœæƒ³åœ¨æ¨¡å‹ç½‘æ ¼ä¸Šä¸æ·»åŠ æ›´å¤šä¸‰è§’å½¢é¢æ•°çš„æƒ…å†µä¸‹ä¸ºç½‘æ ¼æ·»åŠ æ›´å¤šæ›´æ˜æ˜¾çš„ç»†èŠ‚å’Œå¤šæ ·æ€§å‘ˆç°ï¼Œå¯ä»¥ä½¿ç”¨çº¹ç†æŠ•å½±åˆ°ç½‘æ ¼çš„ä¸‰è§’å½¢ä¸Šã€‚</p><p>çº¹ç†åæ ‡ç”¨äºæ§åˆ¶æŠ•å½±ï¼Œä¸‹å›¾æ˜¯2Dåæ ‡ã€‚ä¸ç®¡çº¹ç†çš„å®é™…çºµæ¨ªæ¯”å¦‚ä½•ï¼Œå…¶æ°´å¹³åæ ‡ç§°ä¸ºUï¼Œå‚ç›´åæ ‡ç§°ä¸ºVï¼Œå®ƒä»¬é€šå¸¸ç§°ä¸ºUVåæ ‡ã€‚</p><center class="half"><img id="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender2/uv-rectangle.png" width="300" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>uvåæ ‡å›¾.</a></i></center> </font><p>Uåæ ‡ä»å·¦åˆ°å³é€’å¢ï¼Œèµ·å§‹ç‚¹ä¸º0ç»ˆç‚¹ä¸º1ã€‚ Våæ ‡ä»ä¸‹åˆ°ä¸Šå¢åŠ ï¼Œé™¤äº†Direct3Då®ƒä»ä¸Šåˆ°ä¸‹ã€‚</p><h3 id="ä½¿ç”¨uvåæ ‡">ä½¿ç”¨UVåæ ‡</h3><p>Unityçš„é»˜è®¤ç½‘æ ¼å…·æœ‰é€‚åˆçº¹ç†æ˜ å°„çš„UVåæ ‡ã€‚é¡¶ç‚¹ç¨‹åºå¯ä»¥é€šè¿‡å‚æ•°è®¿é—®å®ƒä»¬<em>TEXCOORD0</em>è¯­ä¹‰ã€‚ç„¶åä¼ é€’ç»™ç‰‡å…ƒå‡½æ•°ä½¿ç”¨ã€‚</p><div class="language-hlsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">struct</span> <span class="n">Interpolators</span> <span class="p">{</span>
    <span class="kt">float4</span> <span class="n">position</span> <span class="o">:</span> <span class="nb">SV_POSITION</span><span class="p">;</span>
    <span class="kt">float2</span> <span class="n">uv</span> <span class="o">:</span> <span class="nb">TEXCOORD0</span><span class="p">;</span>
<span class="p">};</span>

<span class="n">Interpolators</span> <span class="nf">MyVertexProgram</span> <span class="p">(</span><span class="n">VertedData</span> <span class="n">v</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Interpolators</span> <span class="n">i</span><span class="p">;</span>
    <span class="n">i</span><span class="p">.</span><span class="n">position</span> <span class="o">=</span> <span class="nb">mul</span><span class="p">(</span><span class="n">UNITY_MATRIX_MVP</span><span class="p">,</span> <span class="n">v</span><span class="p">.</span><span class="n">position</span><span class="p">);</span>
    <span class="n">i</span><span class="p">.</span><span class="n">uv</span> <span class="o">=</span> <span class="n">v</span><span class="p">.</span><span class="n">uv</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">i</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">float4</span> <span class="nf">MyFragmentProgram</span> <span class="p">(</span><span class="n">Interpolators</span> <span class="n">i</span><span class="p">)</span> <span class="o">:</span> <span class="n">SV_TARGET</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kt">float4</span><span class="p">(</span><span class="n">i</span><span class="p">.</span><span class="n">uv</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div><p>å†çœ‹çœ‹æ±‡ç¼–</p><div class="language-hlsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">in</span>  <span class="n">vec4</span> <span class="n">in_POSITION0</span><span class="p">;</span>
<span class="k">in</span>  <span class="n">vec2</span> <span class="n">in_TEXCOORD0</span><span class="p">;</span>
<span class="k">out</span> <span class="n">vec2</span> <span class="n">vs_TEXCOORD0</span><span class="p">;</span>
<span class="n">vec4</span> <span class="n">t0</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">t0</span> <span class="o">=</span> <span class="n">in_POSITION0</span><span class="p">.</span><span class="n">yyyy</span> <span class="o">*</span> <span class="n">glstate_matrix_mvp</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="n">t0</span> <span class="o">=</span> <span class="n">glstate_matrix_mvp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">in_POSITION0</span><span class="p">.</span><span class="n">xxxx</span> <span class="o">+</span> <span class="n">t0</span><span class="p">;</span>
    <span class="n">t0</span> <span class="o">=</span> <span class="n">glstate_matrix_mvp</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">in_POSITION0</span><span class="p">.</span><span class="n">zzzz</span> <span class="o">+</span> <span class="n">t0</span><span class="p">;</span>
    <span class="n">gl_Position</span> <span class="o">=</span> <span class="n">glstate_matrix_mvp</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="n">in_POSITION0</span><span class="p">.</span><span class="n">wwww</span> <span class="o">+</span> <span class="n">t0</span><span class="p">;</span>
    <span class="c1">//å°†UVåæ ‡ä»é¡¶ç‚¹æ•°æ®å¤åˆ¶åˆ°Interpolatorsè¾“å‡º</span>
    <span class="n">vs_TEXCOORD0</span><span class="p">.</span><span class="n">xy</span> <span class="o">=</span> <span class="n">in_TEXCOORD0</span><span class="p">.</span><span class="n">xy</span><span class="p">;</span>
    <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div><div class="language-hlsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Bind</span> <span class="s">"vertex"</span> <span class="n">Vertex</span>
<span class="n">Bind</span> <span class="s">"texcoord"</span> <span class="n">TexCoord0</span>
<span class="n">ConstBuffer</span> <span class="s">"UnityPerDraw"</span> <span class="mi">352</span>
<span class="n">Matrix</span> <span class="mi">0</span> <span class="p">[</span><span class="n">glstate_matrix_mvp</span><span class="p">]</span>
<span class="n">BindCB</span>  <span class="s">"UnityPerDraw"</span> <span class="mi">0</span>
      <span class="n">vs_4_0</span>
      <span class="n">dcl_constantbuffer</span> <span class="n">cb0</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">immediateIndexed</span>
      <span class="n">dcl_input</span> <span class="n">v0</span><span class="p">.</span><span class="n">xyzw</span>
      <span class="n">dcl_input</span> <span class="n">v1</span><span class="p">.</span><span class="n">xy</span>
      <span class="n">dcl_output_siv</span> <span class="n">o0</span><span class="p">.</span><span class="n">xyzw</span><span class="p">,</span> <span class="n">position</span>
      <span class="n">dcl_output</span> <span class="n">o1</span><span class="p">.</span><span class="n">xy</span>
      <span class="n">dcl_temps</span> <span class="mi">1</span>
   <span class="mi">0</span><span class="o">:</span> <span class="nb">mul</span> <span class="n">r0</span><span class="p">.</span><span class="n">xyzw</span><span class="p">,</span> <span class="n">v0</span><span class="p">.</span><span class="n">yyyy</span><span class="p">,</span> <span class="n">cb0</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">xyzw</span>
   <span class="mi">1</span><span class="o">:</span> <span class="nb">mad</span> <span class="n">r0</span><span class="p">.</span><span class="n">xyzw</span><span class="p">,</span> <span class="n">cb0</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">xyzw</span><span class="p">,</span> <span class="n">v0</span><span class="p">.</span><span class="n">xxxx</span><span class="p">,</span> <span class="n">r0</span><span class="p">.</span><span class="n">xyzw</span>
   <span class="mi">2</span><span class="o">:</span> <span class="nb">mad</span> <span class="n">r0</span><span class="p">.</span><span class="n">xyzw</span><span class="p">,</span> <span class="n">cb0</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">xyzw</span><span class="p">,</span> <span class="n">v0</span><span class="p">.</span><span class="n">zzzz</span><span class="p">,</span> <span class="n">r0</span><span class="p">.</span><span class="n">xyzw</span>
   <span class="mi">3</span><span class="o">:</span> <span class="nb">mad</span> <span class="n">o0</span><span class="p">.</span><span class="n">xyzw</span><span class="p">,</span> <span class="n">cb0</span><span class="p">[</span><span class="mi">3</span><span class="p">].</span><span class="n">xyzw</span><span class="p">,</span> <span class="n">v0</span><span class="p">.</span><span class="n">wwww</span><span class="p">,</span> <span class="n">r0</span><span class="p">.</span><span class="n">xyzw</span>
   <span class="mi">4</span><span class="o">:</span> <span class="n">mov</span> <span class="n">o1</span><span class="p">.</span><span class="n">xy</span><span class="p">,</span> <span class="n">v1</span><span class="p">.</span><span class="n">xyxx</span><span class="c1">//å°†UVåæ ‡ä»v1.xyä¼ é€’åˆ°o1.xy</span>
   <span class="mi">5</span><span class="o">:</span> <span class="n">ret</span>
</code></pre></div></div><p>Unityå°†UVåæ ‡åŒ…è£¹åœ¨å…¶çƒä½“å‘¨å›´ï¼Œåœ¨çƒä½“ä¸¤æå¤„å›¾åƒçš„é¡¶éƒ¨å’Œåº•éƒ¨ã€‚å›¾åƒçš„å·¦ä¾§å’Œå³ä¾§æ¥ç¼è¿æ¥åœ¨ä¸€èµ·ã€‚ æ²¿ç€è¯¥æ¥ç¼ï¼ŒUVåæ ‡å€¼ä»0åˆ°1ã€‚</p><center class="half"><img id="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender2/uv-sphere.png" width="250" alt="loading failed, need vpn." /> <img id="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender2/uv-sphere-above.png" width="250" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>çƒä½“ç¼éš™.</a></i></center> </font><h3 id="æ·»åŠ çº¹ç†">æ·»åŠ çº¹ç†</h3><p>è¦ä½¿ç”¨çº¹ç†ï¼Œå¿…é¡»æ·»åŠ å¦ä¸€ä¸ªç€è‰²å™¨å±æ€§ã€‚ å¸¸è§„çº¹ç†å±æ€§çš„ç±»å‹æ˜¯2D ï¼Œå› ä¸ºè¿˜æœ‰å…¶ä»–ç±»å‹çš„çº¹ç†ã€‚ é»˜è®¤å€¼æ˜¯å¼•ç”¨ Unity çš„é»˜è®¤çº¹ç†ä¹‹ä¸€çš„å­—ç¬¦ä¸²ï¼Œå¯ä»¥æ˜¯white ã€ black æˆ– gray ã€‚</p><p>ä¸»çº¹ç†å‘½åçº¦å®šæ˜¯<em>_MainTex</em>ã€‚ è¿™ä¹Ÿä½¿æ‚¨å¯ä»¥ä½¿ç”¨æ–¹ä¾¿çš„ Material.mainTextureå±æ€§ä»¥é€šè¿‡è„šæœ¬è®¿é—®å®ƒã€‚</p><div class="language-hlsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Properties</span> <span class="p">{</span>
    <span class="n">_Tint</span> <span class="p">(</span><span class="s">"Tint"</span><span class="p">,</span> <span class="n">Color</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">_MainTex</span> <span class="p">(</span><span class="s">"Texture"</span><span class="p">,</span> <span class="mi">2</span><span class="n">D</span><span class="p">)</span> <span class="o">=</span> <span class="s">"white"</span> <span class="p">{}</span>
<span class="p">}</span>
</code></pre></div></div><blockquote class="prompt-tip"><p>â€œwhiteâ€ {} è¿™ä¸ªèŠ±æ‹¬å·æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</p><p>ä¸Šå¤æ—¶ä»£å¼€å‘çš„å›ºå®šåŠŸèƒ½ç€è‰²å™¨æ›¾ç»éœ€è¦çº¹ç†è®¾ç½®ï¼Œè¿™äº›è®¾ç½®è¢«æ”¾åœ¨è¿™äº›æ‹¬å·å†…ï¼Œä½†ç°åœ¨å®ƒä»¬ä¸å†ä½¿ç”¨ äº†ã€‚å³ä½¿å®ƒä»¬ç°åœ¨å·²ç»æ— ç”¨ï¼Œç€è‰²ç¼–è¯‘å™¨ä»ç„¶éœ€è¦å®ƒä»¬ï¼Œå¦‚æœå¿½ç•¥å®ƒä»¬ä¼šäº§ç”Ÿé”™è¯¯ã€‚</p></blockquote><p>é€‰ä¸­æè´¨ï¼ŒæŸ¥çœ‹inspectorä¿¡æ¯</p><center class="half"><img id="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender2/material-inspector.png" width="320" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>çº¹ç†_whiteæ˜¾ç¤º.</a></i></center> </font><p>é€šè¿‡ä½¿ç”¨<em>sampler2D</em>ç±»å‹ä¸ºå˜é‡æ¥è®¿é—®ç€è‰²å™¨ä¸­çš„çº¹ç†ã€‚</p><div class="language-hlsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">float4</span> <span class="n">_Tint</span><span class="p">;</span>
<span class="n">sampler2D</span> <span class="n">_MainTex</span><span class="p">;</span>
</code></pre></div></div><p>é€šè¿‡åœ¨ç‰‡æ®µç¨‹åºä¸­ä½¿ç”¨tex2Då‡½æ•°ï¼Œå®Œæˆå¯¹çº¹ç†UVåæ ‡è¿›è¡Œé‡‡æ ·ã€‚</p><div class="language-hlsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">float4</span> <span class="nf">MyFragmentProgram</span> <span class="p">(</span><span class="n">Interpolators</span> <span class="n">i</span><span class="p">)</span> <span class="o">:</span> <span class="n">SV_TARGET</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">tex2D</span><span class="p">(</span><span class="n">_MainTex</span><span class="p">,</span> <span class="n">i</span><span class="p">.</span><span class="n">uv</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div><p>å†æŸ¥çœ‹æ±‡ç¼–åçš„shaderä»£ç </p><div class="language-hlsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">uniform</span>  <span class="n">sampler2D</span> <span class="n">_MainTex</span><span class="p">;</span>
<span class="k">in</span>  <span class="n">vec2</span> <span class="n">vs_TEXCOORD0</span><span class="p">;</span>
<span class="n">layout</span><span class="p">(</span><span class="n">location</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">out</span> <span class="n">vec4</span> <span class="n">SV_TARGET0</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">SV_TARGET0</span> <span class="o">=</span> <span class="k">texture</span><span class="p">(</span><span class="n">_MainTex</span><span class="p">,</span> <span class="n">vs_TEXCOORD0</span><span class="p">.</span><span class="n">xy</span><span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div><div class="language-hlsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">SetTexture</span> <span class="mi">0</span> <span class="p">[</span><span class="n">_MainTex</span><span class="p">]</span> <span class="mi">2</span><span class="n">D</span> <span class="mi">0</span>
      <span class="n">ps_4_0</span>
      <span class="n">dcl_sampler</span> <span class="n">s0</span><span class="p">,</span> <span class="n">mode_default</span>
      <span class="n">dcl_resource_texture2d</span> <span class="p">(</span><span class="n">float</span><span class="p">,</span><span class="n">float</span><span class="p">,</span><span class="n">float</span><span class="p">,</span><span class="n">float</span><span class="p">)</span> <span class="n">t0</span>
      <span class="n">dcl_input_ps</span> <span class="k">linear</span> <span class="n">v0</span><span class="p">.</span><span class="n">xy</span>
      <span class="n">dcl_output</span> <span class="n">o0</span><span class="p">.</span><span class="n">xyzw</span>
   <span class="mi">0</span><span class="o">:</span> <span class="k">sample</span> <span class="n">o0</span><span class="p">.</span><span class="n">xyzw</span><span class="p">,</span> <span class="n">v0</span><span class="p">.</span><span class="n">xyxx</span><span class="p">,</span> <span class="n">t0</span><span class="p">.</span><span class="n">xyzw</span><span class="p">,</span> <span class="n">s0</span>
   <span class="mi">1</span><span class="o">:</span> <span class="n">ret</span>
</code></pre></div></div><center class="half"><img id="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender2/textured-sphere.png" width="250" alt="loading failed, need vpn." /> <img id="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender2/textured-sphere-above.png" width="250" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>å¸¦çº¹ç†çƒä½“.</a></i></center> </font><p>çƒä½“ä¸¤æé™„è¿‘ä¼šæ˜¾å¾—éå¸¸æ‚ä¹±ã€‚ ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿ å‘ç”Ÿçº¹ç†å¤±çœŸæ˜¯å› ä¸ºæ’å€¼åœ¨ä¸‰è§’å½¢ä¸­æ˜¯çº¿æ€§çš„ã€‚ Unity çš„çƒä½“åœ¨ä¸¤æé™„è¿‘åªæœ‰å‡ ä¸ªä¸‰è§’å½¢ï¼Œå…¶ä¸­UVåæ ‡å¤±çœŸæœ€å¤§ã€‚æ‰€ä»¥UVåæ ‡åœ¨ä¸‰è§’å½¢ä¸ä¸‰è§’å½¢çš„é¡¶ç‚¹ä¹‹é—´æ˜¯éçº¿æ€§å˜åŒ–ï¼Œä½†åœ¨ä¸‰è§’å½¢å†…éƒ¨çš„é¡¶ç‚¹ä¹‹é—´çš„å˜åŒ–æ˜¯çº¿æ€§çš„ã€‚æ‰€ä»¥çƒä½“ä¸¤æçº¹ç†ä¸­çš„ç›´çº¿åœ¨ä¸‰è§’å½¢è¾¹ç•Œå¤„çªç„¶æ”¹å˜æ–¹å‘ã€‚</p><center class="half"><img id="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender2/textured-sphere-wireframe.png" width="300" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>è·¨ä¸‰è§’å½¢æ’å€¼.</a></i></center> </font><p>ä¸åŒçš„ç½‘æ ¼å…·æœ‰ä¸åŒçš„ UV åæ ‡ï¼Œä»è€Œäº§ç”Ÿä¸åŒçš„æ˜ å°„ã€‚ Unity çš„é»˜è®¤çƒä½“ä½¿ç”¨ç»çº¬åº¦çº¹ç†æ˜ å°„ï¼Œè€Œç½‘æ ¼æ˜¯ä½åˆ†è¾¨ç‡ç«‹æ–¹ä½“çƒä½“ã€‚ è¿™è¶³ä»¥è¿›è¡Œæµ‹è¯•ï¼Œä½†æ‚¨æœ€å¥½ä½¿ç”¨è‡ªå®šä¹‰çƒä½“ç½‘æ ¼ä»¥è·å¾—æ›´å¥½çš„ç»“æœã€‚</p><h3 id="å¹³é“ºå’Œåç§»">å¹³é“ºå’Œåç§»</h3><p>ä¸ºç€è‰²å™¨æ·»åŠ çº¹ç†å±æ€§åï¼Œæè´¨æ£€æŸ¥å™¨ä¸ä»…æ˜¾ç¤ºäº†çº¹ç†å­—æ®µã€‚å®ƒè¿˜æ˜¾ç¤ºäº†å¹³é“ºå’Œåç§»æ§åˆ¶ã€‚ä½†æ˜¯ï¼Œæ›´æ”¹è¿™äº› 2D å‘é‡ç›®å‰æ²¡æœ‰ä»»ä½•æ•ˆæœã€‚</p><p>è¿™äº›é¢å¤–çš„çº¹ç†æ•°æ®å­˜å‚¨åœ¨æè´¨ä¸­ï¼Œä¹Ÿå¯ä»¥ç”±ç€è‰²å™¨è®¿é—®ã€‚ å¯ä»¥é€šè¿‡ä¸å…³è”ææ–™åŒåçš„å˜é‡åŠ ä¸Š<em>_ST</em> åç¼€æ¥æ‰§è¡Œæ­¤æ“ä½œã€‚è¿™ä¸ªå˜é‡çš„ç±»å‹å¿…é¡»æ˜¯float4.</p><div class="language-hlsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sampler2D</span> <span class="n">_MainTex</span><span class="p">;</span>
<span class="kt">float4</span> <span class="n">_MainTex_ST</span><span class="p">;</span>
</code></pre></div></div><p>å¹³é“ºå‘é‡ç”¨äºç¼©æ”¾çº¹ç†ï¼Œå› æ­¤é»˜è®¤ä¸º$(1, 1)$ã€‚ å®ƒå­˜å‚¨åœ¨å˜é‡çš„XYéƒ¨åˆ†ã€‚ è¦ä½¿ç”¨å®ƒåªéœ€å°†å®ƒä¸UV åæ ‡ç›¸ä¹˜ã€‚ è¿™å¯ä»¥åœ¨é¡¶ç‚¹ç€è‰²å™¨æˆ–ç‰‡æ®µç€è‰²å™¨ä¸­å®Œæˆã€‚ åœ¨é¡¶ç‚¹ç€è‰²å™¨ä¸­è¿™æ ·åšæ˜¯æœ‰æ„ä¹‰çš„ï¼Œåªä¸ºæ¯ä¸ªé¡¶ç‚¹è€Œä¸æ˜¯æ¯ä¸ªåƒç´ æ‰§è¡Œä¹˜æ³•ã€‚</p><div class="language-hlsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Interpolators</span> <span class="nf">MyVertexProgram</span> <span class="p">(</span><span class="n">VertexData</span> <span class="n">v</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Interpolators</span> <span class="n">i</span><span class="p">;</span>
    <span class="n">i</span><span class="p">.</span><span class="n">position</span> <span class="o">=</span> <span class="nb">mul</span><span class="p">(</span><span class="n">UNITY_MATRIX_MVP</span><span class="p">,</span> <span class="n">v</span><span class="p">.</span><span class="n">position</span><span class="p">);</span>
    <span class="n">i</span><span class="p">.</span><span class="n">uv</span> <span class="o">=</span> <span class="n">v</span><span class="p">.</span><span class="n">uv</span> <span class="o">*</span> <span class="n">_MainTex_ST</span><span class="p">.</span><span class="n">xy</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">i</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div><p>åç§»å‘é‡ç”¨äºç§»åŠ¨çº¹ç†ï¼Œå¹¶å­˜å‚¨åœ¨å˜é‡çš„ZWéƒ¨åˆ†ä¸­ã€‚</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>i.uv = v.uv * _MainTex_ST.xy + _MainTex_ST.zw;
</code></pre></div></div><p>UnityCG.cgincåŒ…å«ä¸€ä¸ªæ–¹ä¾¿çš„å®:<em>TRANSFORM_TEX</em></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>i.uv = TRANSFORM_TEX(v.uv, _MainTex);
</code></pre></div></div><h2 id="çº¹ç†è®¾ç½®">çº¹ç†è®¾ç½®</h2><center class="half"><img id="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender2/texture-inspector.png" width="320" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>é»˜è®¤çš„çº¹ç†è®¾ç½®.</a></i></center> </font><p>Wrap Modeå†³å®šäº†åœ¨ä½¿ç”¨0-1èŒƒå›´ä¹‹å¤–çš„UVåæ ‡è¿›è¡Œé‡‡æ ·æ—¶çš„è¾“å‡ºã€‚</p><ul><li>è®¾ç½®ä¸ºclampedæ—¶ï¼ŒUVè¢«é™åˆ¶åœ¨ 0â€“1 èŒƒå›´å†…ã€‚ è¿™æ„å‘³ç€è¶…å‡ºè¾¹ç¼˜çš„åƒç´ ä¸ä½äºè¾¹ç¼˜çš„åƒç´ ç›¸åŒã€‚<li>è®¾ç½®ä¸ºrepeatæ—¶ï¼ŒUVä»0-1å¾ªç¯ã€‚è¿™æ„å‘³ç€è¶…å‡ºè¾¹ç¼˜çš„åƒç´ ä¸çº¹ç†å¦ä¸€ä¾§çš„åƒç´ ç›¸åŒã€‚</ul><p>Wrap Modeé»˜è®¤æ¨¡å¼æ˜¯é‡å¤çº¹ç†ï¼Œè¿™ä¼šå¯¼è‡´å®ƒå¹³é“ºã€‚</p><center class="half"><img id="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender2/clamp.png" width="300" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>åœ¨(2, 2)å¼€å§‹å¹³é“º.</a></i></center> </font><h3 id="mipmapå’Œfilter">Mipmapå’ŒFilter</h3><p>å½“çº¹ç†çš„åƒç´ ä¸å®ƒä»¬æŠ•å½±åˆ°ç½‘æ ¼çš„åƒç´ ä¸å®Œå…¨åŒ¹é…æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ å­˜åœ¨ä¸åŒ¹é…ï¼Œå¿…é¡»ä»¥æŸç§æ–¹å¼è§£å†³ã€‚è¿™æ˜¯ç”±Filter Modeå®Œæˆå¦‚ä½•æ§åˆ¶ã€‚</p><ul><li>Point (no filter) ã€‚è¿™æ„å‘³ç€å½“åœ¨æŸäº› UV åæ ‡å¤„å¯¹çº¹ç†è¿›è¡Œé‡‡æ ·æ—¶ï¼Œå°†ä½¿ç”¨æœ€è¿‘çš„åƒç´ ã€‚ è¿™å°†ä½¿çº¹ç†å‘ˆç°å—çŠ¶å¤–è§‚ï¼Œé™¤éåƒç´ ç²¾ç¡®æ˜ å°„åˆ°æ˜¾ç¤ºåƒç´ ã€‚ å› æ­¤ï¼Œå®ƒé€šå¸¸ç”¨äºåƒç´ å®Œç¾çš„æ¸²æŸ“ï¼Œæˆ–è€…éœ€è¦å—çŠ¶æ ·å¼æ—¶ã€‚<li>bilinear filteringåŒçº¿æ€§è¿‡æ»¤ã€‚ å½“çº¹ç†åœ¨ä¸¤ä¸ªåƒç´ ä¹‹é—´çš„æŸå¤„è¢«é‡‡æ ·æ—¶ï¼Œè¿™ä¸¤ä¸ªåƒç´ è¢«æ’å€¼ã€‚ ç”±äºçº¹ç†æ˜¯ 2D çš„ï¼Œè¿™å‘ç”Ÿåœ¨ U è½´å’Œ V è½´ä¸Šã€‚ å› æ­¤æ˜¯åŒçº¿æ€§è¿‡æ»¤ã€‚</ul><p>åŒçº¿æ€§è¿‡æ»¤æ–¹æ³•åœ¨åƒç´ å¯†åº¦å°äºæ˜¾ç¤ºåƒç´ å¯†åº¦æ—¶æœ‰æ•ˆï¼Œå› æ­¤å½“æ”¾å¤§çº¹ç†æ—¶ã€‚ç»“æœä¼šçœ‹èµ·æ¥å¾ˆæ¨¡ç³Šã€‚ å½“ç¼©å°çº¹ç†æ—¶ï¼Œå‡ ä¹ä¸èµ·ä½œç”¨ã€‚ ç›¸é‚»çš„æ˜¾ç¤ºåƒç´ æœ€ç»ˆä¼šå¾—åˆ°ç›¸è·è¶…è¿‡ä¸€ä¸ªåƒç´ çš„æ ·æœ¬ã€‚ è¿™æ„å‘³ç€å°†è·³è¿‡éƒ¨åˆ†çº¹ç†ï¼Œè¿™å°†å¯¼è‡´ç²—ç³™çš„è¿‡æ¸¡ï¼Œå°±åƒå›¾åƒè¢«é”åŒ–ä¸€æ ·ã€‚</p><p>åŒçº¿æ€§è¿‡æ»¤é—®é¢˜çš„è§£å†³æ–¹æ¡ˆæ˜¯åœ¨åƒç´ å¯†åº¦å˜å¾—å¤ªé«˜æ—¶ä½¿ç”¨è¾ƒå°çš„çº¹ç†ã€‚ æ˜¾ç¤ºå±ä¸Šå‡ºç°çš„çº¹ç†è¶Šå°ï¼Œåº”ä½¿ç”¨çš„ç‰ˆæœ¬è¶Šå°ã€‚ è¿™äº›è¾ƒå°çš„ç‰ˆæœ¬ç§°ä¸º mipmapï¼Œunityä¼šè‡ªåŠ¨ä¸ºæ‚¨ç”Ÿæˆã€‚ æ¯ä¸ªè¿ç»­çš„ mipmap çš„å®½åº¦å’Œé«˜åº¦éƒ½æ˜¯ä¸Šä¸€å±‚çš„ä¸€åŠã€‚ æ‰€ä»¥å½“åŸå§‹çº¹ç†å¤§å°ä¸º 512x512 æ—¶ï¼Œmip è´´å›¾ä¸º 256x256ã€128x128ã€64x64ã€32x32ã€16x16ã€8x8ã€4x4 å’Œ 2x2ã€‚</p><blockquote class="prompt-tip"><p>mipmap æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>mipmapè¿™ä¸ªè¯æ˜¯ MIP map çš„ç¼©å†™ã€‚ å­—æ¯ MIP ä»£è¡¨æ‹‰ä¸çŸ­è¯­ multum in parvo ï¼Œæ„æ€ æ˜¯ç‹­å°ç©ºé—´ä¸­çš„ä¼—å¤š ã€‚ å®ƒæ˜¯ç”± Lance Williams åœ¨é¦–æ¬¡æè¿° mipmap æŠ€æœ¯æ—¶åˆ›é€ çš„ã€‚</p></blockquote><center class="half"><img id="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender2/bilinear-mips.png" width="410" alt="loading failed, need vpn." /></center> <center class="half"><img id="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender2/no-mips.png" width="410" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>mipmapä¸Šæœ‰ä¸‹æ— .</a></i></center> </font><p>é‚£ä¹ˆåœ¨ä½•æ—¶ä½¿ç”¨å“ªä¸ªmipmapçº§åˆ«ï¼Œå®ƒä»¬çœ‹èµ·æ¥æœ‰ä»€ä¹ˆä¸åŒå‘¢ï¼Ÿ å…ˆé€šè¿‡åœ¨é«˜çº§çº¹ç†è®¾ç½®ä¸­å¯ç”¨Fadeout Mip Mapsã€‚å¯ç”¨ä¸€ä¸ªæ·¡å…¥æ·¡å‡ºèŒƒå›´åï¼Œinspectorå°†æ˜¾ç¤ºæ»‘å—ã€‚å®ƒå®šä¹‰äº†ä¸€ä¸ªmipmapèŒƒå›´ï¼Œåœ¨è¯¥èŒƒå›´å†… mipmap å°†è½¬æ¢ä¸ºçº¯ç°è‰²ã€‚ è¶Šå‘å³æ»‘åŠ¨è¿‡æ¸¡çº§åˆ«è¶Šå°ã€‚</p><center class="half"><img id="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender2/mip-3.png" width="410" alt="loading failed, need vpn." /></center> <center class="half"><img id="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender2/mip-4.png" width="410" alt="loading failed, need vpn." /></center> <center class="half"><img id="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender2/mip-5.png" width="410" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>mipmapè¿‡æ¸¡çº§åˆ«.</a></i></center> </font><p>mipmapè¿‡æ¸¡ä¹‹é—´å‘ˆç°å‡ºæ¨¡ç³Šåˆ°é”åˆ©çš„å¿«é€Ÿï¼Œè¿‡æ¸¡ä¸è‡ªç„¶ã€‚è¿™å¯ä»¥é€šè¿‡å°†è¿‡æ»¤å™¨æ¨¡å¼åˆ‡æ¢ä¸ºTrilinearä¸‰çº¿æ€§ã€‚ è¿™ä¸åŒçº¿æ€§è¿‡æ»¤çš„å·¥ä½œæ–¹å¼ç›¸åŒï¼Œä½†å®ƒæ˜¯<strong>åœ¨ç›¸é‚»çš„mipmapçº§åˆ«ä¹‹é—´è¿›è¡Œæ’å€¼ï¼Œè¿™ä½¿å¾—é‡‡æ ·æˆæœ¬æ›´é«˜</strong>ï¼Œä½†å®ƒå¹³æ»‘äº† mipmap çº§åˆ«ä¹‹é—´çš„è½¬æ¢ã€‚</p><p>å¦ä¸€ç§æœ‰ç”¨çš„æŠ€æœ¯æ˜¯å„å‘å¼‚æ€§è¿‡æ»¤ã€‚ å½“æŠŠAniso Levelè®¾ç½®ä¸º 0 æ—¶ï¼Œçº¹ç†å˜å¾—æ›´åŠ æ¨¡ç³Šã€‚è¿™ä¸mipmap çº§åˆ«çš„é€‰æ‹©æœ‰å…³ã€‚</p><blockquote class="prompt-tip"><p>å„å‘å¼‚æ€§æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ</p><p>ç²—ç•¥åœ°è¯´ï¼Œå½“æŸç‰©åœ¨ä¸åŒæ–¹å‘ä¸Šçœ‹èµ·æ¥ç›¸ä¼¼æ—¶ï¼Œå®ƒå°±æ˜¯å„å‘åŒæ€§çš„ã€‚ ä¾‹å¦‚ï¼Œä¸€ä¸ªæ— ç‰¹å¾çš„ç«‹æ–¹ä½“ã€‚ å¦‚æœä¸æ˜¯è¿™ç§æƒ…å†µï¼Œåˆ™å®ƒæ˜¯å„å‘å¼‚æ€§çš„ã€‚ ä¾‹å¦‚ï¼Œä¸€ä¸ªä¸‰è§’ä½“ï¼Œå› ä¸ºå®ƒçš„çº¹ç†æœç€ä¸€ä¸ªæ–¹å‘è€Œä¸æ˜¯å¦ä¸€ä¸ª æ–¹å‘ã€‚</p></blockquote><p>å½“çº¹ç†ä»¥æŸä¸ªè§’åº¦æŠ•å½±æ—¶ï¼Œç”±äºé€è§†å…³ç³»ï¼Œé€šå¸¸æœ€ç»ˆä¼šå‘ç°å…¶ä¸­ä¸€ä¸ªç»´åº¦æ¯”å¦ä¸€ä¸ªç»´åº¦æ‰­æ›²å¾—æ›´å¤šã€‚ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­æ˜¯å¸¦çº¹ç†çš„åœ°é¢ã€‚åœ¨è¿œå¤„ï¼Œçº¹ç†çš„å‰åç»´åº¦ä¼šæ˜¾å¾—æ¯”å·¦å³ç»´åº¦å°å¾—å¤šã€‚</p><h3 id="aniso-level">Aniso Level</h3><p>é€‰æ‹©å“ªä¸ª mipmap çº§åˆ«åŸºäºæœ€å·®ç»´åº¦ã€‚ å¦‚æœå·®å¼‚å¾ˆå¤§ï¼Œé‚£ä¹ˆä¼šå¾—åˆ°ä¸€ä¸ªåœ¨ä¸€ç»´ä¸Šéå¸¸æ¨¡ç³Šçš„ç»“æœã€‚å„å‘å¼‚æ€§è¿‡æ»¤é€šè¿‡è§£è€¦ç»´åº¦æ¥ç¼“è§£è¿™ç§æƒ…å†µã€‚é™¤äº†ç»Ÿä¸€ç¼©å°çº¹ç†å¤–ï¼Œå®ƒè¿˜æä¾›åœ¨ä»»ä¸€ç»´åº¦ä¸Šç¼©æ”¾ä¸åŒæ•°é‡çš„ç‰ˆæœ¬ã€‚ å› æ­¤ï¼Œæ‚¨ä¸ä»…æœ‰ 256x256 çš„ mipmapï¼Œè€Œä¸”è¿˜æœ‰ 256x128ã€256x64 ç­‰çš„ mipmapã€‚</p><center class="half"><img id="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender2/without-aniso.png" width="410" alt="loading failed, need vpn." /></center> <center class="half"><img id="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender2/with-aniso.png" width="410" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>æ²¡æœ‰å’Œæœ‰Aniso Level.</a></i></center> </font><blockquote class="prompt-warning"><p>è¯·æ³¨æ„ï¼Œè¿™äº›é¢å¤–çš„ mipmap ä¸åƒå¸¸è§„ mipmap é‚£æ ·é¢„å…ˆç”Ÿæˆã€‚ ç›¸åï¼Œå®ƒä»¬æ˜¯é€šè¿‡æ‰§è¡Œé¢å¤–çš„çº¹ç†æ ·æœ¬æ¥æ¨¡æ‹Ÿçš„ã€‚ å› æ­¤å®ƒä»¬ä¸éœ€è¦æ›´å¤šç©ºé—´ï¼Œä½†é‡‡æ ·æˆæœ¬æ›´é«˜ã€‚</p></blockquote><center class="half"><img id="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender2/aniso-mip.png" width="350" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>å„å‘å¼‚æ€§åŒçº¿æ€§è¿‡æ»¤ï¼Œè¿‡æ¸¡åˆ°ç°è‰².</a></i></center> </font><p>å„å‘å¼‚æ€§è¿‡æ»¤çš„æ·±åº¦ç”± Aniso Level æ§åˆ¶ã€‚ ä¸º 0 æ—¶ï¼Œå®ƒè¢«ç¦ç”¨ã€‚ ä¸º 1 æ—¶ï¼Œå®ƒå˜ä¸ºå¯ç”¨å¹¶æä¾›æœ€å°çš„æ•ˆæœã€‚ 16è¾¾åˆ°æœ€å¤§å€¼ã€‚ ä½†æ˜¯ï¼Œè¿™äº›è®¾ç½®ä¼šå—åˆ°é¡¹ç›®è´¨é‡è®¾ç½®çš„å½±å“ã€‚ å¯ä»¥é€šè¿‡ Edit / Project Settings / Quality è®¿é—®è´¨é‡è®¾ç½®ã€‚ æ‰¾åˆ° å„å‘å¼‚æ€§çº¹ç† é¡¹ç›®è®¾ç½®</p><center class="half"><img id="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender2/rendering-quality.png" width="300" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>æ¸²æŸ“è´¨é‡è®¾ç½®.</a></i></center> </font><p>é¡¹ç›®è®¾ç½®ç¦ç”¨å„å‘å¼‚æ€§çº¹ç†æ—¶ï¼Œæ— è®ºçº¹ç†è®¾ç½®å¦‚ä½•ï¼Œéƒ½ä¸ä¼šå‘ç”Ÿå„å‘å¼‚æ€§è¿‡æ»¤ã€‚å½“å®ƒè®¾ç½®ä¸º Per Textureæ—¶ï¼Œå®ƒâ€‹â€‹å®Œå…¨ç”±çº¹ç†è‡ªèº«è®¾ç½®æ§åˆ¶ã€‚ä¹Ÿå¯ä»¥è®¾ç½®ä¸º Forced On ï¼Œå¼ºåˆ¶æŠŠæ¯ä¸ªçº¹ç†éƒ½å¼€å¯Ansio Levelï¼Œä½†æ˜¯è‹¥çº¹ç†è®¾ç½®Aniso Levelä¸º0ï¼Œä»ç„¶ä¸ä¼šä½¿ç”¨å„å‘å¼‚æ€§è¿‡æ»¤ã€‚</p></article><hr><div class='like-post'> <a style="color:rgb(112, 40, 85);" id="likeBtn" onclick="likePost(1);"> <i class="fa fa-thumbs-o-up fa-2x" aria-hidden="true"></i> </a> <span id="likeNum">0</span><div class="text-xs text-slate-500 mx-2">çœŸè¯šç‚¹èµï¼Œæ‰‹ç•™ä½™é¦™</div></div><h2 id="similar_posts">Similar Posts</h2><ul><li class="relatedPost"> <a href="/2024/07/10/Unity_Addressable_Editor/">Unity Addressable Editorç»“æ„ </a><li class="relatedPost"> <a href="/2018/01/25/Unity_Parallax_Normals_Heightmap/">è§†å·®å’Œæ³•çº¿ã€é«˜åº¦å›¾å›é¡¾(ç¿»è¯‘äºŒå) </a><li class="relatedPost"> <a href="/2018/01/24/Unity_GPU_Instance/">Unity GPU Instance(ç¿»è¯‘åä¹) </a><li class="relatedPost"> <a href="/2018/01/23/Unity_RealTime_GI_LOD/">Unity å®æ—¶ GI & LPPV & LOD(ç¿»è¯‘åå…«) </a><li class="relatedPost"> <a href="/2018/01/21/Unity_Mix_Lighting/">Unity æ··åˆå…‰ç…§(ç¿»è¯‘åä¸ƒ) </a><li class="relatedPost"> <a href="/2018/01/19/Unity_Static_Lightting/">Unity å…‰ç…§çƒ˜ç„™(ç¿»è¯‘åå…­) </a></ul><div class="post-recent"><div class="pre"><p><strong>ä¸Šä¸€ç¯‡</strong> <a href="/2018/01/01/Unity_Matrix_Transform/">Unity åŸºæœ¬çŸ©é˜µ(ç¿»è¯‘ä¸€)</a></p></div><div class="nex"><p><strong>ä¸‹ä¸€ç¯‡</strong> <a href="/2018/01/02/Unity_Combine_Texture/">Unity å¤šçº¹ç†èåˆ(ç¿»è¯‘ä¸‰)</a></p></div></div><h2 id="comments">Comments</h2><div id="vcomments"></div><script type="text/javascript"> /*è¯„è®ºç›¸å…³*/ function delayLoadValine() { new Valine({ el: '#vcomments', verify: "true", notify: "false", app_id: "JgYk2pcFa3QxhhWPhDjjoPvv-MdYXbMMI", app_key: "fjDLTSUgCNGrSKgCID672IJx", avatar: "monsterid", placeholder: "æ¬¢è¿è¯„è®ºï¼", pageSize: "10 || 10", master: "b5586e582cb181c6b0fc8b2ce828bd50", tagMeta: ["åšä¸»","å°ä¼™ä¼´","è®¿å®¢"], enableQQ: true, requiredFields: [], serverURLs: "https://leanapi.damonc.top", recordIP: "true", visitor: "true", }); $(document).ready(function(){ fetch('https://v1.hitokoto.cn/') .then(response => response.json()) .then(data => { document.getElementById("veditor").setAttribute( "placeholder", data.hitokoto+"â€”"+data.from ); setTimeout(() => { addPostVisitedTimes(); }, 1000); } ) .catch(console.error); }); } /*ç‚¹èµç›¸å…³*/ var curIpVisitRecord = null; var curPost = null; var curUrl = "https://www.damonc.top/2018/01/02/Unity_Shader_Fundamentals/"; function getVisitorIpAndJudge() { $.getJSON('https://api.ipify.org?format=json', function(data){ saveOrUpdateIpRecord(data.ip) }); } function saveOrUpdateIpRecord(ip) { var Visitor = AV.Object.extend("visitors_record"); var post_url = curUrl; var query = new AV.Query(Visitor); query.equalTo("visitor_ip", ip); query.equalTo("post_url", post_url); query.find().then(function(results) { if (results.length > 0) { /* if(window.console){ console.log('è¯¥IPå·²è®¿é—®è¿‡è¯¥æ–‡ç« '); }*/ curIpVisitRecord = results[0]; updateIpRecord(); refreshLikeBtn(); } else { /*if(window.console){ console.log('è¯¥IPç¬¬ä¸€æ¬¡è®¿é—®è¯¥æ–‡ç« ï¼Œä¿å­˜æ–°çš„è®¿é—®è®°å½•ï¼Œå¹¶å¢åŠ è®¿é—®æ¬¡æ•°'); }*/ addNewIpRecord(ip, post_url); } }, function(error) { addPostVisitedTimes(); }); } function addPostVisitedTimes() { var AV_Posts = AV.Object.extend("Posts"); var url = curUrl; var title = "Unity Shader åŸºæœ¬è¯­æ³•(ç¿»è¯‘äºŒ)"; var query = new AV.Query(AV_Posts); query.equalTo("post_url", url); query.find().then(function(results) { if (results.length > 0) { curPost = results[0]; curPost.increment("visited_times"); curPost.save(); loadLikeNums(); } else { curPost = new AV_Posts(); /* Set ACL */ var acl = new AV.ACL(); acl.setPublicReadAccess(true); acl.setPublicWriteAccess(true); curPost.setACL(acl); /* End Set ACL */ curPost.set("post_title", title); curPost.set("post_url", url); curPost.set("visited_times", 1); curPost.set('like_times', 0); curPost.save(); } getVisitorIpAndJudge(); }, function(error) { console.log('Error:' + error.code + " " + error.message); }); } function showPostVisitedTimes() { var AV_Posts = AV.Object.extend("Posts"); var $visitors = $(".leancloud_visitors"); var url = $visitors.attr('id').trim(); var title = $visitors.attr('data-flag-title').trim(); var query = new AV.Query(AV_Posts); query.equalTo("post_url", url); query.find().then(function(results) { if (results.length > 0) { curPost = results[0]; loadLikeNums(); } else { /*if(window.console){ console.log('å¼‚å¸¸æƒ…å†µï¼Œä¸åº”è¯¥æ²¡è®°å½•çš„'); }*/ } }, function(error) { console.log('Error:' + error.code + " " + error.message); }); } function updateIpRecord(){ var lastTime = curIpVisitRecord.updatedAt; var curTime = new Date(); var timePassed = curTime.getTime() - lastTime.getTime(); if(timePassed > 300000) { /*if(window.console){ console.log('è·ç¦»è¯¥IPä¸Šä¸€æ¬¡è®¿é—®è¯¥æ–‡ç« å·²è¶…è¿‡äº†5åˆ†é’Ÿï¼Œæ›´æ–°è®¿é—®è®°å½•ï¼Œå¹¶å¢åŠ è®¿é—®æ¬¡æ•°'); }*/ addPostVisitedTimes(); curIpVisitRecord.save(); } else { /*console.log('è¿™æ˜¯è¯¥IP 1åˆ†é’Ÿå†…é‡å¤è®¿é—®è¯¥æ–‡ç« ï¼Œä¸æ›´æ–°è®¿é—®è®°å½•ï¼Œä¸å¢åŠ è®¿é—®æ¬¡æ•°');*/ } } function addNewIpRecord(ip, post_url){ var Visitor = AV.Object.extend("visitors_record"); curIpVisitRecord = new Visitor(); /* Set ACL */ var acl = new AV.ACL(); acl.setPublicReadAccess(true); acl.setPublicWriteAccess(true); curIpVisitRecord.setACL(acl); curIpVisitRecord.set("visitor_ip", ip); curIpVisitRecord.set("post_url", post_url); curIpVisitRecord.set("like_this_post", 0); curIpVisitRecord.save(); } function loadLikeNums() { var likeTimes = curPost.get('like_times'); $("#likeNum").text(likeTimes); } function refreshLikeBtn() { var likeState = curIpVisitRecord.get('like_this_post'); if(likeState == 1){ $("#likeBtn").css("color", "red"); $("#likeBtn").attr("onclick", "likePost(-1)"); } else { $("#likeBtn").css("color", "rgb(112, 40, 85)"); $("#likeBtn").attr("onclick", "likePost(1)"); } loadLikeNums(); } function likePost(type) { if(curPost == null || curIpVisitRecord == null) { alert('å»¶è¿Ÿ10såæ‰èƒ½ç‚¹èµ, è¯·ç¨ç­‰...'); return } var newNum; var getlikeTime = curPost.get('like_times'); if(typeof getlikeTime == "undefined" || getlikeTime == null || getlikeTime == "") { newNum = parseInt(type); }else{ newNum = parseInt(type) + parseInt(getlikeTime); } curPost.set('like_times', newNum); curPost.save().then(function(curPost){ var likeThisPost = type == -1 ? 0 : 1; curIpVisitRecord.set("like_this_post", likeThisPost); curIpVisitRecord.save().then(function(){ refreshLikeBtn(); }); },function(error){ console.log('Failed to create visitor record, with error message: ' + error.message); }); } /*å¯åŠ¨æ‰§è¡Œ*/ setTimeout(() => { delayLoadValine(); }, 10000); </script></div></div><script> /** * target _blank */ (function() { var aTags = document.querySelectorAll('article a:not([id])'); for (var i = 0; i < aTags.length; i++) { var htps = aTags[i].href; if (htps.startsWith("https://")) aTags[i].setAttribute('target', '_blank'); } }()); </script> <script src="/js/pageContent.js " charset="utf-8"></script><footer class="site-footer"><div class="wrapper"><p class="description"> äº‘ä¸Šçš„æ—¥å­!</p><p class="contact"> <a href="https://github.com/bitfeng" title="GitHub"><i class="fa fa-github" aria-hidden="true"></i></a> <a href="mailto:damonc@126.com" title="email"><i class="fa fa-envelope-o" aria-hidden="true"></i></a></p><p> æœ¬ç«™æ€»è®¿é—®é‡<span id="busuanzi_value_site_pv"></span>æ¬¡ï¼Œæœ¬ç«™è®¿å®¢æ•°<span id="busuanzi_value_site_uv"></span>äººæ¬¡ï¼Œæœ¬æ–‡æ€»é˜…è¯»é‡<span id="busuanzi_value_page_pv"></span>æ¬¡</p></div></footer><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="back-to-top"> <a href="#top" data-scroll> <i class="fa fa-arrow-up" aria-hidden="true"></i> </a></div><script src=" /js/main.js " charset="utf-8"></script> <script src=" /js/smooth-scroll.min.js " charset="utf-8"></script> <script type="text/javascript"> smoothScroll.init({ speed: 500, easing: 'easeInOutCubic', offset: 20, }); function displayWindowSize() { var w = document.documentElement.clientWidth; var h = document.documentElement.clientHeight; var rightDiv = document.querySelector('.right'); var footer = document.querySelector('.site-footer'); if(!rightDiv || !footer){ return; } if(w <= 1700){ rightDiv.style.display='none'; footer.style.display='none'; }else{ rightDiv.style.display='block'; footer.style.display = "block"; } } window.addEventListener("resize", displayWindowSize); displayWindowSize(); </script><meta name="viewport" content="width=device-width, initial-scale=1.0"><div id="myModal" class="modal" onclick="closeModal()"> <span class="modal-content"> <img id="modalImg" src="" alt="Modal Image"><div class="prev-div" onclick="prevImage()" ><button class="btn-s prev-btn"></button></div><div class="next-div" onclick="nextImage()" ><button class="btn-s next-btn"></button></div></span></div><script> var images = document.getElementsByTagName("img"); var currentImageIndex = 0; /*ä¸ºæ¯ä¸ªå›¾ç‰‡æ ‡ç­¾æ·»åŠ ç‚¹å‡»äº‹ä»¶*/ for (var i = 0; i < images.length; i++) { if(images[i].id.startsWith("fit-picture")){ images[i].onclick = function () { openModal(this); }; } } /*æ‰“å¼€æ¨¡æ€æ¡†å¹¶æ˜¾ç¤ºæ”¾å¤§çš„å›¾ç‰‡*/ function openModal(img) { console.log(img.src); var modal = document.getElementById("myModal"); var modalImg = document.getElementById("modalImg"); modal.style.display = "block"; modalImg.src = img.src; } /*å…³é—­æ¨¡æ€æ¡†*/ function closeModal() { var modal = document.getElementById("myModal"); modal.style.display = "none"; } /*ä¸Šä¸€å¼ å›¾ç‰‡*/ function prevImage() { event.stopPropagation(); /*é˜»æ­¢äº‹ä»¶å†’æ³¡*/ currentImageIndex--; if (currentImageIndex < 0) { currentImageIndex = images.length - 1; } var modalImg = document.getElementById("modalImg"); modalImg.src = images[currentImageIndex].src; } /*ä¸‹ä¸€å¼ å›¾ç‰‡*/ function nextImage() { event.stopPropagation(); /*é˜»æ­¢äº‹ä»¶å†’æ³¡*/ currentImageIndex++; if (currentImageIndex >= images.length) { currentImageIndex = 0; } var modalImg = document.getElementById("modalImg"); modalImg.src = images[currentImageIndex].src; } </script>
