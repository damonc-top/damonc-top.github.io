<!DOCTYPE html><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="baidu-site-verification" content="code-BGVivWGmxV" /><title>Unity Shader GUI æ‰©å±•ä¸€(ç¿»è¯‘ä¹)</title><meta name="description" content="æœ¬ç¯‡æ‘˜è¦: è‡ªå®šä¹‰Shader GUIé¢æ¿æ‹“å±• æ··åˆé‡‘å±ä¸éé‡‘å±æ•ˆæœ éå‡åŒ€å¹³æ»‘ è¡¨é¢è‡ªå‘å…‰"><link rel="shortcut icon" href="/favicon.ico?" type="image/x-icon"><link rel="icon" href="/favicon.ico?" type="image/x-icon"><link rel="stylesheet" href="/css/main.css "><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"><link rel="stylesheet" href=" /css/font_8v3czwksspqlg14i.css "><link rel="canonical" href="https://www.damonc.top/2018/01/07/Unity_ShaderGUI_Extension_1/"><link rel="alternate" type="application/rss+xml" title="çˆ±ç©¿æ‹–é‹" href="https://www.damonc.top/feed.xml "> <script src=" /js/Valine.min.js " charset="utf-8"></script> <script src=" /js/jquery_3_2_0.min.js " charset="utf-8"></script> <script> var _hmt = _hmt || []; (function() { var hm = document.createElement("script"); hm.src = "//hm.baidu.com/hm.js?f7f1a5967e3927ea98597632f0a17ad9"; var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s); })(); </script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script async src="https://cdnjs.cloudflare.com/ajax/libs/js-polyfills/0.1.43/polyfill.min.js?features=es6"></script> <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><body class="custom-background"><header id="top"><div class="wrapper"> <a href="/" class="brand">çˆ±ç©¿æ‹–é‹</a> <small>è‡ªç”±è‡ªåœ¨ğŸ©´</small> <button id="headerMenu" class="menu"><i class="fa fa-bars"></i></button><nav id="headerNav"><ul><li> <a href="/"> <i class="fa fa-home"></i>Home </a><li> <a href="/archive/"> <i class="fa fa-archive"></i>å½’æ¡£ </a><li> <a href="/category/"> <i class="fa fa-th-list"></i>åˆ†ç±» </a><li> <a href="/tag/"> <i class="fa fa-tags"></i>æ ‡ç­¾ </a><li> <a href="/collection/"> <i class="fa fa-bookmark"></i>æ”¶é›† </a><li> <a href="/demo/"> <i class="fa fa-play"></i>å·¥å…· </a><li> <a href="/about/"> <i class="fa fa-heart"></i>About </a></ul></nav></div></header><div class="home-right-bar"> <button class="anchor"><i class="fa fa-anchor"></i></button><div class="right"><div class="wrap"><div class="side content"><div> ç›®å½•</div><ul id="content-side" class="content-ul"><li><a href="#comments">Comments</a></ul></div></div></div></div><div class="page clearfix" post><div class="left"><h1>Unity Shader GUI æ‰©å±•ä¸€(ç¿»è¯‘ä¹)</h1><div class="label"><div class="label-card"> <i class="fa fa-calendar"></i>2018-01-07</div><div class="label-card"> <i class="fa fa-user"></i>catlikecoding</div><div class="label-card"></div><div class="label-card"> <span class="categories"> <i class="fa fa-th-list"></i> <a href="/category/#ç¿»è¯‘" title="Category: ç¿»è¯‘" rel="category">ç¿»è¯‘</a> </span></div><div class="label-card"> <span class="pageTag"> <i class="fa fa-tags"></i> <b href="/tag/#Shader" title="Tag: Shader" rel="tag">Shader</b>&nbsp; <b href="/tag/#Unity3d" title="Tag: Unity3d" rel="tag">Unity3d</b> </span></div></div><hr><article itemscope itemtype="http://schema.org/BlogPosting"><ul id="markdown-toc"><li><a href="#è‡ªå®šä¹‰ç•Œé¢" id="markdown-toc-è‡ªå®šä¹‰ç•Œé¢">è‡ªå®šä¹‰ç•Œé¢</a><ul><li><a href="#shadergui-æ‹“å±•" id="markdown-toc-shadergui-æ‹“å±•">ShaderGUI æ‹“å±•</a><li><a href="#åˆ›å»ºæ–‡æœ¬" id="markdown-toc-åˆ›å»ºæ–‡æœ¬">åˆ›å»ºæ–‡æœ¬</a><li><a href="#æ˜¾ç¤ºalbedoçº¹ç†å±æ€§" id="markdown-toc-æ˜¾ç¤ºalbedoçº¹ç†å±æ€§">æ˜¾ç¤ºAlbedoçº¹ç†å±æ€§</a><li><a href="#æ˜¾ç¤ºnormalçº¹ç†å±æ€§" id="markdown-toc-æ˜¾ç¤ºnormalçº¹ç†å±æ€§">æ˜¾ç¤ºNormalçº¹ç†å±æ€§</a><li><a href="#æ˜¾ç¤ºé‡‘å±å’Œå¹³æ»‘å€¼å±æ€§" id="markdown-toc-æ˜¾ç¤ºé‡‘å±å’Œå¹³æ»‘å€¼å±æ€§">æ˜¾ç¤ºé‡‘å±å’Œå¹³æ»‘å€¼å±æ€§</a><li><a href="#æ˜¾ç¤ºç¬¬äºŒç»†èŠ‚çº¹ç†" id="markdown-toc-æ˜¾ç¤ºç¬¬äºŒç»†èŠ‚çº¹ç†">æ˜¾ç¤ºç¬¬äºŒç»†èŠ‚çº¹ç†</a></ul><li><a href="#é‡‘å±çº¹ç†" id="markdown-toc-é‡‘å±çº¹ç†">é‡‘å±çº¹ç†</a><ul><li><a href="#ä½¿ç”¨metallic-çº¹ç†" id="markdown-toc-ä½¿ç”¨metallic-çº¹ç†">ä½¿ç”¨Metallic çº¹ç†</a><li><a href="#å®šä¹‰metallicçš„shaderå…³é”®å­—" id="markdown-toc-å®šä¹‰metallicçš„shaderå…³é”®å­—">å®šä¹‰Metallicçš„Shaderå…³é”®å­—</a><li><a href="#25-æ‰“å¼€debugæ¨¡å¼æŸ¥çœ‹" id="markdown-toc-25-æ‰“å¼€debugæ¨¡å¼æŸ¥çœ‹"><code class="language-plaintext highlighter-rouge">2.5 æ‰“å¼€Debugæ¨¡å¼æŸ¥çœ‹</code></a><li><a href="#ä½¿ç”¨è‡ªå®šä¹‰keywordfeatures" id="markdown-toc-ä½¿ç”¨è‡ªå®šä¹‰keywordfeatures">ä½¿ç”¨è‡ªå®šä¹‰Keyword(Features)</a><li><a href="#changecheckæ£€æŸ¥" id="markdown-toc-changecheckæ£€æŸ¥">ChangeCheckæ£€æŸ¥</a><li><a href="#å…‰æ»‘çº¹ç†" id="markdown-toc-å…‰æ»‘çº¹ç†">å…‰æ»‘çº¹ç†</a><li><a href="#albedoä¸smoothnessç»“åˆ" id="markdown-toc-albedoä¸smoothnessç»“åˆ">Albedoä¸smoothnessç»“åˆ</a><li><a href="#å…³é”®å­—é€‰æ‹©" id="markdown-toc-å…³é”®å­—é€‰æ‹©">å…³é”®å­—é€‰æ‹©</a><li><a href="#smoothnesså˜ä½“ä½¿ç”¨" id="markdown-toc-smoothnesså˜ä½“ä½¿ç”¨">Smoothnesså˜ä½“ä½¿ç”¨</a><li><a href="#æŸ¥çœ‹smoothness_albedo" id="markdown-toc-æŸ¥çœ‹smoothness_albedo">æŸ¥çœ‹Smoothness_Albedo</a></ul><li><a href="#è‡ªå‘å…‰" id="markdown-toc-è‡ªå‘å…‰">è‡ªå‘å…‰</a><ul><li><a href="#hdr-emission" id="markdown-toc-hdr-emission">HDR Emission</a></ul></ul><p>æœ¬ç¯‡æ‘˜è¦:</p><ul><li>è‡ªå®šä¹‰Shader GUIé¢æ¿æ‹“å±•<li>æ··åˆé‡‘å±ä¸éé‡‘å±æ•ˆæœ<li>éå‡åŒ€å¹³æ»‘<li>è¡¨é¢è‡ªå‘å…‰</ul><h2 id="è‡ªå®šä¹‰ç•Œé¢">è‡ªå®šä¹‰ç•Œé¢</h2><p>è‡ªå®šä¹‰Shaderç•Œé¢åŠŸèƒ½ï¼Œä¸è‡ªå®šä¹‰GUIé¢æ¿ç±»ä¼¼ï¼ŒåŒºåˆ«åœ¨äºé‡å®ç°å‡½æ•°ä¸åŒã€‚</p><center class="half"><img class="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender9/1692664-20200226004456780-2000794299.png" width="250" alt="loading failed, need vpn." /> <img class="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender9/1692664-20200226004457603-105186520.png" width="250" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>myLightingShader vs standard.</a></i></center> </font><h3 id="shadergui-æ‹“å±•">ShaderGUI æ‹“å±•</h3><p>åˆ›å»ºä¸€è„šæœ¬ç»§æ‰¿UnityEditor.ShaderGUIï¼Œè„šæœ¬æ”¾å…¥Editoræ–‡ä»¶å¤¹ä¸‹</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">UnityEngine</span><span class="p">;</span>

<span class="k">namespace</span>  <span class="nn">GUIExtension</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">MyCustomShaderGUI</span> <span class="p">:</span> <span class="n">UnityEditor</span><span class="p">.</span><span class="n">ShaderGUI</span>
    <span class="p">{</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div><p>åŒæ—¶åœ¨éœ€è¦ä¿®æ”¹é¢æ¿ç•Œé¢çš„Shaderæ–‡ä»¶å†…ï¼Œå¼•ç”¨è¯¥ç±»æ–‡ä»¶ã€‚<strong>æ³¨æ„å‘½åç©ºé—´ä¹Ÿè¦å¸¦ä¸Š</strong></p><div class="language-hlsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Shader</span> <span class="s">"Custom/Custom/Shader_GUIExtension"</span>
<span class="p">{</span>
    <span class="n">SubShader</span><span class="p">{}</span>
    <span class="n">SubShader</span><span class="p">{}</span>
    <span class="n">SubShader</span><span class="p">{}</span>
    <span class="c1">//åªèƒ½æ”¾åœ¨æ‰€æœ‰SubShaderæœ€åè°ƒç”¨</span>
    <span class="n">CustomEditor</span> <span class="s">"GUIExtension.MyCustomShaderGUI"</span>
<span class="p">}</span>
</code></pre></div></div><p>åŒæ—¶å†æ¬¡æŸ¥çœ‹ShaderGUIæœ‰å“ªäº›è™šå‡½æ•°å¯ä¾›é‡å†™ã€‚</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">UnityEngine</span><span class="p">;</span>
<span class="k">namespace</span> <span class="nn">UnityEditor</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">abstract</span> <span class="k">class</span> <span class="nc">ShaderGUI</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="nf">ShaderGUI</span><span class="p">();</span>

        <span class="c1">// å‚æ•°:</span>
        <span class="c1">//   propertyName:Name of the material property.</span>
        <span class="c1">//   properties: OnGUIå‡½æ•°å¼•ç”¨åœ°å€ä¼ é€’.</span>
        <span class="c1">// è¿”å›ç»“æœ: æ²¡æ‰¾åˆ°è¿”å›null.</span>
        <span class="k">protected</span> <span class="k">static</span> <span class="n">MaterialProperty</span> <span class="nf">FindProperty</span><span class="p">(</span><span class="kt">string</span> <span class="n">propertyName</span><span class="p">,</span> <span class="n">MaterialProperty</span><span class="p">[]</span> <span class="n">properties</span><span class="p">);</span>

        <span class="c1">// å‚æ•°:</span>
        <span class="c1">//   propertyName:Name of the material property.</span>
        <span class="c1">//   properties:The array of available properties.</span>
        <span class="c1">//   propertyIsMandatory:å€¼trueä¸”æ²¡æœ‰æ‰¾åˆ°å¯¹åº”propertyå°±æŠ›å‡ºå¼‚å¸¸</span>
        <span class="c1">// è¿”å›ç»“æœ:åŒä¸Š</span>
        <span class="k">protected</span> <span class="k">static</span> <span class="n">MaterialProperty</span> <span class="nf">FindProperty</span><span class="p">(</span><span class="kt">string</span> <span class="n">propertyName</span><span class="p">,</span> <span class="n">MaterialProperty</span><span class="p">[]</span> <span class="n">properties</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">propertyIsMandatory</span><span class="p">);</span>

        <span class="c1">// æ‘˜è¦:ç»™è¿™ä¸ªæè´¨é€‰ä¸€ä¸ªæ–°shaderæ—¶çš„å›è°ƒ</span>
        <span class="k">public</span> <span class="k">virtual</span> <span class="k">void</span> <span class="nf">AssignNewShaderToMaterial</span><span class="p">(</span><span class="n">Material</span> <span class="n">material</span><span class="p">,</span> <span class="n">Shader</span> <span class="n">oldShader</span><span class="p">,</span> <span class="n">Shader</span> <span class="n">newShader</span><span class="p">);</span>

        <span class="c1">// å‚æ•°:</span>
        <span class="c1">//   materialEditor:å½“å‰æè´¨é¢æ¿</span>
        <span class="c1">//   properties:å½“å‰é€‰ä¸­çš„shaderæ‰€æœ‰properties.</span>
        <span class="k">public</span> <span class="k">virtual</span> <span class="k">void</span> <span class="nf">OnGUI</span><span class="p">(</span><span class="n">MaterialEditor</span> <span class="n">materialEditor</span><span class="p">,</span> <span class="n">MaterialProperty</span><span class="p">[]</span> <span class="n">properties</span><span class="p">);</span>

        <span class="k">public</span> <span class="k">virtual</span> <span class="k">void</span> <span class="nf">OnMaterialInteractivePreviewGUI</span><span class="p">(</span><span class="n">MaterialEditor</span> <span class="n">materialEditor</span><span class="p">,</span> <span class="n">Rect</span> <span class="n">r</span><span class="p">,</span> <span class="n">GUIStyle</span> <span class="n">background</span><span class="p">);</span>

        <span class="c1">//é¢„è§ˆ</span>
        <span class="k">public</span> <span class="k">virtual</span> <span class="k">void</span> <span class="nf">OnMaterialPreviewGUI</span><span class="p">(</span><span class="n">MaterialEditor</span> <span class="n">materialEditor</span><span class="p">,</span> <span class="n">Rect</span> <span class="n">r</span><span class="p">,</span> <span class="n">GUIStyle</span> <span class="n">background</span><span class="p">);</span>

        <span class="c1">//é¢„è§ˆ</span>
        <span class="k">public</span> <span class="k">virtual</span> <span class="k">void</span> <span class="nf">OnMaterialPreviewSettingsGUI</span><span class="p">(</span><span class="n">MaterialEditor</span> <span class="n">materialEditor</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div><p>ç¬¬ä¸€ä¸ªé‡å®ç°å‡½æ•°å°±æ˜¯ï¼šOnGUI</p><h3 id="åˆ›å»ºæ–‡æœ¬">åˆ›å»ºæ–‡æœ¬</h3><p>åˆ›å»ºæ–‡æœ¬ä¸GUIæ‹“å±•åˆ›å»ºæ–‡æœ¬ç±»ä¼¼ï¼Œç»Ÿä¸€ä½¿ç”¨GUILayout</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">OnGUI</span><span class="p">(</span><span class="n">MaterialEditor</span> <span class="n">materialEditor</span><span class="p">,</span> <span class="n">MaterialProperty</span><span class="p">[]</span> <span class="n">properties</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nf">DoMain</span><span class="p">();</span>
<span class="p">}</span>
<span class="k">void</span> <span class="nf">DoMain</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">GUILayout</span><span class="p">.</span><span class="nf">Label</span><span class="p">(</span><span class="s">"Main Map"</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div><center class="half"><img class="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender9/1692664-20200226004458272-1265628530.png" width="250" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>label æ¼”ç¤º.</a></i></center> </font><p>GUILayout.Labelæœ‰å¤šä¸ªé‡è½½å‡½æ•°ï¼Œå¯ä»¥ä¸ºæ–‡å­—æŒ‡å®šå„ç§é¢œè‰²ã€å­—ä½“ã€æ ¼å¼ç­‰æ•ˆæœã€‚</p><center class="half"><img class="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender9/1692664-20200226004458977-299092951.png" width="250" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>æ–‡å­—æ•ˆæœ.</a></i></center> </font><h3 id="æ˜¾ç¤ºalbedoçº¹ç†å±æ€§">æ˜¾ç¤ºAlbedoçº¹ç†å±æ€§</h3><p>é€‰ä¸­å½“å‰æè´¨åï¼Œè‹¥æè´¨ä½¿ç”¨çš„Shaderè°ƒç”¨äº†GUIæ‹“å±•ï¼Œåˆ™ä¼šè‡ªåŠ¨è¯»å–è¯¥Shaderçš„æ‰€æœ‰å±æ€§ã€‚é€šè¿‡é‡å®ç°OnGUIå‡½æ•°åï¼Œè·å–å…¶å‚æ•°åœ°å€å°±èƒ½è¯»å–ã€‚</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">MaterialEditor</span> <span class="n">MaterialEditor</span><span class="p">;</span>
<span class="n">MaterialProperty</span><span class="p">[]</span> <span class="n">materialProperties</span><span class="p">;</span>
<span class="c1">//MaterialEditoræ˜¯é¢æ¿å®ä¾‹</span>
<span class="c1">//è¯¥shaderæ‰€æœ‰properties</span>
<span class="k">public</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">OnGUI</span><span class="p">(</span><span class="n">MaterialEditor</span> <span class="n">materialEditor</span><span class="p">,</span> <span class="n">MaterialProperty</span><span class="p">[]</span> <span class="n">properties</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="n">MaterialEditor</span> <span class="p">=</span> <span class="n">materialEditor</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="n">materialProperties</span> <span class="p">=</span> <span class="n">properties</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div><p>æŸ¥æ‰¾Albedoå±æ€§ï¼Œå¹¶å°†å…¶æ˜¾ç¤ºå‡ºæ¥ã€‚Albedoæ˜¯ä¸€ä¸ªTextureçº¹ç†å±æ€§ï¼Œå¯¹åº”ä¸€å¼ çº¹ç†å’Œåç§°æè¿°ï¼Œå¯ä½¿ç”¨FindPropertyå’ŒGUIContentå®¹å™¨</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">void</span> <span class="nf">AlbedoPropertyShow</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">MaterialProperty</span> <span class="n">albedo</span> <span class="p">=</span> <span class="nf">FindProperty</span><span class="p">(</span><span class="s">"_MainTex"</span><span class="p">,</span> <span class="n">materialProperties</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
    <span class="c1">//displayNameæ˜¯shaderå†…æ‰‹å†™å¥½çš„åå­—</span>
    <span class="n">GUIContent</span> <span class="n">content</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">GUIContent</span><span class="p">(</span><span class="n">albedo</span><span class="p">.</span><span class="n">displayName</span><span class="p">,</span> <span class="n">albedo</span><span class="p">.</span><span class="n">textureValue</span><span class="p">,</span> <span class="s">"this is a main texture"</span><span class="p">);</span>
    <span class="n">MaterialEditor</span><span class="p">.</span><span class="nf">TexturePropertySingleLine</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">albedo</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div><center class="half"><img class="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender9/1692664-20200304202307270-1110029737.png" width="250" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>Albedoçº¹ç†ï¼Œtooltip.</a></i></center> </font><p>ç„¶åç»™è¯¥çº¹ç†å¢åŠ è‰²è°ƒTintæ˜¾ç¤º</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">void</span> <span class="nf">AlbedoPropertyShow</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">MaterialProperty</span> <span class="n">albedo</span> <span class="p">=</span> <span class="nf">FindProperty</span><span class="p">(</span><span class="s">"_MainTex"</span><span class="p">,</span> <span class="n">MaterialProperties</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
    <span class="n">MaterialProperty</span> <span class="n">tint</span> <span class="p">=</span> <span class="nf">FindProperty</span><span class="p">(</span><span class="s">"_Tint"</span><span class="p">,</span> <span class="n">MaterialProperties</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
    <span class="c1">//displayNameæ˜¯shaderå†…æ‰‹å†™å¥½çš„åå­—</span>
    <span class="n">GUIContent</span> <span class="n">content</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">GUIContent</span><span class="p">(</span><span class="n">albedo</span><span class="p">.</span><span class="n">displayName</span><span class="p">,</span> <span class="n">albedo</span><span class="p">.</span><span class="n">textureValue</span><span class="p">,</span> <span class="s">"this is a main texture"</span><span class="p">);</span>
    <span class="c1">//é‡è½½å‡½æ•°</span>
    <span class="n">MaterialEditor</span><span class="p">.</span><span class="nf">TexturePropertySingleLine</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">albedo</span><span class="p">,</span> <span class="n">tint</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div><center class="half"><img class="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender9/1692664-20200304202307841-1821560357.png" width="250" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>è‰²è°ƒå’Œåç§».</a></i></center> </font><h3 id="æ˜¾ç¤ºnormalçº¹ç†å±æ€§">æ˜¾ç¤ºNormalçº¹ç†å±æ€§</h3><p>åŒç†ï¼Œæœ‰ä¸€ä¸ªç‚¹åœ¨äºbumpScaleå±æ€§æ˜¾ç¤ºï¼Œå‡å¦‚æ²¡æœ‰æŒ‡å®šçº¹ç†æ—¶å°±ä¸æƒ³æ˜¾ç¤ºBumbScaleå±æ€§ã€‚</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">void</span> <span class="nf">NormalShow</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">MaterialProperty</span> <span class="n">normal</span> <span class="p">=</span> <span class="nf">FindProperty</span><span class="p">(</span><span class="s">"_NormalMap"</span><span class="p">,</span> <span class="n">MaterialProperties</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>

    <span class="c1">//æ²¡æœ‰çº¹ç†æ—¶ä¸æƒ³æ˜¾ç¤ºbumpscale</span>
    <span class="n">MaterialProperty</span> <span class="n">bumpScale</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">normal</span><span class="p">.</span><span class="n">textureValue</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span> <span class="n">bumpScale</span> <span class="p">=</span> <span class="nf">FindProperty</span><span class="p">(</span><span class="s">"_BumpScale"</span><span class="p">,</span> <span class="n">MaterialProperties</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>

    <span class="n">MaterialEditor</span><span class="p">.</span><span class="nf">TexturePropertySingleLine</span><span class="p">(</span><span class="nf">MakeGUIContent</span><span class="p">(</span><span class="n">normal</span><span class="p">),</span> <span class="n">normal</span><span class="p">,</span> <span class="n">bumpScale</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div><center class="half"><img class="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender9/1692664-20200304202308351-2082989183.png" width="250" alt="loading failed, need vpn." /> <img class="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender9/1692664-20200304202308847-991714097.png" width="250" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>éšè—å±æ€§.</a></i></center> </font><h3 id="æ˜¾ç¤ºé‡‘å±å’Œå¹³æ»‘å€¼å±æ€§">æ˜¾ç¤ºé‡‘å±å’Œå¹³æ»‘å€¼å±æ€§</h3><p>è¿™ä¸¤ä¸ªå€¼ä¸»è¦ä½œç”¨äºMainTexçº¹ç†ï¼Œåº”è¯¥æ”¾åœ¨å…¶ä¹‹åä½ç½®æ˜¾ç¤ºã€‚</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">void</span> <span class="nf">SpecialShaderPropertyShow</span><span class="p">(</span><span class="kt">string</span> <span class="n">propertyName</span><span class="p">,</span><span class="kt">string</span> <span class="n">tooltip</span> <span class="p">=</span> <span class="k">null</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">MaterialProperty</span> <span class="n">metallic</span> <span class="p">=</span> <span class="nf">FindProperty</span><span class="p">(</span><span class="n">propertyName</span><span class="p">,</span> <span class="n">MaterialProperties</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
    <span class="n">MaterialEditor</span><span class="p">.</span><span class="nf">ShaderProperty</span><span class="p">(</span><span class="n">metallic</span><span class="p">,</span> <span class="nf">MakeLabelGUIContent</span><span class="p">(</span><span class="n">metallic</span><span class="p">,</span> <span class="n">tooltip</span><span class="p">));</span>
<span class="p">}</span>
<span class="k">void</span> <span class="nf">MetallicShow</span><span class="p">()</span>
<span class="p">{</span>
    <span class="nf">SpecialShaderPropertyShow</span><span class="p">(</span><span class="s">"_Metallic"</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">void</span> <span class="nf">SmoothnessShow</span><span class="p">()</span>
<span class="p">{</span>
    <span class="nf">SpecialShaderPropertyShow</span><span class="p">(</span><span class="s">"_Smoothness"</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div><center class="half"><img class="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender9/1692664-20200304202309339-1943302303.png" width="250" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>property show.</a></i></center> </font><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//å¿…é¡»åŒ…å›´ä½¿ç”¨ï¼Œ å…ˆç¼©è¿›åæ¢å¤ï¼Œä¸ç„¶ä¼šå½±å“åé¢çš„æ˜¾ç¤º</span>
<span class="n">EditorGUI</span><span class="p">.</span><span class="n">indentLevel</span> <span class="p">+=</span> <span class="m">2</span><span class="p">;</span>
<span class="n">MaterialEditor</span><span class="p">.</span><span class="nf">ShaderProperty</span><span class="p">(</span><span class="n">metallic</span><span class="p">,</span> <span class="nf">MakeLabelGUIContent</span><span class="p">(</span><span class="n">metallic</span><span class="p">,</span> <span class="n">tooltip</span><span class="p">));</span>
<span class="n">EditorGUI</span><span class="p">.</span><span class="n">indentLevel</span> <span class="p">-=</span> <span class="m">2</span><span class="p">;</span>
</code></pre></div></div><center class="half"><img class="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender9/1692664-20200304202309828-626961225.png" width="250" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>ç¼©è¿›.</a></i></center> </font><h3 id="æ˜¾ç¤ºç¬¬äºŒç»†èŠ‚çº¹ç†">æ˜¾ç¤ºç¬¬äºŒç»†èŠ‚çº¹ç†</h3><p>åŒç†ï¼Œä¸è´´ä»£ç äº†ã€‚</p><center class="half"><img class="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender9/1692664-20200304202310350-281567751.png" width="250" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>secondary map show.</a></i></center> </font><h2 id="é‡‘å±çº¹ç†">é‡‘å±çº¹ç†</h2><p>å¦‚ä½•æ··åˆé‡‘å±ä¸éé‡‘å±çº¹ç†ï¼Œä¸¤ä¸ªä¸åŒå…‰æ³½çš„çº¹ç†å¦‚ä½•æ··åˆï¼Ÿ</p><center class="half"><img class="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender9/1692664-20200304202311361-1114840764.png" width="250" alt="loading failed, need vpn." /> <img class="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender9/1692664-20200304202311946-1259847081.png" width="250" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>æ²¡æœ‰é‡‘å±çº¹ç†ï¼Œè´¨æ„Ÿç¨æ˜¾æ²¹è…».</a></i></center> </font><h3 id="ä½¿ç”¨metallic-çº¹ç†">ä½¿ç”¨Metallic çº¹ç†</h3><p>ä¸€èˆ¬å¯ä»¥ç”¨ç°åº¦å›¾æ ‡è®°é‡‘å±è‰²ã€å‡¹å‡¸(è§†å·®)è‰²ã€‚é‡‘å±æ ‡è®°ä¸º1ç™½è‰²ï¼Œéé‡‘å±å‘0è¶‹è¿‘é»‘è‰²ã€‚å› æ­¤é‡‡æ ·ç°åº¦å›¾ã€é«˜åº¦å›¾alphaä¸diffuseæ··åˆã€‚æ¥ç€æ‰©å±•GUI-ç•¥</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//...</span>
<span class="p">[</span><span class="n">NoScaleOffset</span><span class="p">]</span><span class="nf">_MetallicMap</span><span class="p">(</span><span class="s">"MetallicMap"</span><span class="p">,</span> <span class="m">2D</span><span class="p">)</span> <span class="p">=</span> <span class="s">"white"</span><span class="p">{}</span>
<span class="kt">float</span> <span class="nf">GetMetallic</span><span class="p">(</span><span class="n">Interpolators</span> <span class="n">i</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="nf">tex2D</span><span class="p">(</span><span class="n">_MetallicMap</span><span class="p">,</span> <span class="n">i</span><span class="p">.</span><span class="n">uv</span><span class="p">.</span><span class="n">xy</span><span class="p">).</span><span class="n">r</span> <span class="p">*</span> <span class="n">_Metallic</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div><center class="half"><img class="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender9/1692664-20200304202313024-1242769941.png" width="250" alt="loading failed, need vpn." /> <img class="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender9/1692664-20200304202313556-1220098996.png" width="250" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>æ²¹è…»æ„Ÿé™ä½.</a></i></center> </font><h3 id="å®šä¹‰metallicçš„shaderå…³é”®å­—">å®šä¹‰Metallicçš„Shaderå…³é”®å­—</h3><p>å½“ä½¿ç”¨metallicMapæ—¶å°±ä¸èƒ½å†ä½¿ç”¨metallicValueæ»‘æ¡ï¼Œå¦‚ä¸å°±ä¼šå¯¼è‡´åŒå€å åŠ ã€‚æ‰€ä»¥å¯ä»¥ç”¨Shaderå…³é”®å­—æ¥å†³å®šä½¿ç”¨äºŒè€…ä¹‹ä¸€ã€‚<code class="language-plaintext highlighter-rouge">MaterialEditor.targetæ˜¯å½“å‰inspectoré¢æ¿materialå®ä¾‹ï¼Œå¢åŠ å…³é”®å­—å¯ä»¥</code><code class="language-plaintext highlighter-rouge">ä½¿ç”¨Material.EnableKeyword,ç¦ç”¨Material.DisableKeywordã€‚</code></p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">void</span> <span class="nf">SetKeyword</span><span class="p">(</span><span class="kt">string</span> <span class="n">keyword</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">enable</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">enable</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">targetMaterial</span><span class="p">.</span><span class="nf">EnableKeyword</span><span class="p">(</span><span class="n">keyword</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="n">targetMaterial</span><span class="p">.</span><span class="nf">DisableKeyword</span><span class="p">(</span><span class="n">keyword</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div><p><code class="language-plaintext highlighter-rouge">è‡ªå®šä¹‰å‘½åçº¦å®š:_XXX_XX_...ã€‚è€Œ#pragma multi_compileæŒ‡ä»¤ä¼šè‡ªåŠ¨çº³å…¥å·²å®šä¹‰çš„å…³é”®å­—ç”Ÿæˆshaderå˜ä½“ã€‚</code></p><h3 id="25-æ‰“å¼€debugæ¨¡å¼æŸ¥çœ‹"><code class="language-plaintext highlighter-rouge">2.5 æ‰“å¼€Debugæ¨¡å¼æŸ¥çœ‹</code></h3><center class="half"><img class="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender9/1692664-20200305014004058-501347660.png" width="250" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>enable keyword.</a></i></center> </font><h3 id="ä½¿ç”¨è‡ªå®šä¹‰keywordfeatures">ä½¿ç”¨è‡ªå®šä¹‰Keyword(Features)</h3><div class="language-hlsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#pragma multi_compile _ _MATALLIC_MAP
</span></code></pre></div></div><p>ä½¿ç”¨multi_compileæŒ‡ä»¤ç„¶ååˆ†åˆ«æŸ¥çœ‹å˜ä½“ç¼–è¯‘ï¼š</p><p>æœ‰æ²¡æœ‰ä½¿ç”¨Matallicè´´å›¾éƒ½ä¼šç¼–è¯‘å‡ºå¦‚ä¸‹æ’åˆ—ç»„åˆ</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="m">8</span> <span class="n">keyword</span> <span class="n">variants</span> <span class="n">used</span> <span class="k">in</span> <span class="n">scene</span><span class="p">:</span>

<span class="p">&lt;</span><span class="n">no</span> <span class="n">keywords</span> <span class="n">defined</span><span class="p">&gt;</span>
<span class="n">_MATALLIC_MAP</span>
<span class="n">VERTEXLIGHT_ON</span>
<span class="n">VERTEXLIGHT_ON</span> <span class="n">_MATALLIC_MAP</span>
<span class="n">SHADOWS_SCREEN</span>
<span class="n">SHADOWS_SCREEN</span> <span class="n">_MATALLIC_MAP</span>
<span class="n">SHADOWS_SCREEN</span> <span class="n">VERTEXLIGHT_ON</span>
<span class="n">SHADOWS_SCREEN</span> <span class="n">VERTEXLIGHT_ON</span> <span class="n">_MATALLIC_MAP</span>
</code></pre></div></div><p><strong>å¯æ˜¯</strong>ï¼Œmulti_compileæŒ‡ä»¤ä¼šç”Ÿæˆæ‰€æœ‰å¯èƒ½çš„æ’åˆ—ç»„åˆå˜ä½“ï¼Œè¿™äº›è¦èŠ±è´¹å¤§é‡æ—¶é—´ç¼–è¯‘ï¼Œè€Œä¸”æœ‰äº›keywordsç¡®å®æ²¡ä½¿ç”¨ã€‚å¯¹äºè‡ªå®šä¹‰çš„shader keywordså¯ä»¥ä½¿ç”¨shader_featureç¼–è¯‘æŒ‡ä»¤ä¼˜åŒ–å“ªäº›æ²¡æœ‰ä½¿ç”¨çš„å…³é”®å­—ï¼Œä¸ç”Ÿæˆå˜ä½“ï¼ŒåŒæ—¶åœ¨æ„å»ºæ—¶ä¹Ÿä¼šæ£€æŸ¥å…³é”®å­—æ˜¯å¦è¢«ä½¿ç”¨ã€‚</p><p>shader_featureæ²¡æœ‰ä½¿ç”¨Matallicè´´å›¾ï¼Œå˜ä½“æ•°é‡é™ä½ï¼š</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="m">4</span> <span class="n">keyword</span> <span class="n">variants</span> <span class="n">used</span> <span class="k">in</span> <span class="n">scene</span><span class="p">:</span>

<span class="p">&lt;</span><span class="n">no</span> <span class="n">keywords</span> <span class="n">defined</span><span class="p">&gt;</span>
<span class="n">VERTEXLIGHT_ON</span>
<span class="n">SHADOWS_SCREEN</span>
<span class="n">SHADOWS_SCREEN</span> <span class="n">VERTEXLIGHT_ON</span>
</code></pre></div></div><p>é‚£ä¹ˆmulti_compileä¸shader_featureä½•æ—¶ä½¿ç”¨ï¼Ÿ 1ã€å¯¹äºshader_featureæœ€ä½³é£Ÿç”¨æ–¹æ³•å°±æ˜¯åœ¨ç¼–è¾‘å™¨æ¨¡å¼ï¼Œäººå·¥é…ç½®materialé¢æ¿å±æ€§è‡ªåŠ¨æ”¶é›†å˜ä½“ã€‚ 2ã€å¦‚æœè¦åœ¨runtimeä½¿ç”¨shader_featureï¼Œå°±è¦ç¡®ä¿æ‰€æœ‰çš„shaderå˜ä½“éƒ½è¢«æ„å»ºè¿›åº”ç”¨å†…ã€‚å½“ç„¶è¿™ä¹Ÿæ˜¯å¾ˆå®Œç¾çš„æ–¹æ¡ˆï¼Œä½†æ˜¯ä¸€å®šè¦ç¡®ä¿èƒ½å¤Ÿæ‰‹åŠ¨æ”¶é›†æ‰€æœ‰å˜ä½“ 3ã€å¯¹äºç¬¬äºŒç‚¹çš„ç¨æ¬¡è§£å†³æ–¹æ¡ˆå°±æ˜¯ä½¿ç”¨muti_compileæŒ‡ä»¤</p><p>æ ¹æ®å…³é”®å­—å¯ç”¨ï¼Œè‡ªåŠ¨è·å–</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">float</span> <span class="nf">GetMetallic</span><span class="p">(</span><span class="n">Interpolators</span> <span class="n">i</span><span class="p">)</span> <span class="p">{</span>
<span class="cp">#if defined(_METALLIC_MAP)
</span>    <span class="k">return</span> <span class="nf">tex2D</span><span class="p">(</span><span class="n">_MetallicMap</span><span class="p">,</span> <span class="n">i</span><span class="p">.</span><span class="n">uv</span><span class="p">.</span><span class="n">xy</span><span class="p">).</span><span class="n">r</span><span class="p">;</span>
<span class="cp">#else
</span>    <span class="k">return</span> <span class="n">_Metallic</span><span class="p">;</span>
<span class="cp">#endif
</span><span class="p">}</span>
</code></pre></div></div><h3 id="changecheckæ£€æŸ¥">ChangeCheckæ£€æŸ¥</h3><p>ç°åœ¨æ¯å¸§è°ƒç”¨OnGUIï¼Œä¼šé‡å¤æ‰§è¡Œæ‰€æœ‰æ–¹æ³•ã€‚ç†è®ºä¸Šåªæœ‰å½“materialé¢æ¿å±æ€§è¢«æ”¹å˜äº†ï¼Œè°ƒç”¨æ‰§è¡Œå†…éƒ¨æ–¹æ³•ã€‚Unityæä¾›äº†EditorGUI.BeginChaneCheckå’ŒEditorGUI.EndChangeCheckæ–¹æ³•ã€‚è¿™ä¸¤ä¸ªæ–¹æ³•éœ€è¦åŒ¹é…ä½¿ç”¨ï¼Œbeginåœ¨è¦æ£€æŸ¥ä¹‹å‰çš„ä½ç½®è°ƒç”¨ï¼Œendåœ¨ç»“æŸæ—¶æ£€æŸ¥ï¼šè‹¥æœ‰ä¿®æ”¹è¿”å›true</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">void</span> <span class="nf">MetallicMapShow</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">EditorGUI</span><span class="p">.</span><span class="nf">BeginChangeCheck</span><span class="p">();</span>
    <span class="n">MaterialProperty</span> <span class="n">mp</span> <span class="p">=</span> <span class="nf">MakerMapWithScaleShow</span><span class="p">(</span><span class="s">"_MetallicMap"</span><span class="p">,</span> <span class="s">"_Metallic"</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">EditorGUI</span><span class="p">.</span><span class="nf">EndChangeCheck</span><span class="p">())</span>
    <span class="p">{</span>
        <span class="nf">SetKeyword</span><span class="p">(</span><span class="s">"_METALLIC_MAP"</span><span class="p">,</span> <span class="n">mp</span><span class="p">.</span><span class="n">textureValue</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div><h3 id="å…‰æ»‘çº¹ç†">å…‰æ»‘çº¹ç†</h3><p>ç±»ä¼¼é‡‘å±çº¹ç†ï¼Œå…‰æ»‘çº¹ç†ä¹Ÿæ˜¯ä¸€å¼ ç°åº¦å›¾ã€‚é‡‘å±éƒ¨åˆ†å¾ˆå…‰æ»‘ï¼Œå…¶ä»–éƒ¨åˆ†å¾ˆç²—ç³™ã€‚Unityæä¾›çš„standardShaderæ˜¯é‡‡æ ·äº†çº¹ç†çš„alphaé€šé“ï¼Œ<strong>è€Œäº‹å®ä¸Šå®ƒè¦æ±‚é‡‘å±å’Œå…‰æ»‘å€¼åˆå¹¶åœ¨åŒä¸€å¼ é‡‘å±è´´å›¾çš„ä¸åŒé€šé“</strong>(è¿™ä¹Ÿç»™äº†ä¸€ä¸ªå¾ˆå¥½çš„å·¥ä½œæµæç¤º)ã€‚å¥½å¤„ï¼šä¸€æ˜¯ä¸ç”¨é‡‡æ ·ä¸¤æ¬¡ï¼›äºŒæ˜¯DXT5å‹ç¼©ä¼šåˆ†ç¦»RGBå’ŒAé€šé“ã€‚å½“ç„¶è¿™åœ¨ä¸¤è€…éƒ½éœ€è¦ä¹‹ä¸‹ã€‚</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">float</span> <span class="nf">GetSmoothness</span><span class="p">(</span><span class="n">Interpolators</span> <span class="n">i</span><span class="p">)</span> <span class="p">{</span>
<span class="cp">#if defined(_METALLIC_MAP)
</span>    <span class="k">return</span> <span class="nf">tex2D</span><span class="p">(</span><span class="n">_MetallicMap</span><span class="p">,</span> <span class="n">i</span><span class="p">.</span><span class="n">uv</span><span class="p">.</span><span class="n">xy</span><span class="p">).</span><span class="n">a</span><span class="err">Â </span> <span class="p">*</span> <span class="n">_Smoothness</span><span class="p">;</span>
<span class="cp">#else
</span>    <span class="k">return</span> <span class="n">_Smoothness</span><span class="p">;</span>
<span class="cp">#endif
</span><span class="p">}</span>
</code></pre></div></div><center class="half"><img class="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender9/1692664-20200305014005017-1787446468.png" width="250" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>é‡‘å±_å…‰æ»‘çº¹ç†.</a></i></center> </font><p><strong>æ•ˆæœç¼ºç‚¹</strong>ï¼šDXT5nmçº¹ç†å‹ç¼©æ³•çº¿è´´å›¾ä¼šé€ æˆä¼ªå½±ã€‚å°–é”çš„å¯¹è§’è¾¹æ²¡æœ‰ä¸UVè½´å¯¹é½ï¼Œä¸èƒ½æ­£ç¡®åœ°è¿‘ä¼¼ã€‚ç”µè·¯ä¸­æ˜¯è¿™ç§å‹ç¼©æœ€ç³Ÿç³•çš„æƒ…å†µã€‚è¿™ç§ç¼ºç‚¹åœ¨é‡‘å±å’Œéå¸¸å…‰æ»‘çš„è¡¨é¢ä¸Šå˜å¾—æ¸…æ™°å¯è§ã€‚</p><center class="half"><img class="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender9/1692664-20200305014005658-1511782458.png" width="250" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>è¾¹ç¼˜ä¼ªå½±.</a></i></center> </font><h3 id="albedoä¸smoothnessç»“åˆ">Albedoä¸smoothnessç»“åˆ</h3><p>ç¬¬ä¸€ä¸ªå·¥ä½œæµï¼šå¯¹äºé‡‘å±è´¨æ„Ÿæè´¨æ€»æ˜¯éœ€è¦Metallicï¼ŒåŒæ—¶ä¹Ÿè‚¯å®šéœ€è¦smoothnesså¢å¼ºå¹³æ»‘æ„Ÿã€‚</p><p>ç¬¬äºŒä¸ªå·¥ä½œæµï¼šä¸è¦é‡‘å±è´¨æ„Ÿè€Œè¦å¹³æ»‘ï¼Œå¯ä»¥æŠŠsmoothnessæ”¾è¿›Albedoçº¹ç†alphaé€šé“ã€‚è¿™ç§æƒ…å†µé€‚ç”¨ä¸éœ€è¦é‡‘å±çš„ä¸é€æ˜æè´¨ã€‚</p><h3 id="å…³é”®å­—é€‰æ‹©">å…³é”®å­—é€‰æ‹©</h3><p>å¯¹äºå¤šä¸ªå·¥ä½œæµï¼Œèƒ½æä¾›ä¸€ä¸ªä¸‹æ‹‰åˆ—è¡¨é¡¹åŒ¹é…å°±å¾ˆæ–¹ä¾¿ã€‚</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">enum</span> <span class="n">SmoothnessSource</span>
<span class="p">{</span>
    <span class="n">Uniform</span><span class="p">,</span> <span class="n">Albedo</span><span class="p">,</span> <span class="n">Metallic</span>
<span class="p">}</span>
</code></pre></div></div><p>å½“ä½¿ç”¨Uniformä»£è¡¨æ²¡æœ‰å…³é”®å­—å†™å…¥ã€‚å½“Albedoä»£è¡¨åŒ…å«å…‰æ»‘åº¦çš„albedoçº¹ç†ï¼›å½“metallicä»£è¡¨åŒ…å«å…‰æ»‘åº¦çš„metallicçº¹ç†ã€‚Materialå®ä¾‹æä¾›äº†IsKeywordEnabledå‡½æ•°æ£€æµ‹å…³é”®å­—å¯ç”¨ã€‚</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">void</span> <span class="nf">SmoothnessShow</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">Switchkeyword</span> <span class="n">source</span> <span class="p">=</span> <span class="n">Switchkeyword</span><span class="p">.</span><span class="n">UNIFORM</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nf">IsKeyEnable</span><span class="p">(</span><span class="n">keyword_smoothness_albedo</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="n">source</span> <span class="p">=</span> <span class="n">Switchkeyword</span><span class="p">.</span><span class="n">SMOOTHNESS</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">if</span><span class="p">(</span><span class="nf">IsKeyEnable</span><span class="p">(</span><span class="n">keyword_smoothness_metallic</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="n">source</span> <span class="p">=</span> <span class="n">Switchkeyword</span><span class="p">.</span><span class="n">METALLIC</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">//å¿…é¡»åŒ…å›´ä½¿ç”¨ï¼Œ å…ˆç¼©è¿›åæ¢å¤ï¼Œä¸ä¼šå½±å“åé¢çš„æ˜¾ç¤º</span>
    <span class="n">EditorGUI</span><span class="p">.</span><span class="n">indentLevel</span> <span class="p">+=</span> <span class="m">2</span><span class="p">;</span>
    <span class="nf">MakeShaderSpecialPropertyShow</span><span class="p">(</span><span class="s">"_Smoothness"</span><span class="p">);</span>

    <span class="n">EditorGUI</span><span class="p">.</span><span class="n">indentLevel</span> <span class="p">+=</span> <span class="m">1</span><span class="p">;</span>
    <span class="n">GUIContent</span> <span class="n">gc</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">GUIContent</span><span class="p">(</span><span class="s">"Source"</span><span class="p">);</span>
    <span class="n">EditorGUI</span><span class="p">.</span><span class="nf">BeginChangeCheck</span><span class="p">();</span>
    <span class="n">EditorGUI</span><span class="p">.</span><span class="n">indentLevel</span> <span class="p">+=</span> <span class="m">1</span><span class="p">;</span>
    <span class="n">GUIContent</span> <span class="n">gc</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">GUIContent</span><span class="p">(</span><span class="s">"Source"</span><span class="p">);</span>  
    <span class="c1">//åœ¨è¿™é‡Œå¼€å§‹æ£€æŸ¥æ˜¯å¦æ‰‹åŠ¨ä¿®æ”¹äº†ä¸‹æ‹‰å•å…ƒï¼Œç„¶åè®¾ç½®å¯¹åº”çš„å…³é”®å­—  </span>
    <span class="n">EditorGUI</span><span class="p">.</span><span class="nf">BeginChangeCheck</span><span class="p">();</span>  
    <span class="n">source</span> <span class="p">=</span> <span class="p">(</span><span class="n">Switchkeyword</span><span class="p">)</span><span class="n">EditorGUILayout</span><span class="p">.</span><span class="nf">EnumPopup</span><span class="p">(</span><span class="n">gc</span><span class="p">,</span> <span class="n">source</span><span class="p">);</span>  
    <span class="k">if</span> <span class="p">(</span><span class="n">EditorGUI</span><span class="p">.</span><span class="nf">EndChangeCheck</span><span class="p">())</span>
    <span class="p">{</span>
        <span class="c1">//RecordAction("123124");//å–æ¶ˆ</span>
        <span class="nf">SetKeyword</span><span class="p">(</span><span class="n">keyword_smoothness_metallic</span><span class="p">,</span> <span class="n">source</span> <span class="p">==</span> <span class="n">Switchkeyword</span><span class="p">.</span><span class="n">METALLIC</span><span class="p">);</span>
        <span class="nf">SetKeyword</span><span class="p">(</span><span class="n">keyword_smoothness_albedo</span><span class="p">,</span> <span class="n">source</span> <span class="p">==</span> <span class="n">Switchkeyword</span><span class="p">.</span><span class="n">SMOOTHNESS</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">EditorGUI</span><span class="p">.</span><span class="n">indentLevel</span> <span class="p">-=</span> <span class="m">3</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div><p>Unityæä¾›äº†<code class="language-plaintext highlighter-rouge">MaterialEditor.RegisterPropertyChangeUndoå‡½æ•°å–æ¶ˆ</code></p><h3 id="smoothnesså˜ä½“ä½¿ç”¨">Smoothnesså˜ä½“ä½¿ç”¨</h3><pre><code class="language-C">#pragma shader_feature _ _SMOOTHNESS_ALBEDO _SMOOTHNESS_METALLIC
</code></pre><p>å…ˆæ£€æŸ¥æ˜¯å¦ä½¿ç”¨albedoå…³é”®å­—ä½œä¸ºå¹³æ»‘ï¼Œç„¶åæ£€æŸ¥smoothnesså’Œmetallicä½œä¸ºå¹³æ»‘(å½“å¼€å¯é‡‘å±è‚¯å®šä¼šæœ‰å¹³æ»‘éœ€æ±‚)ã€‚ç„¶åä¸_Smoothnesså åŠ ã€‚å åŠ ï¼š1ä¸å˜ï¼Œæ‹‰åŠ¨æ»‘æ¡èƒ½äºŒæ¬¡è°ƒèŠ‚<strong>ã€‚å åŠ è¿™æ˜¯ä¸€ç§æ•ˆæœç®—æ³•ï¼Œæ˜¯ç»éªŒå…¬å¼ï¼Œå†™çš„å¤šã€ç§¯ç´¯çš„å¤šäº†ï¼Œè‡ªç„¶å°±èƒ½å†™å‡ºè‡ªå·±çš„ç»éªŒå…¬å¼ã€‚</strong></p><pre><code class="language-C">float GetSmoothness(Interpolators i)
{
    float smoothness = 1;
#if defined(_SMOOTHNESS_ALBEDO)
    smoothness = tex2D(_MainTex, i.uv.xy).a;
#elif defined(_SMOOTHNESS_METALLIC) &amp;&amp; defined(_METALLIC_MAP)
    smoothness = tex2D(_MetallicMap, i.uv.xy).a ;
#endif
    return smoothness * _Smoothness;
}
</code></pre><h3 id="æŸ¥çœ‹smoothness_albedo">æŸ¥çœ‹Smoothness_Albedo</h3><center class="half"><img class="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender9/1692664-20200306014752502-1689666028.png" width="250" alt="loading failed, need vpn." /></center> <center class="half"><img class="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender9/1692664-20200306014753626-2109346024.png" width="250" alt="loading failed, need vpn." /> <img class="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender9/1692664-20200306014754752-1166307200.png" width="250" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>uniform vs albedo.</a></i></center> </font><h2 id="è‡ªå‘å…‰">è‡ªå‘å…‰</h2><p>é€šè¿‡æ¨¡æ‹Ÿæè´¨è¡¨é¢å…‰æºæ•ˆæœï¼Œåªéœ€è¦åœ¨basePaseé‡‡æ ·ä¸€æ¬¡å³å¯ã€‚</p><div class="language-hlsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="n">NoScaleOffset</span><span class="p">]</span><span class="n">_EmissionMap</span><span class="p">(</span><span class="s">"EmissionMap"</span><span class="p">,</span> <span class="mi">2</span><span class="n">D</span><span class="p">)</span> <span class="o">=</span> <span class="s">"white"</span><span class="p">{}</span>
<span class="n">_Emission</span><span class="p">(</span><span class="s">"Emission"</span><span class="p">,</span> <span class="n">Color</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="c1">//é»˜è®¤é»‘è‰²ï¼Œå åŠ </span>

<span class="c1">//base pass</span>
<span class="cp">#pragma shader_feature _ _EMISSION_MAP
</span></code></pre></div></div><div class="language-hlsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//è‡ªå‘å…‰é‡‡æ ·</span>
<span class="kt">float3</span> <span class="nf">GetEmission</span><span class="p">(</span><span class="n">Interpolators</span> <span class="n">i</span><span class="p">){</span>
<span class="cp">#ifdef FORWARD_BASE_PASS
</span>    <span class="cp">#ifdef _EMISSION_MAP
</span>        <span class="k">return</span> <span class="nb">tex2D</span><span class="p">(</span><span class="n">_EmissionMap</span><span class="p">,</span> <span class="n">i</span><span class="p">.</span><span class="n">uv</span><span class="p">.</span><span class="n">zw</span><span class="p">).</span><span class="n">rgb</span><span class="p">;</span>
    <span class="cp">#else
</span>        <span class="k">return</span> <span class="n">_Emission</span><span class="p">;</span>
    <span class="cp">#endif
#endif
</span>    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div><div class="language-hlsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//ç‰‡å…ƒå‡½æ•°</span>
<span class="n">final</span><span class="p">.</span><span class="n">rgb</span> <span class="o">+=</span> <span class="n">GetEmission</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
</code></pre></div></div><center class="half"><img class="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender9/1692664-20200306014756037-1891225132.png" width="250" alt="loading failed, need vpn." /></center> <font size="2.5"> <center><i><a>emission.</a></i></center> </font><h3 id="hdr-emission">HDR Emission</h3><p>HDRï¼šé¢œè‰²çš„RGBåˆ†é‡å¯ä»¥å¤§äº1ï¼Œåˆ›å»ºbloomæ•ˆæœã€‚</p><p>Unityä¸­_MaterialEditor_æ­£å¥½æä¾›äº†_TexturePropertyWithHDRColor_å‡½æ•°ï¼Œéœ€è¦å‚æ•°ä¸€æ˜¯é¢œè‰²èŒƒå›´ï¼›å‚æ•°äºŒæ˜¯å¦éœ€è¦alphaé€šé“ã€‚</p><p>é¢œè‰²èŒƒå›´æœ‰ColorPickerHDRConfigå¯¹è±¡å£°æ˜ï¼Œäº®åº¦èŒƒå›´å’Œæ›å…‰èŒƒå›´ã€‚å…ˆå–StandardShaderæ•°å€¼(0,99, 1/99, 3)</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Rect</span> <span class="n">r</span> <span class="p">=</span> <span class="n">MaterialEditor</span><span class="p">.</span><span class="nf">TexturePropertyWithHDRColor</span>
<span class="p">(</span>
    <span class="nf">MakeMapGUIContent</span><span class="p">(</span><span class="n">mapinfo</span><span class="p">,</span> <span class="k">null</span><span class="p">),</span>
    <span class="n">mapinfo</span><span class="p">,</span>
    <span class="n">bumpScale</span><span class="p">,</span>
    <span class="n">config</span><span class="p">,</span>
    <span class="k">false</span>
<span class="p">);</span>
</code></pre></div></div><center class="half"><img class="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender9/1692664-20200306014757165-1477922384.png" width="250" alt="loading failed, need vpn." /> <img class="fit-picture" loading="lazy" src="https://damonc-top2.github.io/web-assets/posts/2018/month1/catRender9/1692664-20200306014758149-232656592.png" width="250" alt="loading failed, need vpn." /></center></article><hr><div class='like-post'> <a style="color:rgb(112, 40, 85);" id="likeBtn" onclick="likePost(1);"> <i class="fa fa-thumbs-o-up fa-2x" aria-hidden="true"></i> </a> <span id="likeNum">0</span><div class="text-xs text-slate-500 mx-2">çœŸè¯šç‚¹èµï¼Œæ‰‹ç•™ä½™é¦™</div></div><h2 id="similar_posts">Similar Posts</h2><ul><li class="relatedPost"> <a href="/2018/01/25/Unity_Parallax_Normals_Heightmap/">è§†å·®å’Œæ³•çº¿ã€é«˜åº¦å›¾å›é¡¾(ç¿»è¯‘äºŒå) </a><li class="relatedPost"> <a href="/2018/01/24/Unity_GPU_Instance/">Unity GPU Instance(ç¿»è¯‘åä¹) </a><li class="relatedPost"> <a href="/2018/01/23/Unity_RealTime_GI_LOD/">Unity å®æ—¶ GI & LPPV & LOD(ç¿»è¯‘åå…«) </a><li class="relatedPost"> <a href="/2018/01/21/Unity_Mix_Lighting/">Unity æ··åˆå…‰ç…§(ç¿»è¯‘åä¸ƒ) </a><li class="relatedPost"> <a href="/2018/01/19/Unity_Static_Lightting/">Unity å…‰ç…§çƒ˜ç„™(ç¿»è¯‘åå…­) </a><li class="relatedPost"> <a href="/2018/01/17/Unity_Deferred_Lights/">Unity Deferred Lights-å»¶è¿Ÿå…‰ç…§(ç¿»è¯‘åäº”) </a></ul><div class="post-recent"><div class="pre"><p><strong>ä¸Šä¸€ç¯‡</strong> <a href="/2018/01/06/Unity_Reflection/">Unity Reflection åå°„(ç¿»è¯‘å…«)</a></p></div><div class="nex"><p><strong>ä¸‹ä¸€ç¯‡</strong> <a href="/2018/01/07/Unity_ShaderGUI_Extension_2/">Unity Shader GUI æ‰©å±•äºŒ(ç¿»è¯‘å)</a></p></div></div><h2 id="comments">Comments</h2><div id="vcomments"></div><script type="text/javascript"> /*è¯„è®ºç›¸å…³*/ function delayLoadValine() { new Valine({ el: '#vcomments', verify: "true", notify: "false", app_id: "JgYk2pcFa3QxhhWPhDjjoPvv-MdYXbMMI", app_key: "fjDLTSUgCNGrSKgCID672IJx", avatar: "monsterid", placeholder: "æ¬¢è¿è¯„è®ºï¼", pageSize: "10 || 10", master: "b5586e582cb181c6b0fc8b2ce828bd50", tagMeta: ["åšä¸»","å°ä¼™ä¼´","è®¿å®¢"], enableQQ: true, requiredFields: [], serverURLs: "https://jgyk2pcf.api.lncldglobal.com", recordIP: "true", visitor: "true", }); $(document).ready(function(){ fetch('https://v1.hitokoto.cn/') .then(response => response.json()) .then(data => { document.getElementById("veditor").setAttribute( "placeholder", data.hitokoto+"â€”"+data.from ); setTimeout(() => { addPostVisitedTimes(); }, 1000); } ) .catch(console.error); }); } /*ç‚¹èµç›¸å…³*/ var curIpVisitRecord = null; var curPost = null; var curUrl = "https://www.damonc.top/2018/01/07/Unity_ShaderGUI_Extension_1/"; function getVisitorIpAndJudge() { $.getJSON('https://api.ipify.org?format=json', function(data){ saveOrUpdateIpRecord(data.ip) }); } function saveOrUpdateIpRecord(ip) { var Visitor = AV.Object.extend("visitors_record"); var post_url = curUrl; var query = new AV.Query(Visitor); query.equalTo("visitor_ip", ip); query.equalTo("post_url", post_url); query.find().then(function(results) { if (results.length > 0) { /* if(window.console){ console.log('è¯¥IPå·²è®¿é—®è¿‡è¯¥æ–‡ç« '); }*/ curIpVisitRecord = results[0]; updateIpRecord(); refreshLikeBtn(); } else { /*if(window.console){ console.log('è¯¥IPç¬¬ä¸€æ¬¡è®¿é—®è¯¥æ–‡ç« ï¼Œä¿å­˜æ–°çš„è®¿é—®è®°å½•ï¼Œå¹¶å¢åŠ è®¿é—®æ¬¡æ•°'); }*/ addNewIpRecord(ip, post_url); } }, function(error) { addPostVisitedTimes(); }); } function addPostVisitedTimes() { var AV_Posts = AV.Object.extend("Posts"); var url = curUrl; var title = "Unity Shader GUI æ‰©å±•ä¸€(ç¿»è¯‘ä¹)"; var query = new AV.Query(AV_Posts); query.equalTo("post_url", url); query.find().then(function(results) { if (results.length > 0) { curPost = results[0]; curPost.increment("visited_times"); curPost.save(); loadLikeNums(); } else { curPost = new AV_Posts(); /* Set ACL */ var acl = new AV.ACL(); acl.setPublicReadAccess(true); acl.setPublicWriteAccess(true); curPost.setACL(acl); /* End Set ACL */ curPost.set("post_title", title); curPost.set("post_url", url); curPost.set("visited_times", 1); curPost.set('like_times', 0); curPost.save(); } getVisitorIpAndJudge(); }, function(error) { console.log('Error:' + error.code + " " + error.message); }); } function showPostVisitedTimes() { var AV_Posts = AV.Object.extend("Posts"); var $visitors = $(".leancloud_visitors"); var url = $visitors.attr('id').trim(); var title = $visitors.attr('data-flag-title').trim(); var query = new AV.Query(AV_Posts); query.equalTo("post_url", url); query.find().then(function(results) { if (results.length > 0) { curPost = results[0]; loadLikeNums(); } else { /*if(window.console){ console.log('å¼‚å¸¸æƒ…å†µï¼Œä¸åº”è¯¥æ²¡è®°å½•çš„'); }*/ } }, function(error) { console.log('Error:' + error.code + " " + error.message); }); } function updateIpRecord(){ var lastTime = curIpVisitRecord.updatedAt; var curTime = new Date(); var timePassed = curTime.getTime() - lastTime.getTime(); if(timePassed > 300000) { /*if(window.console){ console.log('è·ç¦»è¯¥IPä¸Šä¸€æ¬¡è®¿é—®è¯¥æ–‡ç« å·²è¶…è¿‡äº†5åˆ†é’Ÿï¼Œæ›´æ–°è®¿é—®è®°å½•ï¼Œå¹¶å¢åŠ è®¿é—®æ¬¡æ•°'); }*/ addPostVisitedTimes(); curIpVisitRecord.save(); } else { /*console.log('è¿™æ˜¯è¯¥IP 1åˆ†é’Ÿå†…é‡å¤è®¿é—®è¯¥æ–‡ç« ï¼Œä¸æ›´æ–°è®¿é—®è®°å½•ï¼Œä¸å¢åŠ è®¿é—®æ¬¡æ•°');*/ } } function addNewIpRecord(ip, post_url){ var Visitor = AV.Object.extend("visitors_record"); curIpVisitRecord = new Visitor(); /* Set ACL */ var acl = new AV.ACL(); acl.setPublicReadAccess(true); acl.setPublicWriteAccess(true); curIpVisitRecord.setACL(acl); curIpVisitRecord.set("visitor_ip", ip); curIpVisitRecord.set("post_url", post_url); curIpVisitRecord.set("like_this_post", 0); curIpVisitRecord.save(); } function loadLikeNums() { var likeTimes = curPost.get('like_times'); $("#likeNum").text(likeTimes); } function refreshLikeBtn() { var likeState = curIpVisitRecord.get('like_this_post'); if(likeState == 1){ $("#likeBtn").css("color", "red"); $("#likeBtn").attr("onclick", "likePost(-1)"); } else { $("#likeBtn").css("color", "black"); $("#likeBtn").attr("onclick", "likePost(1)"); } loadLikeNums(); } function likePost(type) { if(curPost == null || curIpVisitRecord == null) { alert('å»¶è¿Ÿ10såæ‰èƒ½ç‚¹èµ, è¯·ç¨ç­‰...'); return } var newNum; var getlikeTime = curPost.get('like_times'); if(typeof getlikeTime == "undefined" || getlikeTime == null || getlikeTime == "") { newNum = parseInt(type); }else{ newNum = parseInt(type) + parseInt(getlikeTime); } curPost.set('like_times', newNum); curPost.save().then(function(curPost){ var likeThisPost = type == -1 ? 0 : 1; curIpVisitRecord.set("like_this_post", likeThisPost); curIpVisitRecord.save().then(function(){ refreshLikeBtn(); }); },function(error){ console.log('Failed to create visitor record, with error message: ' + error.message); }); } /*å¯åŠ¨æ‰§è¡Œ*/ setTimeout(() => { delayLoadValine(); }, 10000); </script></div></div><script> /** * target _blank */ (function() { var aTags = document.querySelectorAll('article a:not([id])'); for (var i = 0; i < aTags.length; i++) { aTags[i].setAttribute('target', '_blank'); } }()); </script> <script src="/js/pageContent.js " charset="utf-8"></script><footer class="site-footer"><div class="wrapper"><p class="description"> äº‘ä¸Šçš„æ—¥å­!</p><p class="contact"> <a href="https://github.com/bitfeng" title="GitHub"><i class="fa fa-github" aria-hidden="true"></i></a> <a href="mailto:damonc@126.com" title="email"><i class="fa fa-envelope-o" aria-hidden="true"></i></a></p><p> æœ¬ç«™æ€»è®¿é—®é‡<span id="busuanzi_value_site_pv"></span>æ¬¡ï¼Œæœ¬ç«™è®¿å®¢æ•°<span id="busuanzi_value_site_uv"></span>äººæ¬¡ï¼Œæœ¬æ–‡æ€»é˜…è¯»é‡<span id="busuanzi_value_page_pv"></span>æ¬¡</p></div></footer><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="back-to-top"> <a href="#top" data-scroll> <i class="fa fa-arrow-up" aria-hidden="true"></i> </a></div><script src=" /js/main.js " charset="utf-8"></script> <script src=" /js/smooth-scroll.min.js " charset="utf-8"></script> <script type="text/javascript"> smoothScroll.init({ speed: 500, easing: 'easeInOutCubic', offset: 20, }); function displayWindowSize() { var w = document.documentElement.clientWidth; var h = document.documentElement.clientHeight; var rightDiv = document.querySelector('.right'); var footer = document.querySelector('.site-footer'); if(!rightDiv || !footer){ return; } if(w <= 1700){ rightDiv.style.display='none'; footer.style.display='none'; }else{ rightDiv.style.display='block'; footer.style.display = "block"; } } window.addEventListener("resize", displayWindowSize); displayWindowSize(); </script>
